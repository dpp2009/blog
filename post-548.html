<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>CentOS下Redis2.2.14安装配置详解</title>
<meta name="keywords" content="迷茫,dpp,丁盼盼,迷茫者" />
<meta name="description" content="" />
<meta name="generator" content="emlog" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://onelose.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://onelose.com/wlwmanifest.xml" />
<link rel="alternate" type="application/rss+xml" title="RSS"  href="http://onelose.com/rss.php" />
<link href="http://onelose.com/content/templates/dpp_icecream_02/main.css" rel="stylesheet" type="text/css" />
<link href="http://onelose.com/admin/editor/plugins/code/prettify.css" rel="stylesheet" type="text/css" />
<script src="http://onelose.com/admin/editor/plugins/code/prettify.js" type="text/javascript"></script>
<script src="http://onelose.com/include/lib/js/common_tpl.js" type="text/javascript"></script>
<script src="http://onelose.com/content/templates/dpp_icecream_02/js/nav.js" type="text/javascript"></script>
<script src="http://onelose.com/content/templates/dpp_icecream_02/js/jquery-1.10.2.min.js"></script>
<script id="allmobilize" charset="utf-8" src="http://a.yunshipei.com/cbca8680e2150f433cb28b942e85ec26/allmobilize.min.js"></script><meta http-equiv="Cache-Control" content="no-siteapp" /><link rel="alternate" media="handheld" href="#" />
<script src="http://onelose.com/include/lib/js/jquery/jquery-1.7.1.js" type="text/javascript"></script><link rel="stylesheet" type="text/css" href ="http://onelose.com/content/plugins/SHJS_for_Emlog/sh_style.min.css" />
	<script type="text/javascript" src="http://onelose.com/content/plugins/et_highlighter51/scripts/brush.js"></script>
	<link type="text/css" rel="stylesheet" href="http://onelose.com/content/plugins/et_highlighter51/styles/shCore.css"/>
	<link type="text/css" rel="stylesheet" href="http://onelose.com/content/plugins/et_highlighter51/styles/shThemeDefault.css"/>
	<script type="text/javascript">SyntaxHighlighter.config.clipboardSwf = 'http://onelose.com/content/plugins/et_highlighter51/scripts/clipboard.swf';SyntaxHighlighter.all();</script>
	</head>
<body>

<div id="wrap">
<div id="hm">
	<div id="header">
	<div><a href="http://onelose.com/"><img src="http://onelose.com/content/templates/dpp_icecream_02/images/logo.jpg" alt="迷茫者 " title="迷茫者"></a></div>
	<h3>迷茫者王者归来。</h3>
	</div>
	<!-- <div id="banner"><a href="http://onelose.com/"><img src="http://onelose.com/content/templates/default/images/top/terrace.jpg" height="134" width="960" /></a></div> -->
	<div id="nav" >	<ul>
			<li class="common"><a href="http://onelose.com/" >首页</a></li>
			<li class="common"><a href="http://onelose.com/t" >微语</a></li>
			<li class="common"><a href="http://onelose.com/post-113.html" >留言</a></li>
			<li class="common"><a href="http://onelose.com/admin" >登录</a></li>
		</ul>
</div>
</div>
<div id="content">
<div id="contentleft">
	<h2>CentOS下Redis2.2.14安装配置详解</h2>
	<p class="date">作者：<a href="http://onelose.com/author/1" title="及尽繁华 不过一掬细沙 只望淡泊名利 自在一生 奈何凡尘俗世之杂碎琐事 竟有我舍之不去的牵挂 故 始终俗人！ 1064490567@qq.com">迷茫者</a> 发布于：2014-4-17 6:00 Thursday 
			分类：<a href="http://onelose.com/sort/youdao">有道云笔记</a>
	 	</p>
	
 <div> 
 <h4 style='background-color: rgb(255, 255, 255); font-family: verdana, Arial, Helvetica, sans-serif;'><font size='3'>一、 下载redis最新版本2.2.14</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h4> 
 <blockquote style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'> 
  <p>cd /usr/local/src</p> 
  <p><font color='#444444'>wget –c&nbsp;<a title='http://redis.googlecode.com/files/redis-2.2.14.tar.gz' href='http://redis.googlecode.com/files/redis-2.2.14.tar.gz' style='color:rgb(0, 0, 0);'>http://redis.googlecode.com/files/redis-2.2.14.tar.gz</a></font></p> 
 </blockquote> 
 <h4 style='background-color: rgb(255, 255, 255); font-family: verdana, Arial, Helvetica, sans-serif;'><font size='3'>二、 编译安装redis</font></h4> 
 <blockquote style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'> 
  <p>tar zxvf redis-2.2.14.tar.gz</p> 
  <p>cd redis-2.2.14</p> 
  <p>make</p> 
 </blockquote> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>make命令执行完成后，会在src目录下生成5个可执行文件，分别是redis-server、redis-cli、redis-benchmark、redis-check-aof、redis-check-dump，它们的作用如下：<br>redis-server：Redis服务器的daemon启动程序<br>redis-cli：Redis命令行操作工具。当然，你也可以用telnet根据其纯文本协议来操作<br>redis-benchmark：Redis性能测试工具，测试Redis在你的系统及你的配置下的读写性能<br>redis-check-aof：更新日志检查</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>redis-check-dump：用于本地数据库检查</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>安装：</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>make PREFIX=/usr/local install</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>&nbsp;</p> 
 <h4 style='background-color: rgb(255, 255, 255); font-family: verdana, Arial, Helvetica, sans-serif;'>三、 配置 Redis</h4> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>&nbsp;</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>mkdir /etc/redis</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>cp redis.conf /etc/redis/redis.conf</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>mkdir&nbsp; /var/lib/redis</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>可从此处下载修改好的redis.conf&nbsp;<a href='http://files.cnblogs.com/hb_cattle/redis.zip' target='_blank' style='color:rgb(0, 0, 0);'>下载</a></p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>&nbsp;</p> 
 <h5 style='background-color: rgb(255, 255, 255); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 10pt;'>1. redis.conf 配置参数：</h5> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#是否作为守护进程运行</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>daemonize yes</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#如以后台进程运行，则需指定一个pid，默认为/var/run/redis.pid</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>pidfile redis.pid</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#绑定主机IP，默认值为127.0.0.1</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#bind 127.0.0.1</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#Redis默认监听端口</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>port 6379</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#客户端闲置多少秒后，断开连接，默认为300（秒）</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>timeout 300</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#日志记录等级，有4个可选值，debug，verbose（默认值），notice，warning</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>loglevel verbose</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#指定日志输出的文件名，默认值为stdout，也可设为/dev/null屏蔽日志</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>logfile stdout</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#可用数据库数，默认值为16，默认数据库为0</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>databases 16</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#保存数据到disk的策略</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#当有一条Keys数据被改变是，900秒刷新到disk一次</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>save 900 1</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#当有10条Keys数据被改变时，300秒刷新到disk一次</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>save 300 10</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#当有1w条keys数据被改变时，60秒刷新到disk一次</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>save 60 10000</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#当dump .rdb数据库的时候是否压缩数据对象</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>rdbcompression yes</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#本地数据库文件名，默认值为dump.rdb</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>dbfilename dump.rdb</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#本地数据库存放路径，默认值为 ./</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>dir /var/lib/redis/</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>########### Replication #####################</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#Redis的复制配置</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'># slaveof &lt;masterip&gt; &lt;masterport&gt; 当本机为从服务时，设置主服务的IP及端口</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'># masterauth &lt;master-password&gt; 当本机为从服务时，设置主服务的连接密码</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#连接密码</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'># requirepass foobared</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#最大客户端连接数，默认不限制</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'># maxclients 128</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#最大内存使用设置，达到最大内存设置后，Redis会先尝试清除已到期或即将到期的Key，当此方法处理后，任到达最大内存设置，将无法再进行写入操作。</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'># maxmemory &lt;bytes&gt;</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#是否在每次更新操作后进行日志记录，如果不开启，可能会在断电时导致一段时间内的数据丢失。因为redis本身同步数据文件是按上面save条件来同步的，所以有的数据会在一段时间内只存在于内存中。默认值为no</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>appendonly no</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#更新日志文件名，默认值为appendonly.aof</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#appendfilename</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#更新日志条件，共有3个可选值。no表示等操作系统进行数据缓存同步到磁盘，always表示每次更新操作后手动调用fsync()将数据写到磁盘，everysec表示每秒同步一次（默认值）。</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'># appendfsync always</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>appendfsync everysec</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'># appendfsync no</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>################ VIRTUAL MEMORY ###########</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#是否开启VM功能，默认值为no</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>vm-enabled no</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'># vm-enabled yes</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#虚拟内存文件路径，默认值为/tmp/redis.swap，不可多个Redis实例共享</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>vm-swap-file /tmp/redis.swap</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#将所有大于vm-max-memory的数据存入虚拟内存,无论vm-max-memory设置多小,所有索引数据都是内存存储的 (Redis的索引数据就是keys),也就是说,当vm-max-memory设置为0的时候,其实是所有value都存在于磁盘。默认值为0。</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>vm-max-memory 0</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>vm-page-size 32</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>vm-pages 134217728</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>vm-max-threads 4</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>############# ADVANCED CONFIG ###############</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>glueoutputbuf yes</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>hash-max-zipmap-entries 64</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>hash-max-zipmap-value 512</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>#是否重置Hash表</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>activerehashing yes</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>注意：Redis官方文档对VM的使用提出了一些建议:</p> 
 <ul style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'> 
  <li>当你的key很小而value很大时,使用VM的效果会比较好.因为这样节约的内存比较大.</li> 
  <li>当你的key不小时,可以考虑使用一些非常方法将很大的key变成很大的value,比如你可以考虑将key,value组合成一个新的value.</li> 
  <li>最好使用linux ext3 等对稀疏文件支持比较好的文件系统保存你的swap文件.</li> 
  <li>vm-max-threads这个参数,可以设置访问swap文件的线程数,设置最好不要超过机器的核数.如果设置为0,那么所有对swap文件的操作都是串行的.可能会造成比较长时间的延迟,但是对数据完整性有很好的保证.</li> 
 </ul> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>&nbsp;</p> 
 <h5 style='background-color: rgb(255, 255, 255); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 10pt;'>2. 调整系统内核参数</h5> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>如果内存情况比较紧张的话，需要设定内核参数：</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>echo 1 &gt; /proc/sys/vm/overcommit_memory</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>这里说一下这个配置的含义：/proc/sys/vm/overcommit_memory<br>该文件指定了内核针对内存分配的策略，其值可以是0、1、2。<br>0，表示内核将检查是否有足够的可用内存供应用进程使用；如果有足够的可用内存，内存申请允许；否则，内存申请失败，并把错误返回给应用进程。<br>1，表示内核允许分配所有的物理内存，而不管当前的内存状态如何。<br>2，表示内核允许分配超过所有物理内存和交换空间总和的内存<br>Redis在dump数据的时候，会fork出一个子进程，理论上child进程所占用的内存和parent是一样的，比如parent占用的内存为 8G，这个时候也要同样分配8G的内存给child, 如果内存无法负担，往往会造成redis服务器的down机或者IO负载过高，效率下降。所以这里比较优化的内存分配策略应该设置为 1（表示内核允许分配所有的物理内存，而不管当前的内存状态如何）</p> 
 <h4 style='background-color: rgb(255, 255, 255); font-family: verdana, Arial, Helvetica, sans-serif;'>&nbsp;</h4> 
 <h4 style='background-color: rgb(255, 255, 255); font-family: verdana, Arial, Helvetica, sans-serif;'>四. 运行 Redis</h4> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>&nbsp;</p> 
 <h5 style='background-color: rgb(255, 255, 255); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 10pt;'>1. 运行服务</h5> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>redis-server /etc/redis/redis.conf</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>即可在后台启动redis服务，确认运行了之后，可以用redis-benchmark命令测试看看，还可以通过redis-cli命令实际操作一下，比如：</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>redis-cli set foo bar</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>OK</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>redis-cli get foo</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>bar</p> 
 <h5 style='background-color: rgb(255, 255, 255); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 10pt;'>2. 关闭服务</h5> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>redis-cli shutdown</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>如果端口变化可以指定端口:</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>redis-cli -p 6380 shutdown</p> 
 <h5 style='background-color: rgb(255, 255, 255); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 10pt;'>3. 保存/备份</h5> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>数据备份可以通过定期备份该文件实现。<br>因为redis是异步写入磁盘的，如果要让内存中的数据马上写入硬盘可以执行如下命令：<br>redis-cli save 或者 redis-cli -p 6380 save（指定端口）<br>注意，以上部署操作需要具备一定的权限，比如复制和设定内核参数等。<br>执行redis-benchmark命令时也会将内存数据写入硬盘。</p> 
 <h5 style='background-color: rgb(255, 255, 255); font-family: verdana, Arial, Helvetica, sans-serif; font-size: 10pt;'>4. 同步机制</h5> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>redis实现的同步机制相对简单，缺少同步机制常见的check point和校验机制。<br>在运行时，如果master -&gt; slave同步请求转发被丢弃, slave将无法恢复该请求的相关信息，直到slave重启时从master全量加载数据时才能修复。因此，建议使用redis尽量利用其 key/value和value支持多种类型的特性，存储一些相对不重要的数据。</p> 
 <h4 style='background-color: rgb(255, 255, 255); font-family: verdana, Arial, Helvetica, sans-serif;'>&nbsp;</h4> 
 <h4 style='background-color: rgb(255, 255, 255); font-family: verdana, Arial, Helvetica, sans-serif;'><font size='3'>五. 自启动</font></h4> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>&nbsp;</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>从此处下载脚本&nbsp;&nbsp;<a href='http://files.cnblogs.com/hb_cattle/redis.zip' target='_blank' style='color:rgb(0, 0, 0);'>下载</a></p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>声明：此脚本来自网络，经过简单修改，已测，可用。</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>用这个脚本管理之前，需要先配置下面的内核参数，否则Redis脚本在重启或停止<a href='http://ipple.net/tag/redis' style='color:rgb(0, 0, 0);'>redis</a>时，将会报错，并且不能自动在停止服务前同步数据到磁盘上：</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>vi /etc/sysctl.conf</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>vm.overcommit_memory = 1</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>然后应用生效：<br>sysctl -p</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>然后增加服务并开机自启动：</p> 
 <p style='background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-family: verdana, Arial, Helvetica, sans-serif;'>chmod 755 /etc/init.d/redis<br>chkconfig --add redis<br>chkconfig --level 345 redis on<br>chkconfig --list redis</p> 
</div>
 	<p class="tag"></p>
	<div style="display:none;">et_highlighter51</div>	<div class="nextlog">		&laquo; <a href="http://onelose.com/post-539.html">ci数据库操作</a>
				|
				 <a href="http://onelose.com/post-555.html">17个新手常见Python运行时错误</a>&raquo;
	</div>
				    <div id="pagenavi">
	        </div>
		<div id="comment-place">
	<div class="comment-post" id="comment-post">
		<div class="cancel-reply" id="cancel-reply" style="display:none"><a href="javascript:void(0);" onclick="cancelReply()">取消回复</a></div>
		<p class="comment-header"><b>发表评论：</b><a name="respond"></a></p>
		<form method="post" name="commentform" action="http://onelose.com/index.php?action=addcom" id="commentform">
			<input type="hidden" name="gid" value="548" />
						<p>
				<input type="text" name="comname" maxlength="49" value="" size="22" tabindex="1">
				<label for="author"><small>昵称</small></label>
			</p>
			<p>
				<input type="text" name="commail"  maxlength="128"  value="" size="22" tabindex="2">
				<label for="email"><small>邮件地址 (选填)</small></label>
			</p>
			<p>
				<input type="text" name="comurl" maxlength="128"  value="" size="22" tabindex="3">
				<label for="url"><small>个人主页 (选填)</small></label>
			</p>
						<p><textarea name="comment" id="comment" rows="10" tabindex="4"></textarea></p>
			<p> <input type="submit" id="comment_submit" value="发表评论" tabindex="6" /></p>
			<input type="hidden" name="pid" id="comment-pid" value="0" size="22" tabindex="1"/>
		</form>
	</div>
	</div>
		<div style="clear:both;"></div>
</div><!--end #contentleft-->
<ul id="sidebar">
	<li>
	<h3><span>搜索</span></h3>
	<ul id="logsearch">
	<form name="keyform" method="get" action="http://onelose.com/index.php">
	<input name="keyword" class="search" type="text" />
	</form>
	</ul>
	</li>
	<li>
	<h3><span>最新微语</span></h3>
	<ul id="twitter">
			<li>诺基亚ceo可以对比尔盖茨说，主公，幸不辱命<p>2013-09-03 16:22</p></li>
			<li>换空间了<p>2013-09-02 23:28</p></li>
			<li>玩上古剑奇谭2了，画质非常好<p>2013-08-20 14:08</p></li>
			<li>最打算更新这个模板，估计会用上php<p>2013-08-16 23:10</p></li>
			<li>模板在emlog官网已经下载超过100次~\(≧▽≦)/~啦啦啦<p>2013-08-02 21:33</p></li>
	    	<p><a href="http://onelose.com/t/">更多&raquo;</a></p>
		</ul>
	</li>
	<li>
	<h3><span>随机文章</span></h3>
	<ul id="randlog">
		<li><a href="http://onelose.com/post-277.html">ubuntu程序后台运行几个方法</a></li>
		<li><a href="http://onelose.com/post-489.html">UncaughtTypeError:undefinedisnotafunction</a></li>
		<li><a href="http://onelose.com/post-315.html">一个页面多个id的情况，js怎么处理</a></li>
		<li><a href="http://onelose.com/post-340.html">如何编写OpenStack文档rst文件</a></li>
		<li><a href="http://onelose.com/post-221.html">TortoiseSVN文件夹及文件图标不显示解决方法</a></li>
		</ul>
	</li>
	<li>
	<h3><span>最新文章</span></h3>
	<ul id="newlog">
		<li><a href="http://onelose.com/post-204.html">Redis数据库安全手册</a></li>
		<li><a href="http://onelose.com/post-200.html">MongoDB服务器端的JavaScript注入</a></li>
		<li><a href="http://onelose.com/post-202.html">http://www.freebuf.com/author/unshell</a></li>
		<li><a href="http://onelose.com/post-211.html">mysql性能优化方向</a></li>
		<li><a href="http://onelose.com/post-209.html">开源消息队列MemcacheQ在Linux中编译安装教程</a></li>
		</ul>
	</li>
	<li>
	<h3><span>最新评论</span></h3>
	<ul id="newcomment">
		<li id="comment">你大爷	<br /><a href="http://onelose.com/post-216.html#5096">我搞定了哈哈,不告诉你我是谁</a></li>
		<li id="comment">网络精灵	<br /><a href="http://onelose.com/post-113.html#4948">我想问改一下你的魔板的问题，能加下我QQ...</a></li>
		<li id="comment">9格购	<br /><a href="http://onelose.com/post-169.html#4698">很不错的模板</a></li>
		<li id="comment">陈正杰博客	<br /><a href="http://onelose.com/post-113.html#4649">好像很就没有更新内容了哟</a></li>
		<li id="comment">迷茫者	<br /><a href="http://onelose.com/post-113.html#4647">@彼岸时光网：O(∩_∩)O~&nbsp;&nbsp; 欢迎...</a></li>
		</ul>
	</li>
	<li>
	<h3><span>分类</span></h3>
	<ul id="blogsort">
		<li>
	<a href="http://onelose.com/sort/youdao">有道云笔记(305)</a>
	<a href="http://onelose.com/rss.php?sort=19"><img src="http://onelose.com/content/templates/dpp_icecream_02/images/rss.png" alt="订阅该分类"/></a>
			<li>
	<a href="http://onelose.com/sort/notes">学习笔记(8)</a>
	<a href="http://onelose.com/rss.php?sort=18"><img src="http://onelose.com/content/templates/dpp_icecream_02/images/rss.png" alt="订阅该分类"/></a>
			<li>
	<a href="http://onelose.com/sort/4">生活(1)</a>
	<a href="http://onelose.com/rss.php?sort=4"><img src="http://onelose.com/content/templates/dpp_icecream_02/images/rss.png" alt="订阅该分类"/></a>
			<li>
	<a href="http://onelose.com/sort/5">网站(7)</a>
	<a href="http://onelose.com/rss.php?sort=5"><img src="http://onelose.com/content/templates/dpp_icecream_02/images/rss.png" alt="订阅该分类"/></a>
			<li>
	<a href="http://onelose.com/sort/6">服务器(1)</a>
	<a href="http://onelose.com/rss.php?sort=6"><img src="http://onelose.com/content/templates/dpp_icecream_02/images/rss.png" alt="订阅该分类"/></a>
			<li>
	<a href="http://onelose.com/sort/7">动画片(1)</a>
	<a href="http://onelose.com/rss.php?sort=7"><img src="http://onelose.com/content/templates/dpp_icecream_02/images/rss.png" alt="订阅该分类"/></a>
			<li>
	<a href="http://onelose.com/sort/16">作业(1)</a>
	<a href="http://onelose.com/rss.php?sort=16"><img src="http://onelose.com/content/templates/dpp_icecream_02/images/rss.png" alt="订阅该分类"/></a>
			<li>
	<a href="http://onelose.com/sort/17">大学(1)</a>
	<a href="http://onelose.com/rss.php?sort=17"><img src="http://onelose.com/content/templates/dpp_icecream_02/images/rss.png" alt="订阅该分类"/></a>
			</ul>
	</li>
	<li>
	<h3><span>存档</span></h3>
	<ul id="record">
		<li><a href="http://onelose.com/record/201504">2015年4月(23)</a></li>
		<li><a href="http://onelose.com/record/201503">2015年3月(69)</a></li>
		<li><a href="http://onelose.com/record/201502">2015年2月(9)</a></li>
		<li><a href="http://onelose.com/record/201501">2015年1月(57)</a></li>
		<li><a href="http://onelose.com/record/201412">2014年12月(46)</a></li>
		<li><a href="http://onelose.com/record/201411">2014年11月(16)</a></li>
		<li><a href="http://onelose.com/record/201410">2014年10月(18)</a></li>
		<li><a href="http://onelose.com/record/201409">2014年9月(9)</a></li>
		<li><a href="http://onelose.com/record/201408">2014年8月(10)</a></li>
		<li><a href="http://onelose.com/record/201407">2014年7月(17)</a></li>
		<li><a href="http://onelose.com/record/201406">2014年6月(5)</a></li>
		<li><a href="http://onelose.com/record/201405">2014年5月(7)</a></li>
		<li><a href="http://onelose.com/record/201404">2014年4月(21)</a></li>
		<li><a href="http://onelose.com/record/201402">2014年2月(7)</a></li>
		<li><a href="http://onelose.com/record/201401">2014年1月(2)</a></li>
		<li><a href="http://onelose.com/record/201309">2013年9月(3)</a></li>
		<li><a href="http://onelose.com/record/201308">2013年8月(5)</a></li>
		<li><a href="http://onelose.com/record/201307">2013年7月(4)</a></li>
		<li><a href="http://onelose.com/record/201105">2011年5月(2)</a></li>
		<li><a href="http://onelose.com/record/201104">2011年4月(3)</a></li>
		<li><a href="http://onelose.com/record/201103">2011年3月(8)</a></li>
		<li><a href="http://onelose.com/record/201102">2011年2月(4)</a></li>
		<li><a href="http://onelose.com/record/201101">2011年1月(7)</a></li>
		<li><a href="http://onelose.com/record/201012">2010年12月(18)</a></li>
		<li><a href="http://onelose.com/record/201011">2010年11月(4)</a></li>
		<li><a href="http://onelose.com/record/201010">2010年10月(18)</a></li>
		<li><a href="http://onelose.com/record/201009">2010年9月(1)</a></li>
		<li><a href="http://onelose.com/record/201008">2010年8月(1)</a></li>
		<li><a href="http://onelose.com/record/201003">2010年3月(1)</a></li>
		</ul>
	</li>
	<li>
	<h3><span>链接</span></h3>
	<ul id="link">
		<li><a href="http://www.swoole.com/" title="Swoole：重新定义PHP" target="_blank">Swoole</a></li>
		<li><a href="http://rango.swoole.com/" title="" target="_blank">韩天峰(Rango)</a></li>
		<li><a href="http://www.laruence.com/" title="" target="_blank">风雪之隅</a></li>
		<li><a href="http://blog.csdn.net/ldy3243942" title="" target="_blank">ldy3243942的专栏</a></li>
		<li><a href="http://programmer.csdn.net/" title="" target="_blank">程序员</a></li>
		<li><a href="http://www.mysqlsupport.cn/" title="" target="_blank">mysqlsupport</a></li>
		<li><a href="http://www.ttlsa.com/" title="" target="_blank">运维生存时间</a></li>
		<li><a href="http://imysql.com/" title="" target="_blank">MySQL中文网</a></li>
		<li><a href="http://jinnianshilongnian.iteye.com/" title="" target="_blank">开涛的博客</a></li>
		<li><a href="http://www.imsiren.com/" title="Where Amaze happen，Where I Am !" target="_blank">斯人-吴帅</a></li>
		<li><a href="http://blog.41ms.com/" title="" target="_blank">松鼠先生</a></li>
		</ul>
	</li>
	<li>
	<h3><span>蝴蝶</span></h3>
	<ul>
	<CENTER><EMBED style="RIGHT: 10px; POSITION: absolute; TOP: -40px" align=right src=http://onelose.com/butterfly.swf width=160 height=200 type=application/x-shockwave-flash wmode="transparent" quality="high" ;></CENTER>	</ul>
	</li>
<div class="rss">
<a href="http://onelose.com/rss.php" title="RSS订阅"><img src="http://onelose.com/content/templates/dpp_icecream_02/images/rss.gif" alt="订阅Rss"/></a>
</div>
</ul><!--end #siderbar-->
</div><!--end #content-->
<div style="clear:both;"></div>
<div id="footerbar">
	Design By blogbus | Theme By <a href="http://onelose.com" title="迷茫者博客">迷茫者</a> | Powered by <a href="http://www.emlog.net" title="emlog 5.1.2">emlog</a> |  
	<a href="http://www.miibeian.gov.cn" target="_blank">苏ICP备10020146号-1</a> | 	
<script type="text/javascript">$(function(){$.get("http://onelose.com/?plugin=autopub");})</script>
<script type="text/javascript" src="http://onelose.com/content/plugins/SHJS_for_Emlog/sh_main.min.js"></script><a href="http://onelose.com/sitemap.xml" rel="sitemap">sitemap</a></div><!--end #footerbar-->
</div><!--end #wrap-->
<script>prettyPrint();</script>

<div id="returnhome"><a href="#"><img src="http://onelose.com/content/templates/dpp_icecream_02/images/home.png" title="返回" alt="header" id="returnhome_img"></a></div>

</body>
</html>