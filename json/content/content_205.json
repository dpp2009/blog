{"gid":"205","title":"MemcacheQ\u5b89\u88c5\u53ca\u4f7f\u7528","date":"1428530400","content":"\r\n <div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><span style='font-size:24px;'><strong>\u4e00. \u5b89\u88c5<\/strong><\/span><br><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>MemcacheQ \u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5206\u5e03\u5f0f\u961f\u5217\u670d\u52a1\uff0c\u5b83\u7684\u8fd0\u884c\u4f9d\u8d56\u4e8eBerkeleyDB \u548c libevent\uff0c\u6240\u4ee5\u9700\u8981\u5148\u5b89\u88c5BerkeleyDB\u548clibevent.<\/p> \r\n <div style='background-color: rgb(255, 255, 255); font-family: Arial;'> \r\n  <h2>Berkeley DB 4.7 or later<\/h2> \r\n  <p>Download from &lt;<a href='http:\/\/www.oracle.com\/database\/berkeley-db\/db\/index.html' style='color:rgb(34, 0, 0);'>http:\/\/www.oracle.com\/database\/berkeley-db\/db\/index.html<\/a>&gt;<\/p> \r\n  <p>How to install BerkeleyDB:<\/p> \r\n  <pre>$tar -xvzf db-5.3.21.tar.gz\r\n$cd db-5.3.21\/\r\n$cd build_unix\/\r\n$..\/dist\/configure\r\n$make\r\n$make install\r\n\r\n\u5b89\u88c5BerkeleyDB\u65f6\uff0c\u53ef\u4ee5\u624b\u52a8\u6307\u5b9a\u5b89\u88c5\u8def\u5f84:<pre>..\/dist\/configure --prefix=\/usr\/local\/berkeleydb<\/pre>\u4e0d\u6307\u5b9a\u7684\u8bdd\uff0c\u9ed8\u8ba4\u5b89\u88c5\u5728:\/usr\/local\/BerkeleyDB.5.3<br><\/pre> \r\n <\/div> \r\n <div style='background-color: rgb(255, 255, 255); font-family: Arial;'> \r\n  <h2>libevent 1.4.x or later<\/h2> \r\n  <p>\u5148\u68c0\u67e5libevent \u662f\u5426\u5df2\u7ecf\u5b89\u88c5:<\/p> \r\n  <p>#rpm -qa|grep libevent<br>libevent-devel-2.0.10-2.fc15.x86_64<br>libevent-2.0.10-2.fc15.x86_64<br>libevent-2.0.10-2.fc15.i686<\/p> \r\n  <p>\u6216\u8005\uff1a<\/p> \r\n  <p>ls -al \/usr\/lib |grep libevent<\/p> \r\n  <p>\u5982\u679c\u8fd8\u6ca1\u6709\u5b89\u88c5\uff1a<br>Download from &lt;<a href='http:\/\/monkey.org\/~provos\/libevent\/' style='color:rgb(202, 0, 0);'>http:\/\/monkey.org\/~provos\/libevent\/<\/a>&gt;<\/p> \r\n  <p>How to install libevent:<\/p> \r\n  <pre>$tar -xvzf libevent-1.4.x-stable.tar.gz\r\n$cd libevent-1.4.x-stable\r\n$.\/configure\r\n$make\r\n$make install\r\n<\/pre> \r\n  <pre>\u5b89\u88c5libevent\u65f6\uff0c\u53ef\u4ee5\u624b\u52a8\u6307\u5b9a\u5b89\u88c5\u8def\u5f84:<pre>.\/configure --prefix=\/usr\/local\/libevent<\/pre>\u4e0d\u6307\u5b9a\u7684\u8bdd\uff0c\u9ed8\u8ba4\u5b89\u88c5\u5728:\/usr\/lib64(64\u4f4d\u7cfb\u7edf)\u6216\u8005\/usr\/lib(32\u4f4d\u7cfb\u7edf)<\/pre> \r\n  <br> \r\n <\/div> \r\n <h3 style='background-color: rgb(255, 255, 255); font-family: Arial;'>memcacheQ<\/h3> \r\n <p style='background-color: rgb(204, 204, 204); font-family: Arial;'>\u4e0b\u8f7d\u8f6f\u4ef6\u5305\uff1ahttp:\/\/code.google.com\/p\/memcacheq\/downloads\/list<\/p> \r\n <p style='background-color: rgb(204, 204, 204); font-family: Arial;'>\u89e3\u538b\u7f29\uff0ccd\u8fdb\u76ee\u5f55<\/p> \r\n <p style='background-color: rgb(204, 204, 204); font-family: Arial;'>.\/configure&nbsp;&nbsp; --enable-threads<\/p> \r\n <p style='background-color: rgb(204, 204, 204); font-family: Arial;'>make<\/p> \r\n <p style='background-color: rgb(204, 204, 204); font-family: Arial;'><span style='background-color: rgb(255, 204, 204);'>make install<\/span><br><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>configure \u65f6\uff0c\u5982\u679clibevent \u4e0d\u662f\u5b89\u88c5\u5728\u9ed8\u8ba4\u76ee\u5f55\uff0c\u9700--with--libevent=\/usr\/local\/libevent\u6307\u5b9alibevent\u7684\u5b89\u88c5\u76ee\u5f55<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u82e5\u6ca1\u6709\u5c06<\/p> \r\n <pre style='background-color: rgb(255, 255, 255);'>\/usr\/local\/lib\r\n\/usr\/local\/BerkeleyDB.5.3\/lib\r\n\u6dfb\u52a0\u8fdb\/etc\/ld.so.conf \u5e76\u8fd0\u884c \/sbin\/ldconfig \u5219\u9700--with-bdb=\/usr\/local\/BerkeleyDB.5.3 \u6307\u5b9aberkeleyDb\u5e93\u7684\u8def\u5f84\r\n<\/pre> \r\n <br style='background-color: rgb(255, 255, 255); font-family: Arial;'> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><span style='font-size:24px;'><strong>\u4e8c.\u4f7f\u7528<\/strong><\/span><\/p> \r\n <h3 style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u542f\u52a8memcacheQ<\/h3> \r\n <ol style='background-color: rgb(255, 255, 255); font-family: Arial;'> \r\n  <li>\u4f7f\u7528memcacheq -h \u7684\u547d\u4ee4\u6765\u67e5\u770b\u547d\u4ee4\u884c\u9009\u9879<\/li> \r\n  <li>\u542f\u52a8memcacheq\uff1amemcacheq -d -u nobody -r -H \/tmp\/memcacheq -N -R -v -L 1024 -B 1024 &gt; \/tmp\/mq_error.log 2&gt;&amp;1<\/li> \r\n <\/ol> \r\n <span style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u542f\u52a8\u65f6\u9700-u \u53c2\u6570\uff0c\u6307\u5b9a\u8fd0\u884cmemcacheQ\u7684\u7528\u6237\uff0c\u4e14\u6307\u5b9a\u7684\u7528\u6237\u5fc5\u987b\u6709\u6570\u636e\u6587\u4ef6\u7684\u8bfb\u5199\u6743\u9650,\u5982\u8fd9\u91cc\u7684\/tmp\/memcacheQ\u76ee\u5f55,\u5426\u5219\u4e0d\u80fd\u542f\u52a8<\/span> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><br><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><span style='font-size:12px;'><strong>\u547d\u4ee4\u884c\u4f7f\u7528memcacheQ<\/strong><\/span><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><span style='font-size:12px;'>telnet 127.0.0.1 22202<\/span><\/p> \r\n <div style='background-color: rgb(255, 255, 255); font-family: Arial;'>\r\n   Trying 127.0.0.1\u2026 \r\n <\/div> \r\n <div style='background-color: rgb(255, 255, 255); font-family: Arial;'>\r\n   Connected to 127.0.0.1. \r\n <\/div> \r\n <div style='background-color: rgb(255, 255, 255); font-family: Arial;'>\r\n   Escape character is \u2018^]\u2019. \r\n <\/div> \r\n <strong style='background-color: rgb(255, 255, 255); font-family: Arial;'><br><\/strong> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u53ea\u6709\u4e24\u4e2a\u547d\u4ee4\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u4e0b\u4f7f\u7528memcacheQ<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u5199\u5bf9\u5217\uff1a<br><\/p> \r\n <pre style='background-color: rgb(255, 255, 255);'>set &lt;queue name&gt; &lt;flags&gt; 0 &lt;message_len&gt;\\r\\n\r\n&lt;put your message body here&gt;\\r\\n\r\nSTORED\\r\\n<\/pre> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u53d6\u51fa\u961f\u5217\uff1a<\/p> \r\n <pre style='background-color: rgb(255, 255, 255);'>get &lt;queue name&gt;\\r\\n\r\nVALUE &lt;queue name&gt; &lt;flags&gt; &lt;message_len&gt;\\r\\n\r\n&lt;your message body will come here&gt;\\r\\n\r\nEND\\r\\n\r\n<\/pre> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u4e0ememcache\u534f\u8bae\u57fa\u672c\u4e00\u81f4\uff0c\u53ea\u662f\u628akey name\u6362\u6210queue name\uff0c\u800c\u4e14\u5728set\u7684\u547d\u4ee4\u4e2d\uff0c\u5ffd\u7565\u4e86expire_time\u7684\u53c2\u6570\u3002mq\u7684\u6570\u636e\u5b58\u50a8\u662f\u5b58\u5728berkeleyDB\u4e2d\uff0c\u505a\u4e86\u6301\u4e45\u5316\u5b58\u50a8\uff0c\u6ca1\u6709\u5185\u5b58\u7684\u8fc7\u671f\u65f6\u95f4\u3002<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u793a\u4f8b\uff1a<\/p> \r\n <blockquote style='background-color: rgb(255, 255, 255); font-family: Arial;'> \r\n  <div>\r\n    &nbsp;telnet 127.0.0.1 22202 \r\n  <\/div> \r\n  <div>\r\n    Trying 127.0.0.1\u2026 \r\n  <\/div> \r\n  <div>\r\n    Connected to 127.0.0.1. \r\n  <\/div> \r\n  <div>\r\n    Escape character is \u2018^]\u2019. \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(51, 153, 102);'>set q4 0 0 5<\/span> \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(51, 153, 102);'>hello<\/span> \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(51, 153, 102);'>STORED<\/span> \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(51, 153, 102);'>set q4 0 0 5<\/span> \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(51, 153, 102);'>world<\/span> \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(51, 153, 102);'>STORED<\/span> \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(51, 102, 255);'>stats queue<\/span> \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(51, 102, 255);'>STAT q4 2\/0<\/span> \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(51, 102, 255);'>END<\/span> \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(255, 102, 0);'>get q4<\/span> \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(255, 102, 0);'>VALUE q4 0 5<\/span> \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(255, 102, 0);'>hello<\/span> \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(255, 102, 0);'>END<\/span> \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(51, 102, 255);'>stats queue<\/span> \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(51, 102, 255);'>STAT q4 2\/1<\/span> \r\n  <\/div> \r\n  <div> \r\n   <span style='color:rgb(51, 102, 255);'>END<\/span> \r\n  <\/div> \r\n <\/blockquote> \r\n <span style='background-color: rgb(255, 255, 255); font-family: Arial; font-size: 18px;'><strong>\u4e09.\u5b89\u88c5\u4f7f\u7528\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u51fa\u73b0\u7684\u9519\u8bef<\/strong><\/span> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>1.\u7f16\u8bd1\u51fa\u73b0\u9519\u8bef\uff1achecking for library containing db_create... no<br>configure: error: cannot find libdb.so in \/usr\/local\/BerkeleyDB.5.3\/lib<br>\u9700\u8981\u4fee\u6539 configure \u4e2d\u7684BerkeleyDB\u4e2d\u7684\u9884\u7f16\u8bd1\u53c2\u6570vim configure\u627e\u5230bdbdir='\/usr\/local\/berkeleydb'\u6539\u4e3a<br>bdbdir='\/usr\/local\/BerkeleyDB.5.3'\u518d\u6b21\u7f16\u8bd1<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><br><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>2.configure: error: cannot find libdb.so in \/usr\/local\/BerkeleyDB.5.3\/lib<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u51fa\u73b0\u6b64\u9519\u8bef\u7684\u539f\u56e0\u5728\u4e8e\u6ca1\u6709\u5b89\u88c5BerkyleyDb,\u5b89\u88c5\u5373\u53ef<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><br><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>3.\/usr\/local\/memcacheq\/bin\/memcachq -h<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;\u8fd0\u884c\u62a5\uff1a<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;memcacheq: error while loading shared libraries: libdb-5.3.so: cannot open shared object file: No such file or directory<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;\u89e3\u51b3\u65b9\u6cd5\uff1aln -s \/usr\/local\/BerkeleyDB.5.3\/lib\/libdb-5.3.so \/usr\/lib\/libdb-5.3.so<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><span style='color:rgb(255, 0, 0);'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \u6ce8\uff1a\u572864\u4f4d\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u9700\u6267\u884c<\/span><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><span style='color:rgb(255, 0, 0);'>ln -s \/usr\/local\/BerkeleyDB.5.3\/lib\/libdb-5.3.so \/usr\/lib64\/libdb-5.3.so<\/span><br><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><br><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u672c\u6587\u53c2\u8003\u7f51\u5740:<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>http:\/\/www.niutian365.com\/blog\/article.asp?id=463<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>http:\/\/web2.0coder.com\/archives\/197<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>http:\/\/www.cnblogs.com\/sunzy\/archive\/2012\/04\/13\/2446234.html<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u5b98\u65b9\u7f51\u7ad9:<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>http:\/\/memcachedb.org\/memcacheq\/<br><\/p> \r\n <br> \r\n<\/div>\r\n ","excerpt":"\u00a0\u4e00.\u5b89\u88c5MemcacheQ\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5206\u5e03\u5f0f\u961f\u5217\u670d\u52a1\uff0c\u5b83\u7684\u8fd0\u884c\u4f9d\u8d56\u4e8eBerkeleyDB\u548clibevent\uff0c\u6240\u4ee5\u9700\u8981\u5148\u5b89\u88c5BerkeleyDB\u548clibevent.BerkeleyDB4.7orlaterDownloadfrom<http:\/\/www.oracle.com\/data","author":"1","sortid":"19","type":"blog","views":"247","comnum":"0","tbcount":"0","attnum":"0","top":"n","hide":"n","allow_remark":"y","allow_tb":"y","password":"","thumb":"0","alias":""}