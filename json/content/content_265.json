{"gid":"265","title":"PHP\u5b89\u88c5\u4e0e\u4f7f\u7528VLD\u67e5\u770bopcode\u4ee3\u7801\u3010PHP\u5b89\u88c5\u7b2c\u4e09\u65b9\u6269\u5c55\u7684\u65b9\u6cd5\u3011","date":"1426633200","content":"\r\n <div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u9700\u8981\u5206\u6790PHP\u4ee3\u7801\u7684\u6027\u80fd\uff0c\u6216\u8005\u8bf4\u5b9e\u73b0\u540c\u6837\u529f\u80fd\u7684\u4ee3\u7801\u5230\u5e95\u54ea\u4e2a\u66f4\u597d\u5462\uff1f\u6216\u8005\u8bf4\u60f3\u77e5\u9053\u5e95\u5c42\u7684\u5b9e\u73b0\u53ef\u4ee5\u4f7f\u7528VLD\u67e5\u770bopcode<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><strong>\u4e0b\u8f7d\u4e0e\u5b89\u88c5VLD<\/strong><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><span style='background-color:rgb(255, 255, 0);'># wget&nbsp;<\/span><a href='http:\/\/pecl.php.net\/get\/vld-0.10.1.tgz' style='color:rgb(255, 153, 0);'><span style='background-color:rgb(255, 255, 0);'>http:\/\/pecl.php.net\/get\/vld-0.11.2.tgz<\/span><\/a><br><span style='background-color:rgb(255, 255, 0);'># tar zxvf vld-0.11.2.tgz<br># cd .\/vld-0.11.2<br># \/usr\/local\/php\/bin\/phpize<span style='background-color:rgb(255, 255, 255);'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \u6216\u8005\u76f4\u63a5phpize<\/span><br># .\/configure --with-php-config=\/usr\/local\/php\/bin\/php-config --enable-vld<br># make &amp;&amp; make install<\/span><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>---------------------------------<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u7f16\u8f91php.ini\u6587<wbr>\u4ef6\u6fc0\u6d3bvld\u6269\u5c55\uff1a<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>php.ini\u4f4d\u7f6e<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><span style='background-color:rgb(255, 255, 0);'>#cd \/usr\/local\/php\/lib<\/span><br><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u589e\u52a0<br>extension=<wbr>vld.so<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u91cd\u542fApache\uff1a<br><span style='background-color:rgb(255, 255, 0);'># \/usr\/local\/apache2\/bin\/apachectl restart<br><\/span>---------------------------------&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u67e5\u770bphpinfo()\u4fe1\u606f<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><img src='http:\/\/note.youdao.com\/yws\/res\/2573\/4B6F11848F99411AB13005071E8C7F11' data-media-type='image'><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>--------------------------------<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u81f3\u6b64,VLD\u5c31\u5b89\u88c5\u5b8c\u4e86\u3002\u5199\u4e2a\u7b80\u5355\u7684test.php<\/p> \r\n <div style='background-color: rgb(231, 229, 220); font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px;'> \r\n  <div style='background-color: rgb(248, 248, 248); color: silver; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 9px;'> \r\n   <b>[php]<\/b>&nbsp; \r\n   <a title='view plain' href='http:\/\/blog.csdn.net\/21aspnet\/article\/details\/7002644#' style='color: rgb(160, 160, 160);'>view plain<\/a> \r\n   <a title='copy' href='http:\/\/blog.csdn.net\/21aspnet\/article\/details\/7002644#' style='color: rgb(160, 160, 160);'>copy<\/a> \r\n  <\/div> \r\n  <ol start='1' style='background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);'> \r\n   <li style='background-color:rgb(255, 255, 255);color:inherit;'><span style='color: black;'><span style='color: rgb(221, 0, 0);'>$a<\/span>=<span style='color: blue;'>'123'<\/span>;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color: rgb(248, 248, 248);'><span style='color: black;'>echo&nbsp;<span style='color: rgb(221, 0, 0);'>$a<\/span>;&nbsp;&nbsp;<\/span><\/li> \r\n  <\/ol> \r\n <\/div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><br>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><span style='background-color:rgb(255, 255, 0);'># php -dvld.active=1 .\/test.php<\/span><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u5982\u679c\u6ca1\u6709\u8bbe\u7f6ephp\u73af\u5883\u53d8\u91cf\u7684\u8bdd<br><br><span style='background-color:rgb(255, 255, 0);'>#\/usr\/local\/php\/bin\/php&nbsp; -dvld.active=1&nbsp; test.php<br><\/span><br><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u67e5\u770b\u7ed3\u679c<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><img src='http:\/\/note.youdao.com\/yws\/res\/2574\/D5015F7FD95840E391DD4A44BE3BFBF1' data-media-type='image'><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u5982\u4e0a\u4e3aVLD\u8f93\u51fa\u7684PHP\u4ee3\u7801\u751f\u6210\u7684\u4e2d\u95f4\u4ee3\u7801\u7684\u4fe1\u606f\uff0c\u8bf4\u660e\u5982\u4e0b\uff1a<\/p> \r\n <ul style='background-color: rgb(255, 255, 255); font-family: Arial;'> \r\n  <li>Branch analysis from position \u8fd9\u6761\u4fe1\u606f\u591a\u5728\u5206\u6790\u6570\u7ec4\u65f6\u4f7f\u7528\u3002<\/li> \r\n  <li>Return found \u662f\u5426\u8fd4\u56de\uff0c\u8fd9\u4e2a\u57fa\u672c\u4e0a\u6709\u90fd\u6709\u3002<\/li> \r\n  <li>filename \u5206\u6790\u7684\u6587\u4ef6\u540d<\/li> \r\n  <li>function name \u51fd\u6570\u540d\uff0c\u9488\u5bf9\u6bcf\u4e2a\u51fd\u6570VLD\u90fd\u4f1a\u751f\u6210\u4e00\u6bb5\u5982\u4e0a\u7684\u72ec\u7acb\u7684\u4fe1\u606f\uff0c\u8fd9\u91cc\u663e\u793a\u5f53\u524d\u51fd\u6570\u7684\u540d\u79f0<\/li> \r\n  <li>number of ops \u751f\u6210\u7684\u64cd\u4f5c\u6570<\/li> \r\n  <li>compiled vars \u7f16\u8bd1\u671f\u95f4\u7684\u53d8\u91cf\uff0c\u8fd9\u4e9b\u53d8\u91cf\u662f\u5728PHP5\u540e\u6dfb\u52a0\u7684\uff0c\u5b83\u662f\u4e00\u4e2a\u7f13\u5b58\u4f18\u5316\u3002\u8fd9\u6837\u7684\u53d8\u91cf\u5728PHP\u6e90\u7801\u4e2d\u4ee5IS_CV\u6807\u8bb0\u3002<\/li> \r\n  <li>op list \u751f\u6210\u7684\u4e2d\u95f4\u4ee3\u7801\u7684\u53d8\u91cf\u5217\u8868<\/li> \r\n <\/ul> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u4f7f\u7528-dvld.active\u53c2\u6570\u8f93\u51fa\u7684\u662fVLD\u9ed8\u8ba4\u8bbe\u7f6e\uff0c\u5982\u679c\u60f3\u770b\u66f4\u52a0\u8be6\u7ec6\u7684\u5185\u5bb9\u3002\u53ef\u4ee5\u4f7f\u7528-dvld.verbosity\u53c2\u6570\u3002<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>#php -dvld.active=1 -dvld.verbosity=3 text.php<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>-dvld.verbosity=3\u662fVLD\u5728\u5f53\u524d\u7248\u672c\u53ef\u4ee5\u663e\u793a\u7684\u6700\u8be6\u7ec6\u7684\u4fe1\u606f.<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u5982\u679c\u6211\u4eec\u53ea\u662f\u60f3\u8981\u770b\u8f93\u51fa\u7684\u4e2d\u95f4\u4ee3\u7801\uff0c\u5e76\u4e0d\u60f3\u6267\u884c\u8fd9\u6bb5PHP\u4ee3\u7801\uff0c\u53ef\u4ee5\u4f7f\u7528-dvld.execute=0\u6765\u7981\u7528\u4ee3\u7801\u7684\u6267\u884c<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>#php -dvld.active=1 -dvld.execute=0 text.php<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>VLD\u6269\u5c55\u7684\u53c2\u6570\u5217\u8868\uff1a<\/p> \r\n <ul style='background-color: rgb(255, 255, 255); font-family: Arial;'> \r\n  <li>-dvld.active \u662f\u5426\u5728\u6267\u884cPHP\u65f6\u6fc0\u6d3bVLD\u6302\u94a9\uff0c\u9ed8\u8ba4\u4e3a0\uff0c\u8868\u793a\u7981\u7528\u3002\u53ef\u4ee5\u4f7f\u7528-dvld.active=1\u542f\u7528\u3002<\/li> \r\n  <li>-dvld.skip_prepend \u662f\u5426\u8df3\u8fc7php.ini\u914d\u7f6e\u6587\u4ef6\u4e2d<a href='http:\/\/php.net\/auto-prepend-file' style='color:rgb(18, 153, 218);'>auto_prepend_file<\/a>\u6307\u5b9a\u7684\u6587\u4ef6\uff0c \u9ed8\u8ba4\u4e3a0\uff0c\u5373\u4e0d\u8df3\u8fc7\u5305\u542b\u7684\u6587\u4ef6\uff0c\u663e\u793a\u8fd9\u4e9b\u5305\u542b\u7684\u6587\u4ef6\u4e2d\u7684\u4ee3\u7801\u6240\u751f\u6210\u7684\u4e2d\u95f4\u4ee3\u7801\u3002\u6b64\u53c2\u6570\u751f\u6548\u6709\u4e00\u4e2a\u524d\u63d0\u6761\u4ef6\uff1a-dvld.execute=0<\/li> \r\n  <li>-dvld.skip_append \u662f\u5426\u8df3\u8fc7php.ini\u914d\u7f6e\u6587\u4ef6\u4e2d<a href='http:\/\/php.net\/auto-append-file' style='color:rgb(18, 153, 218);'>auto_append_file<\/a>\u6307\u5b9a\u7684\u6587\u4ef6\uff0c \u9ed8\u8ba4\u4e3a0\uff0c\u5373\u4e0d\u8df3\u8fc7\u5305\u542b\u7684\u6587\u4ef6\uff0c\u663e\u793a\u8fd9\u4e9b\u5305\u542b\u7684\u6587\u4ef6\u4e2d\u7684\u4ee3\u7801\u6240\u751f\u6210\u7684\u4e2d\u95f4\u4ee3\u7801\u3002\u6b64\u53c2\u6570\u751f\u6548\u6709\u4e00\u4e2a\u524d\u63d0\u6761\u4ef6\uff1a-dvld.execute=0<\/li> \r\n  <li>-dvld.execute \u662f\u5426\u6267\u884c\u8fd9\u6bb5PHP\u811a\u672c\uff0c\u9ed8\u8ba4\u503c\u4e3a1\uff0c\u8868\u793a\u6267\u884c\u3002\u53ef\u4ee5\u4f7f\u7528-dvld.execute=0\uff0c\u8868\u793a\u53ea\u663e\u793a\u4e2d\u95f4\u4ee3\u7801\uff0c\u4e0d\u6267\u884c\u751f\u6210\u7684\u4e2d\u95f4\u4ee3\u7801\u3002<\/li> \r\n  <li>-dvld.format \u662f\u5426\u4ee5\u81ea\u5b9a\u4e49\u7684\u683c\u5f0f\u663e\u793a\uff0c\u9ed8\u8ba4\u4e3a0\uff0c\u8868\u793a\u5426\u3002\u53ef\u4ee5\u4f7f\u7528-dvld.format=1\uff0c\u8868\u793a\u4ee5\u81ea\u5df1\u5b9a\u4e49\u7684\u683c\u5f0f\u663e\u793a\u3002\u8fd9\u91cc\u81ea\u5b9a\u4e49\u7684\u683c\u5f0f\u8f93\u51fa\u662f\u4ee5-dvld.col_sep\u6307\u5b9a\u7684\u53c2\u6570\u95f4\u9694<\/li> \r\n  <li>-dvld.col_sep \u5728-dvld.format\u53c2\u6570\u542f\u7528\u65f6\u6b64\u51fd\u6570\u624d\u4f1a\u6709\u6548\uff0c\u9ed8\u8ba4\u4e3a \u201c\\t\u201d\u3002<\/li> \r\n  <li>-dvld.verbosity \u662f\u5426\u663e\u793a\u66f4\u8be6\u7ec6\u7684\u4fe1\u606f\uff0c\u9ed8\u8ba4\u4e3a1\uff0c\u5176\u503c\u53ef\u4ee5\u4e3a0,1,2,3 \u5176\u5b9e\u6bd40\u5c0f\u7684\u4e5f\u53ef\u4ee5\uff0c\u53ea\u662f\u6548\u679c\u548c0\u4e00\u6837\uff0c\u6bd4\u59820.1\u4e4b\u7c7b\uff0c\u4f46\u662f\u8d1f\u6570\u9664\u5916\uff0c\u8d1f\u6570\u548c\u6548\u679c\u548c3\u7684\u6548\u679c\u4e00\u6837 \u6bd43\u5927\u7684\u503c\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u53ea\u662f\u6548\u679c\u548c3\u4e00\u6837\u3002<\/li> \r\n  <li>-dvld.save_dir \u6307\u5b9a\u6587\u4ef6\u8f93\u51fa\u7684\u8def\u5f84\uff0c\u9ed8\u8ba4\u8def\u5f84\u4e3a\/tmp\u3002<\/li> \r\n  <li>-dvld.save_paths \u63a7\u5236\u662f\u5426\u8f93\u51fa\u6587\u4ef6\uff0c\u9ed8\u8ba4\u4e3a0\uff0c\u8868\u793a\u4e0d\u8f93\u51fa\u6587\u4ef6<\/li> \r\n  <li>-dvld.dump_paths \u63a7\u5236\u8f93\u51fa\u7684\u5185\u5bb9\uff0c\u73b0\u5728\u53ea\u67090\u548c1\u4e24\u79cd\u60c5\u51b5\uff0c\u9ed8\u8ba4\u4e3a1,\u8f93\u51fa\u5185\u5bb9<\/li> \r\n <\/ul> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><strong>\u4f7f\u7528VLD\u6bd4\u8f83\u4ee3\u7801\u5dee\u5f02<\/strong><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u4ee3\u7801text1.php<\/p> \r\n <div style='background-color: rgb(231, 229, 220); font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px;'> \r\n  <div style='background-color: rgb(248, 248, 248); color: silver; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 9px;'> \r\n   <b>[php]<\/b>&nbsp; \r\n   <a title='view plain' href='http:\/\/blog.csdn.net\/21aspnet\/article\/details\/7002644#' style='color: rgb(160, 160, 160);'>view plain<\/a> \r\n   <a title='copy' href='http:\/\/blog.csdn.net\/21aspnet\/article\/details\/7002644#' style='color: rgb(160, 160, 160);'>copy<\/a> \r\n  <\/div> \r\n  <ol start='1' style='background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);'> \r\n   <li style='background-color:rgb(255, 255, 255);color:inherit;'><span style='color: black;'><span style='color: rgb(221, 0, 0);'>$var<\/span>&nbsp;=&nbsp;111;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color: rgb(248, 248, 248);'><span style='color: black;'><span style='color: rgb(221, 0, 0);'>$str<\/span>&nbsp;=&nbsp;<span style='color: blue;'>'AAA&nbsp;'<\/span>&nbsp;.&nbsp;<span style='color: rgb(221, 0, 0);'>$var<\/span>&nbsp;.&nbsp;<span style='color: blue;'>'&nbsp;BBB'<\/span>;&nbsp;&nbsp;<\/span><\/li> \r\n  <\/ol> \r\n <\/div> \r\n <br style='background-color: rgb(255, 255, 255); font-family: Arial;'> \r\n <span style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u4ee3\u7801text2.php<\/span> \r\n <div style='background-color: rgb(231, 229, 220); font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px;'> \r\n  <div style='background-color: rgb(248, 248, 248); color: silver; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 9px;'> \r\n   <b>[php]<\/b>&nbsp; \r\n   <a title='view plain' href='http:\/\/blog.csdn.net\/21aspnet\/article\/details\/7002644#' style='color: rgb(160, 160, 160);'>view plain<\/a> \r\n   <a title='copy' href='http:\/\/blog.csdn.net\/21aspnet\/article\/details\/7002644#' style='color: rgb(160, 160, 160);'>copy<\/a> \r\n  <\/div> \r\n  <ol start='1' style='background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);'> \r\n   <li style='background-color:rgb(255, 255, 255);color:inherit;'><span style='color: black;'><span style='color: rgb(221, 0, 0);'>$var<\/span>&nbsp;=&nbsp;111;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color: rgb(248, 248, 248);'><span style='color: black;'><span style='color: rgb(221, 0, 0);'>$str<\/span>&nbsp;=&nbsp;<span style='color: blue;'>'AAA&nbsp;$var&nbsp;BBB'<\/span>;&nbsp;&nbsp;<\/span><\/li> \r\n  <\/ol> \r\n <\/div> \r\n <img src='http:\/\/note.youdao.com\/yws\/res\/2572\/598B4D36F2A542ACAAD7F8534C71293E' style='background-color: rgb(255, 255, 255); font-family: Arial;' data-media-type='image'> \r\n <br style='background-color: rgb(255, 255, 255); font-family: Arial;'> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u4ece\u7ed3\u679c\u5f88\u6e05\u6670\u7684\u770b\u51fa\u7b2c\u4e00\u6bb5\u4ee3\u7801\u6bd4\u7b2c\u4e8c\u6bb5\u4ee3\u7801\u591a\u4e86concat<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u7b2c\u4e00\u4e2a\u8fde\u63a5\u64cd\u4f5c\uff0c\u5c06\u201ctest string begin \u201d\u548c$var\u8fde\u63a5\u8d77\u6765\uff0c\u5f97\u5230\u201cAAA 111\u201d\uff0c\u7136\u540e\u518d\u6267\u884c\u7b2c\u4e8c\u4e2a\u8fde\u63a5\u64cd\u4f5c\uff0c\u5c06\u4e0a\u4e00\u4e2a\u64cd\u4f5c\u5f97\u5230\u7684\u7ed3\u679c\u201cAAA 111\u201d\u548c\u201d BBB\u201d\u8fde\u63a5\u8d77\u6765\uff0c\u5e76\u5c06\u7ed3\u679c\u5b58\u50a8\u5728\u53e6\u4e00\u4e2a\u4e34\u65f6\u53d8\u91cf\uff0c\u6700\u540e\u5c06\u7b2c\u4e8c\u4e2a\u8fde\u63a5\u64cd\u4f5c\u7684\u7ed3\u679c\u8d4b\u503c\u7ed9$str\u3002<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u8fde\u63a5\u64cd\u4f5c\u5bf9\u5e94\u7684opcode\u4e3aZEND_CONCAT\uff0c\u5bf9\u4e8e\u6240\u7ed9\u7684\u4e24\u4e2a\u64cd\u4f5c\u6570\uff0c\u5176\u6700\u7ec8\u901a\u8fc7concat_function\u51fd\u6570\u5c06\u4e24\u4e2a\u5b57\u7b26\u4e32\u8fde\u63a5\u8d77\u6765\uff0c\u5982\u679c\u6240\u7ed9\u7684\u53d8\u91cf\u7684\u7c7b\u578b\u4e0d\u662f\u5b57\u7b26\u4e32\uff0c\u5219\u4f1a\u901a\u8fc7zend_make_printable_zval\u5c06\u5176\u8f6c\u6362\u6210\u5b57\u7b26\u4e32\u3002concat_function\u51fd\u6570\u4f1a\u6839\u636e\u4e24\u4e2a\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u91cd\u65b0\u5206\u914d\u5185\u5b58\uff0c\u5e76\u6267\u884c\u4e24\u6b21\u62f7\u8d1d\u64cd\u4f5c\uff0c\u5c06\u4e24\u4e2a\u5b57\u7b26\u4e32\u62f7\u8d1d\u5230\u65b0\u7684\u5185\u5b58\u7a7a\u95f4\u3002\u8fd9\u91cc\u9488\u5bf9\u4e24\u4e2a\u5b57\u7b26\u4e32\u76f8\u540c\u7684\u60c5\u51b5\u6709\u4e00\u4e2a\u7279\u6b8a\u5904\u7406\u3002<\/p> \r\n <div style='background-color: rgb(231, 229, 220); font-family: Consolas, 'Courier New', Courier, mono, serif; font-size: 12px;'> \r\n  <div style='background-color: rgb(248, 248, 248); color: silver; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 9px;'> \r\n   <b>[cpp]<\/b>&nbsp; \r\n   <a title='view plain' href='http:\/\/blog.csdn.net\/21aspnet\/article\/details\/7002644#' style='color: rgb(160, 160, 160);'>view plain<\/a> \r\n   <a title='copy' href='http:\/\/blog.csdn.net\/21aspnet\/article\/details\/7002644#' style='color: rgb(160, 160, 160);'>copy<\/a> \r\n  <\/div> \r\n  <ol start='1' style='background-color:rgb(255, 255, 255);color:rgb(92, 92, 92);'> \r\n   <li style='background-color:rgb(255, 255, 255);color:inherit;'><span style='color: black;'><span style='color: rgb(0, 102, 153); font-weight: bold;'>if<\/span>&nbsp;(result==op1)&nbsp;{&nbsp;&nbsp;<span style='color: rgb(0, 130, 0);'>\/*&nbsp;special&nbsp;case,&nbsp;perform&nbsp;operations&nbsp;on&nbsp;result&nbsp;*\/<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color: rgb(248, 248, 248);'><span style='color: black;'>&nbsp;&nbsp;&nbsp;&nbsp;uint&nbsp;res_len&nbsp;=&nbsp;Z_STRLEN_P(op1)&nbsp;+&nbsp;Z_STRLEN_P(op2);&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(255, 255, 255);color:inherit;'><span style='color: black;'>&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color: rgb(248, 248, 248);'><span style='color: black;'>&nbsp;&nbsp;&nbsp;&nbsp;Z_STRVAL_P(result)&nbsp;=&nbsp;erealloc(Z_STRVAL_P(result),&nbsp;res_len+1);&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(255, 255, 255);color:inherit;'><span style='color: black;'>&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color: rgb(248, 248, 248);'><span style='color: black;'>&nbsp;&nbsp;&nbsp;&nbsp;memcpy(Z_STRVAL_P(result)+Z_STRLEN_P(result),&nbsp;Z_STRVAL_P(op2),&nbsp;Z_STRLEN_P(op2));&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(255, 255, 255);color:inherit;'><span style='color: black;'>&nbsp;&nbsp;&nbsp;&nbsp;Z_STRVAL_P(result)[res_len]=0;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color: rgb(248, 248, 248);'><span style='color: black;'>&nbsp;&nbsp;&nbsp;&nbsp;Z_STRLEN_P(result)&nbsp;=&nbsp;res_len;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(255, 255, 255);color:inherit;'><span style='color: black;'>}&nbsp;<span style='color: rgb(0, 102, 153); font-weight: bold;'>else<\/span>&nbsp;{&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color: rgb(248, 248, 248);'><span style='color: black;'>&nbsp;&nbsp;&nbsp;&nbsp;Z_STRLEN_P(result)&nbsp;=&nbsp;Z_STRLEN_P(op1)&nbsp;+&nbsp;Z_STRLEN_P(op2);&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(255, 255, 255);color:inherit;'><span style='color: black;'>&nbsp;&nbsp;&nbsp;&nbsp;Z_STRVAL_P(result)&nbsp;=&nbsp;(<span style='color: rgb(46, 139, 87); font-weight: bold;'>char<\/span>&nbsp;*)&nbsp;emalloc(Z_STRLEN_P(result)&nbsp;+&nbsp;1);&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color: rgb(248, 248, 248);'><span style='color: black;'>&nbsp;&nbsp;&nbsp;&nbsp;memcpy(Z_STRVAL_P(result),&nbsp;Z_STRVAL_P(op1),&nbsp;Z_STRLEN_P(op1));&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(255, 255, 255);color:inherit;'><span style='color: black;'>&nbsp;&nbsp;&nbsp;&nbsp;memcpy(Z_STRVAL_P(result)+Z_STRLEN_P(op1),&nbsp;Z_STRVAL_P(op2),&nbsp;Z_STRLEN_P(op2));&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color: rgb(248, 248, 248);'><span style='color: black;'>&nbsp;&nbsp;&nbsp;&nbsp;Z_STRVAL_P(result)[Z_STRLEN_P(result)]&nbsp;=&nbsp;0;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(255, 255, 255);color:inherit;'><span style='color: black;'>&nbsp;&nbsp;&nbsp;&nbsp;Z_TYPE_P(result)&nbsp;=&nbsp;IS_STRING;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color: rgb(248, 248, 248);'><span style='color: black;'>}&nbsp;&nbsp;<\/span><\/li> \r\n  <\/ol> \r\n <\/div> \r\n <br style='background-color: rgb(255, 255, 255); font-family: Arial;'> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u800c\u76f4\u63a5\u5728\u5b57\u7b26\u4e32\u4e2d\u63d2\u5165\u53d8\u91cf\uff0c\u5176\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u662f\u6dfb\u52a0\u64cd\u4f5c\uff0c\u5c06\u5b57\u7b26\u4e32\u6dfb\u52a0\u5230\u8fd4\u56de\u503c\uff0c\u5c06\u53d8\u91cf\u6dfb\u52a0\u5230\u8fd4\u56de\u503c\uff0c<br>\u6240\u6709\u7684\u7ed3\u679c\u8fd4\u56de\u90fd\u662f\u5728\u4e00\u4e2a\u4e34\u65f6\u53d8\u91cf\u4e2d\uff0c\u5982\u6211\u4eec\u7684\u793a\u4f8b\uff0c\u9996\u5148\u4f1a\u5c06\u201dAAA \u201c\u6dfb\u52a0\u5230\u4e34\u65f6\u53d8\u91cf\uff0c\u7136\u540e\u5c06\u4e34\u65f6\u53d8\u91cf\u548c$var\u53d8\u91cf\u6dfb\u52a0\u5230\u4e34\u65f6\u53d8\u91cf\uff0c\u4e4b\u540e\u5c06\u4e34\u65f6\u53d8\u91cf\u548c\u201d BBB\u201d\u6dfb\u52a0\u5230\u4e34\u65f6\u53d8\u91cf\uff0c\u6700\u540e\u5c06\u6b64\u6b64\u65f6\u53d8\u91cf\u8d4b\u503c\u7ed9$str\u3002\u8fd9\u91cc\u6dfb\u52a0\u5c06\u5b57\u7b26\u4e32\u6dfb\u52a0\u5230\u4e34\u65f6\u53d8\u91cf\uff0c\u5176\u5bf9\u5e94\u7684opcode\u4e3aZEND_ADD_STRING\uff0c\u5c06\u53d8\u91cf\u6dfb\u52a0\u5230\u4e34\u65f6\u53d8\u91cf\uff0c\u5176\u5bf9\u5e94\u7684opcode\u4e3aZEND_ADD_VAR\uff0c\u867d\u7136\u8fd9\u4e24\u4e2a\u64cd\u4f5c\u7684opcode\u4e0d\u540c\uff0c\u4f46\u5176\u6700\u7ec8\u8c03\u7528\u90fd\u662fadd_string_to_string\uff0c\u4ed6\u4eec\u6240\u4e0d\u540c\u7684\u8c03\u7528\u6b64\u51fd\u6570\u7684\u7b2c\u4e09\u4e2a\u53c2\u6570\uff0c\u4e00\u4e2a\u662f\u64cd\u4f5c\u7801\u5b58\u50a8\u7684ZVAL\u53d8\u91cf\uff0c\u4e00\u4e2a\u662f\u901a\u8fc7\u53d8\u66f4\u5217\u8868\u83b7\u53d6\u7684ZVAL\u53d8\u91cf\u3002<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u5982\u679c\u89c9\u5f97\u9700\u8981\u770bC\u8bed\u97f3\u7ea7\u522b\u7684php\u6e90\u7801\uff0c\u53ef\u4ee5\u53c2\u8003\uff1a<a href='http:\/\/blog.csdn.net\/21aspnet\/article\/details\/8195119' target='_blank' style='color:rgb(255, 153, 0);'>\u4f7f\u7528strace\u67e5\u770bC\u8bed\u8a00\u7ea7\u522b\u7684php\u6e90\u7801<\/a><br><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><br><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u5982\u679c\u4f60\u8981\u67e5\u770bmemcpy\u53ef\u4ee5\u53bb\u8fd9\u4e2a\u7f51\u7ad9<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><a href='http:\/\/linux.about.com\/od\/commands\/l\/blcmdl.htm' style='color:rgb(255, 153, 0);'>http:\/\/linux.about.com\/od\/commands\/l\/blcmdl.htm<\/a><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u641c\u7d22\u7ed3\u679c\u5728\uff1a<a href='http:\/\/linux.about.com\/library\/cmd\/blcmdl3_memcpy.htm' style='color:rgb(255, 153, 0);'>http:\/\/linux.about.com\/library\/cmd\/blcmdl3_memcpy.htm<\/a><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><a href='http:\/\/linux.about.com\/library\/cmd\/blcmdl3_memcpy.htm' style='color:rgb(255, 153, 0);'><img src='http:\/\/note.youdao.com\/yws\/res\/2571\/A940391875E342238A849D23D4CFBF8F' data-media-type='image'><br><\/a><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>========================<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u5ef6\u4f38\u9605\u8bfb\u53c2\u8003\uff1a<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><a href='http:\/\/www.phppan.com\/2011\/05\/vld-extension\/' style='color:rgb(255, 153, 0);'>http:\/\/www.phppan.com\/2011\/05\/vld-extension\/<\/a><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><a title='Permanent Link to PHP\u4e2d\u7684\u5b57\u7b26\u4e32\u8fde\u63a5\u64cd\u4f5c' href='http:\/\/www.phppan.com\/2012\/03\/php-string-concat\/' style='color:rgb(255, 153, 0);'>PHP\u4e2d\u7684\u5b57\u7b26\u4e32\u8fde\u63a5\u64cd\u4f5c<\/a><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><a href='http:\/\/blog.csdn.net\/phpkernel\/article\/details\/5718519' style='color:rgb(255, 153, 0);'>http:\/\/blog.csdn.net\/phpkernel\/article\/details\/5718519<\/a><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><a href='http:\/\/www.laruence.com\/2008\/08\/19\/338.html' style='color:rgb(255, 153, 0);'>http:\/\/www.laruence.com\/2008\/08\/19\/338.html<\/a><\/p> \r\n<\/div>\r\n ","excerpt":"\u00a0\u9700\u8981\u5206\u6790PHP\u4ee3\u7801\u7684\u6027\u80fd\uff0c\u6216\u8005\u8bf4\u5b9e\u73b0\u540c\u6837\u529f\u80fd\u7684\u4ee3\u7801\u5230\u5e95\u54ea\u4e2a\u66f4\u597d\u5462\uff1f\u6216\u8005\u8bf4\u60f3\u77e5\u9053\u5e95\u5c42\u7684\u5b9e\u73b0\u53ef\u4ee5\u4f7f\u7528VLD\u67e5\u770bopcode\u4e0b\u8f7d\u4e0e\u5b89\u88c5VLD#wgethttp:\/\/pecl.php.net\/get\/vld-0.11.2.tgz#tarzxvfvld-0.11.2.tgz#cd.\/vld-0.","author":"1","sortid":"19","type":"blog","views":"92","comnum":"0","tbcount":"0","attnum":"0","top":"n","hide":"n","allow_remark":"y","allow_tb":"y","password":"","thumb":"0","alias":""}