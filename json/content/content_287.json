{"gid":"287","title":"PHP\u7684curl\u5b9e\u73b0get\uff0cpost\u548ccookie\uff08\u51e0\u4e2a\u5b9e\u4f8b\uff09","date":"1425855600","content":"\r\n <div> \r\n <h3 style='background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:16px;font-style:normal;text-align:left;'><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>\u7c7b\u4f3c\u4e8edreamhost\u8fd9\u7c7b\u4e3b\u673a\u670d\u52a1\u5546\uff0c\u662f\u663e\u793afopen\u7684\u4f7f\u7528 \u7684\u3002\u4f7f\u7528php\u7684curl\u53ef\u4ee5\u5b9e\u73b0\u652f\u6301FTP\u3001FTPS\u3001HTTP HTPPS SCP SFTP TFTP TELNET DICT FILE\u548cLDAP\u3002curl \u652f\u6301SSL\u8bc1\u4e66\u3001HTTP POST\u3001HTTP PUT \u3001FTP \u4e0a\u4f20\uff0ckerberos\u3001\u57fa\u4e8eHTT\u683c\u5f0f\u7684\u4e0a\u4f20\u3001\u4ee3\u7406\u3001cookie\u3001\u7528\u6237\uff0b\u53e3\u4ee4\u8bc1\u660e\u3001\u6587\u4ef6\u4f20\u9001\u6062\u590d\u3001http\u4ee3\u7406\u901a\u9053\u5c31\u6700\u5e38\u7528\u7684\u6765\u8bf4\uff0c\u662f\u57fa\u4e8ehttp\u7684 get\u548cpost\u65b9\u6cd5\u3002<\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>\u4ee3\u7801\u5b9e\u73b0\uff1a<\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'><strong>1\u3001http\u7684get\u5b9e\u73b0<\/strong><\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/p> \r\n  <div style='background-color: rgb(255, 255, 255); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; font-weight: normal;'> \r\n   <div style='font-weight: bold;'>\r\n     Php\u4ee3\u7801&nbsp;&nbsp; \r\n    <img src='http:\/\/note.youdao.com\/yws\/res\/2416\/3865C7D704C849DBACBCD8A4E9788081' alt='\u6536\u85cf\u4ee3\u7801' data-media-type='image'> \r\n   <\/div> \r\n   <ol start='1' style='background-color:rgb(255, 255, 255);color:rgb(43, 145, 175);font-size:1em;'> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>$ch&nbsp;=&nbsp;curl_init(<span style='color:blue;'>'http:\/\/www.domain.com\/api\/index.php?test=1'<\/span>)&nbsp;;&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>curl_setopt($ch,&nbsp;CURLOPT_RETURNTRANSFER,&nbsp;true)&nbsp;;&nbsp;<span style='color:rgb(0, 130, 0);'>\/\/&nbsp;\u83b7\u53d6\u6570\u636e\u8fd4\u56de<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>curl_setopt($ch,&nbsp;CURLOPT_BINARYTRANSFER,&nbsp;true)&nbsp;;&nbsp;<span style='color:rgb(0, 130, 0);'>\/\/&nbsp;\u5728\u542f\u7528&nbsp;CURLOPT_RETURNTRANSFER&nbsp;\u65f6\u5019\u5c06\u83b7\u53d6\u6570\u636e\u8fd4\u56de<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>echo&nbsp;$output&nbsp;=&nbsp;curl_exec($ch)&nbsp;;&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(0, 130, 0);'>\/*&nbsp;\u5199\u5165\u6587\u4ef6&nbsp;*\/<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>$fh&nbsp;=&nbsp;fopen(<span style='color:blue;'>'out.html'<\/span>,&nbsp;<span style='color:blue;'>'w'<\/span>)&nbsp;;&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>fwrite($fh,&nbsp;$output)&nbsp;;&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>fclose($fh)&nbsp;;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <\/ol> \r\n  <\/div><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'><br><\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'><strong>2\u3001http\u7684post\u5b9e\u73b0<\/strong><\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/p> \r\n  <div style='background-color: rgb(255, 255, 255); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; font-weight: normal;'> \r\n   <div style='font-weight: bold;'>\r\n     Php\u4ee3\u7801&nbsp;&nbsp; \r\n    <img src='http:\/\/note.youdao.com\/yws\/res\/2416\/3865C7D704C849DBACBCD8A4E9788081' alt='\u6536\u85cf\u4ee3\u7801' data-media-type='image'> \r\n   <\/div> \r\n   <ol start='1' style='background-color:rgb(255, 255, 255);color:rgb(43, 145, 175);font-size:1em;'> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&lt;?php&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>$url&nbsp;=&nbsp;<span style='color:blue;'>'http:\/\/www.domain.com\/api\/'<\/span>&nbsp;;&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>$fields&nbsp;=&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>array<\/span>(&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style='color:blue;'>'lname'<\/span>=&gt;<span style='color:blue;'>'justcoding'<\/span>&nbsp;,&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style='color:blue;'>'fname'<\/span>=&gt;<span style='color:blue;'>'phplover'<\/span>&nbsp;,&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style='color:blue;'>'title'<\/span>=&gt;<span style='color:blue;'>'myapi'<\/span>,&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style='color:blue;'>'age'<\/span>=&gt;<span style='color:blue;'>'27'<\/span>&nbsp;,&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style='color:blue;'>'email'<\/span>=&gt;<span style='color:blue;'>'1353777303@gmail.com'<\/span>&nbsp;,&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style='color:blue;'>'phone'<\/span>=&gt;<span style='color:blue;'>'1353777303'<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(0, 130, 0);'>\/\/$post_data&nbsp;=&nbsp;implode('&amp;',$fields);<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(0, 130, 0);'>\/\/open&nbsp;connection<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>$ch&nbsp;=&nbsp;curl_init()&nbsp;;&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(0, 130, 0);'>\/\/set&nbsp;the&nbsp;url,&nbsp;number&nbsp;of&nbsp;POST&nbsp;vars,&nbsp;POST&nbsp;data<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>curl_setopt($ch,&nbsp;CURLOPT_URL,$url)&nbsp;;&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>curl_setopt($ch,&nbsp;CURLOPT_POST,count($fields))&nbsp;;&nbsp;<span style='color:rgb(0, 130, 0);'>\/\/&nbsp;\u542f\u7528\u65f6\u4f1a\u53d1\u9001\u4e00\u4e2a\u5e38\u89c4\u7684POST\u8bf7\u6c42\uff0c\u7c7b\u578b\u4e3a\uff1aapplication\/x-www-form-urlencoded\uff0c\u5c31\u50cf\u8868\u5355\u63d0\u4ea4\u7684\u4e00\u6837\u3002<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>curl_setopt($ch,&nbsp;CURLOPT_POSTFIELDS,$fields);&nbsp;<span style='color:rgb(0, 130, 0);'>\/\/&nbsp;\u5728HTTP\u4e2d\u7684\u201cPOST\u201d\u64cd\u4f5c\u3002\u5982\u679c\u8981\u4f20\u9001\u4e00\u4e2a\u6587\u4ef6\uff0c\u9700\u8981\u4e00\u4e2a@\u5f00\u5934\u7684\u6587\u4ef6\u540d<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>ob_start();&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>curl_exec($ch);&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>$result&nbsp;=&nbsp;ob_get_contents()&nbsp;;&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>ob_end_clean();&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>echo&nbsp;$result;&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(0, 130, 0);'>\/\/close&nbsp;connection<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>curl_close($ch)&nbsp;;&nbsp;&nbsp;<\/span><\/li> \r\n   <\/ol> \r\n  <\/div><span style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/span><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>http:\/\/www.domain.com\/api\/index.php<\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/p> \r\n  <div style='background-color: rgb(255, 255, 255); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; font-weight: normal;'> \r\n   <div style='font-weight: bold;'>\r\n     Php\u4ee3\u7801&nbsp;&nbsp; \r\n    <img src='http:\/\/note.youdao.com\/yws\/res\/2416\/3865C7D704C849DBACBCD8A4E9788081' alt='\u6536\u85cf\u4ee3\u7801' data-media-type='image'> \r\n   <\/div> \r\n   <ol start='1' style='background-color:rgb(255, 255, 255);color:rgb(43, 145, 175);font-size:1em;'> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&lt;?php&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>if<\/span>($_GET[<span style='color:blue;'>'test'<\/span>])&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>{&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print_r($_GET);&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>}&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>if<\/span>($_POST)&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>{&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;&nbsp;print_r($_POST);&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>}&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <\/ol> \r\n  <\/div><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'><strong>3. php\u7684curl\u4f20\u9001cookie<\/strong><\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/p> \r\n  <div style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'> \r\n   <p>\u4e24\u79cd\u65b9\u5f0f:<\/p> \r\n   <p>&nbsp;<\/p> \r\n   <p><strong>\u4e00\u79cd\u662f\u81ea\u52a8:<\/strong><\/p> \r\n   <p>&nbsp;<\/p> \r\n   <div style='font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px;'> \r\n    <div style='font-weight: bold;'>\r\n      Php\u4ee3\u7801&nbsp;&nbsp; \r\n     <img src='http:\/\/note.youdao.com\/yws\/res\/2416\/3865C7D704C849DBACBCD8A4E9788081' alt='\u6536\u85cf\u4ee3\u7801' data-media-type='image'> \r\n    <\/div> \r\n    <ol start='1' style='background-color:rgb(255, 255, 255);color:rgb(43, 145, 175);font-size:1em;'> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>curl_setopt($curlHandle,&nbsp;CURLOPT_COOKIEJAR,&nbsp;<span style='color:blue;'>'cookie.txt&nbsp;'<\/span>);&nbsp;<span style='color:rgb(0, 130, 0);'>\/\/\u4fdd\u5b58<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>curl_setopt($curlHandle,&nbsp;CURLOPT_COOKIEFILE,&nbsp;<span style='color:blue;'>'cookie.txt&nbsp;'<\/span>);&nbsp;<span style='color:rgb(0, 130, 0);'>\/\/\u8bfb\u53d6<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n    <\/ol> \r\n   <\/div>&nbsp; \r\n   <p>\u8fd9\u6837COOKIE\u4f1a\u81ea\u52a8\u8ddf\u4e0a\u53bb.&nbsp;<br>\u4e0d\u8fc7\u8981\u5206\u4e24\u6b21\uff0c\u4e00\u662f\u5148\u8bbf\u95ee\u4ea7\u751fcookie\uff0c\u63a5\u7740\u8fde\u7ed3\u624d\u80fd\u7528cookie<\/p> \r\n   <p>&nbsp;<\/p> \r\n   <p>\u4f8b\u5b50\uff1a<\/p> \r\n   <p>&nbsp;<\/p> \r\n   <div style='font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px;'> \r\n    <div style='font-weight: bold;'>\r\n      Php\u4ee3\u7801&nbsp;&nbsp; \r\n     <img src='http:\/\/note.youdao.com\/yws\/res\/2416\/3865C7D704C849DBACBCD8A4E9788081' alt='\u6536\u85cf\u4ee3\u7801' data-media-type='image'> \r\n    <\/div> \r\n    <ol start='1' style='background-color:rgb(255, 255, 255);color:rgb(43, 145, 175);font-size:1em;'> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&lt;?php&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>function<\/span>&nbsp;get_curlcuconent2($filename,$referer)&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>{&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;$cookie_jar&nbsp;=&nbsp;tempnam(<span style='color:blue;'>'.\/tmp'<\/span>,<span style='color:blue;'>'JSESSIONID'<\/span>);&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;$ch&nbsp;=&nbsp;curl_init();&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_URL,&nbsp;$filename);&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_HEADER,&nbsp;false);&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_RETURNTRANSFER,&nbsp;1);&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;<span style='color:rgb(0, 130, 0);'>\/\/\u8bbe\u7f6e\u6587\u4ef6\u8bfb\u53d6\u5e76\u63d0\u4ea4\u7684cookie\u8def\u5f84<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_COOKIEJAR,&nbsp;$cookie_jar);&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;$filecontent=curl_exec($ch);&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;curl_close($ch);&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;$ch&nbsp;=&nbsp;curl_init();&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;$hostname&nbsp;=<span style='color:blue;'>'www.domain.com'<\/span>;&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;<span style='color:rgb(0, 130, 0);'>\/\/$referer='http:\/\/www.domain.com\/';<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_URL,&nbsp;$filename);&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_REFERER,&nbsp;$referer);&nbsp;<span style='color:rgb(0, 130, 0);'>\/\/&nbsp;\u770b\u8fd9\u91cc\uff0c\u4f60\u4e5f\u53ef\u4ee5\u8bf4\u4f60\u4ecegoogle\u6765<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_USERAGENT,&nbsp;<span style='color:blue;'>'www.domain.com'<\/span>);&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;<span style='color:rgb(0, 130, 0);'>\/\/$request&nbsp;=&nbsp;'JSESSIONID=abc6szw15ozvZ_PU9b-8r';&nbsp;\/\/\u8bbe\u7f6ePOST\u53c2\u6570<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;<span style='color:rgb(0, 130, 0);'>\/\/curl_setopt($ch,&nbsp;CURLOPT_POSTFIELDS,&nbsp;$request);&nbsp;&nbsp;&nbsp;<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;<span style='color:rgb(0, 130, 0);'>\/\/&nbsp;\u4e0a\u9762\u8fd9\u53e5\uff0c\u5f53\u7136\u4f60\u53ef\u4ee5\u8bf4\u4f60\u662fbaidu\uff0c\u6539\u6389\u8fd9\u91cc\u7684\u503c\u5c31ok\u4e86\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5c0f\u5077\u7684\u529f\u80fd\uff0c$_SERVER['HTTP_USER_AGENT']<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;<span style='color:rgb(0, 130, 0);'>\/\/\u4f60\u4e5f\u53ef\u4ee5\u81ea\u5df1\u505a\u4e2a&nbsp;spider&nbsp;\u4e86\uff0c\u90a3\u4e48\u5c31\u4f2a\u88c5\u8fd9\u91cc\u7684&nbsp;CURLOPT_USERAGENT&nbsp;\u5427<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;<span style='color:rgb(0, 130, 0);'>\/\/\u5982\u679c\u4f60\u8981\u628a\u8fd9\u4e2a\u7a0b\u5e8f\u653e\u5230linux\u4e0a\u7528php&nbsp;-q\u6267\u884c\u90a3\u4e5f\u8981\u5199\u51fa\u5177\u4f53\u7684$_SERVER['HTTP_USER_AGENT']\uff0c\u4f2a\u9020\u7684\u4e5f\u53ef\u4ee5<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_RETURNTRANSFER,&nbsp;1);&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_COOKIEFILE,&nbsp;$cookie_jar);&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_HEADER,&nbsp;false);<span style='color:rgb(0, 130, 0);'>\/\/\u8bbe\u5b9a\u662f\u5426\u8f93\u51fa\u9875\u9762\u5185\u5bb9<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;curl_setopt($ch,&nbsp;CURLOPT_GET,&nbsp;1);&nbsp;<span style='color:rgb(0, 130, 0);'>\/\/&nbsp;post,get&nbsp;\u8fc7\u53bb<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;$filecontent&nbsp;=&nbsp;curl_exec($ch);&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;preg_match_all(<span style='color:blue;'>'\/charset=(.+?)[NULL\\'\\']\/is'<\/span>,$filecontent,&nbsp;$charsetarray);&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>if<\/span>(strtolower($charsetarray[1][0])==<span style='color:blue;'>'utf-8'<\/span>)&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filecontent=iconv(&nbsp;<span style='color:blue;'>'utf-8'<\/span>,&nbsp;<span style='color:blue;'>'gb18030\/\/IGNORE'<\/span>&nbsp;,&nbsp;$filecontent);&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;curl_close($ch);&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>return<\/span>&nbsp;$filecontent;&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>}&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;<\/span><\/li> \r\n     <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>?&gt;&nbsp;&nbsp;<\/span><\/li> \r\n    <\/ol> \r\n   <\/div>&nbsp; \r\n   <p><br>\u4e00\u79cd\u81ea\u5b9a\u4e49:<\/p> \r\n  <\/div><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/p> \r\n  <div style='background-color: rgb(255, 255, 255); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; font-weight: normal;'> \r\n   <div style='font-weight: bold;'>\r\n     Php\u4ee3\u7801&nbsp;&nbsp; \r\n    <img src='http:\/\/note.youdao.com\/yws\/res\/2416\/3865C7D704C849DBACBCD8A4E9788081' alt='\u6536\u85cf\u4ee3\u7801' data-media-type='image'> \r\n   <\/div> \r\n   <ol start='1' style='background-color:rgb(255, 255, 255);color:rgb(43, 145, 175);font-size:1em;'> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>$header[]=&nbsp;<span style='color:blue;'>'Accept:&nbsp;image\/gif,&nbsp;image\/x-xbitmap,&nbsp;image\/jpeg,&nbsp;image\/pjpeg,&nbsp;application\/x-shockwave-flash,&nbsp;text\/html,&nbsp;*&nbsp;'<\/span>.&nbsp;<span style='color:blue;'>'\/*&nbsp;'<\/span>;&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>$header[]=&nbsp;<span style='color:blue;'>'Accept-Language:&nbsp;zh-cn&nbsp;'<\/span>;&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>$header[]=&nbsp;<span style='color:blue;'>'User-Agent:&nbsp;Mozilla\/4.0&nbsp;(compatible;&nbsp;MSIE&nbsp;6.0;&nbsp;Windows&nbsp;NT&nbsp;5.1;&nbsp;SV1;&nbsp;.NET&nbsp;CLR&nbsp;2.0.50727)&nbsp;'<\/span>;&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>$header[]=&nbsp;<span style='color:blue;'>'Host:&nbsp;'<\/span>.$\u4f60\u7684\u76ee\u6807HOST;&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>$header[]=&nbsp;<span style='color:blue;'>'Connection:&nbsp;Keep-Alive&nbsp;'<\/span>;&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>$header[]=&nbsp;<span style='color:blue;'>'Cookie:&nbsp;'<\/span>.$\u4f60\u7684COOKIE\u4e32;&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>&nbsp;&nbsp;<\/span><\/li> \r\n    <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>curl_setopt($curlHandel,CURLOPT_HTTPHEADER,$header);&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <\/ol> \r\n  <\/div><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/p><\/h3> \r\n<\/div>\r\n ","excerpt":"\u00a0\u7c7b\u4f3c\u4e8edreamhost\u8fd9\u7c7b\u4e3b\u673a\u670d\u52a1\u5546\uff0c\u662f\u663e\u793afopen\u7684\u4f7f\u7528\u7684\u3002\u4f7f\u7528php\u7684curl\u53ef\u4ee5\u5b9e\u73b0\u652f\u6301FTP\u3001FTPS\u3001HTTPHTPPSSCPSFTPTFTPTELNETDICTFILE\u548cLDAP\u3002curl\u652f\u6301SSL\u8bc1\u4e66\u3001HTTPPOST\u3001HTTPPUT\u3001FTP\u4e0a\u4f20\uff0ckerb","author":"1","sortid":"19","type":"blog","views":"46","comnum":"0","tbcount":"0","attnum":"0","top":"n","hide":"n","allow_remark":"y","allow_tb":"y","password":"","thumb":"0","alias":""}