{"gid":"349","title":"mysqlprepare\u5b58\u50a8\u8fc7\u7a0b\u4f7f\u7528","date":"1421017200","content":"\r\n <h3 style='background-color: rgb(255, 255, 255); font-family: Helvetica, Tahoma, Arial, sans-serif; font-size: 16px;'><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>\u8bed\u6cd5<\/p> \r\n <div style='background-color: rgb(255, 255, 255); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; font-weight: normal;'> \r\n  <div style='font-weight: bold;'> \r\n   <strong>[sql]<\/strong> \r\n  <\/div> \r\n  <ol style='background-color:rgb(255, 255, 255);color:rgb(43, 145, 175);font-size:1em;'> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>PREPARE<\/span>&nbsp;statement_name&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>FROM<\/span>&nbsp;sql_text&nbsp;\/*\u5b9a\u4e49*\/&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>EXECUTE<\/span>&nbsp;statement_name&nbsp;[USING&nbsp;variable&nbsp;[,variable...]]&nbsp;\/*\u6267\u884c\u9884\u5904\u7406\u8bed\u53e5*\/&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>DEALLOCATE<\/span>&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>PREPARE<\/span>&nbsp;statement_name&nbsp;\/*\u5220\u9664\u5b9a\u4e49*\/&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n  <\/ol> \r\n <\/div><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'><br>\u4f8b<\/p> \r\n <div style='background-color: rgb(255, 255, 255); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; font-weight: normal;'> \r\n  <div style='font-weight: bold;'> \r\n   <strong>[sql]<\/strong> \r\n  <\/div> \r\n  <ol style='background-color:rgb(255, 255, 255);color:rgb(43, 145, 175);font-size:1em;'> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>PREPARE<\/span>&nbsp;prod&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>FROM<\/span>&nbsp;<span style='color:blue;'>'INSERT&nbsp;INTO&nbsp;examlple&nbsp;VALUES(?,?)'<\/span>;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@p=<span style='color:blue;'>'1'<\/span>;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@q=<span style='color:blue;'>'2'<\/span>;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>EXECUTE<\/span>&nbsp;prod&nbsp;USING&nbsp;@p,@q;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@<span style='color:rgb(127, 0, 85);font-weight:bold;'>name<\/span>=<span style='color:blue;'>'3'<\/span>;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>EXECUTE<\/span>&nbsp;prod&nbsp;USING&nbsp;@p,@<span style='color:rgb(127, 0, 85);font-weight:bold;'>name<\/span>;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>DEALLOCATE<\/span>&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>PREPARE<\/span>&nbsp;prod;&nbsp;&nbsp;<\/span><\/li> \r\n  <\/ol> \r\n <\/div><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'><br>1.\u7528\u53d8\u91cf\u505a\u8868\u540d\uff1a \u7b80\u5355\u7684\u7528set\u6216\u8005declare\u8bed\u53e5\u5b9a\u4e49\u53d8\u91cf\uff0c\u7136\u540e\u76f4\u63a5\u4f5c\u4e3asql\u7684\u8868\u540d\u662f\u4e0d\u884c\u7684\uff0cmysql\u4f1a\u628a\u53d8\u91cf\u540d\u5f53\u4f5c\u8868\u540d\u3002\u5728\u5176\u4ed6\u7684sql\u6570\u636e\u5e93\u4e2d\u4e5f\u662f\u5982 \u6b64\uff0cmssql\u7684\u89e3\u51b3\u65b9\u6cd5\u662f\u5c06\u6574\u6761sql\u8bed\u53e5\u4f5c\u4e3a\u53d8\u91cf\uff0c\u5176\u4e2d\u7a7f\u63d2\u53d8\u91cf\u4f5c\u4e3a\u8868\u540d\uff0c\u7136\u540e\u7528sp_executesql\u8c03\u7528\u8be5\u8bed\u53e5\u3002 \u8fd9\u5728mysql5.0\u4e4b\u524d\u662f\u4e0d\u884c\u7684\uff0c5.0\u4e4b\u540e\u5f15\u5165\u4e86\u4e00\u4e2a\u5168\u65b0\u7684\u8bed\u53e5\uff0c\u53ef\u4ee5\u8fbe\u5230\u7c7b\u4f3csp_executesql\u7684\u529f\u80fd\uff08\u4ec5\u5bf9procedure\u6709 \u6548\uff0cfunction\u4e0d\u652f\u6301\u52a8\u6001\u67e5\u8be2\uff09\uff1a&nbsp;<\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>PREPARE stmt_name FROM preparable_stmt;&nbsp;<br>EXECUTE stmt_name [USING @var_name [, @var_name] ...];&nbsp;<br>{DEALLOCATE | DROP} PREPARE stmt_name;&nbsp;<\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>\u4e3a\u4e86\u6709\u4e00\u4e2a\u611f\u6027\u7684\u8ba4\u8bc6\uff0c\u4e0b\u9762\u5148\u7ed9\u51e0\u4e2a\u5c0f\u4f8b\u5b50\uff1a&nbsp;<\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/p> \r\n <div style='background-color: rgb(255, 255, 255); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; font-weight: normal;'> \r\n  <div style='font-weight: bold;'> \r\n   <strong>[sql]<\/strong> \r\n  <\/div> \r\n  <ol style='background-color:rgb(255, 255, 255);color:rgb(43, 145, 175);font-size:1em;'> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>PREPARE<\/span>&nbsp;stmt1&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>FROM<\/span>&nbsp;<span style='color:blue;'>'SELECT&nbsp;SQRT(POW(?,2)&nbsp;+&nbsp;POW(?,2))&nbsp;AS&nbsp;hypotenuse'<\/span>;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@a&nbsp;=&nbsp;3;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@b&nbsp;=&nbsp;4;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>EXECUTE<\/span>&nbsp;stmt1&nbsp;USING&nbsp;@a,&nbsp;@b;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>+<span style='color:rgb(0, 130, 0);'>------------+&nbsp;<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>|&nbsp;hypotenuse&nbsp;|&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>+<span style='color:rgb(0, 130, 0);'>------------+&nbsp;<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>|&nbsp;5&nbsp;|&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>+<span style='color:rgb(0, 130, 0);'>------------+&nbsp;<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>DEALLOCATE<\/span>&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>PREPARE<\/span>&nbsp;stmt1;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@s&nbsp;=&nbsp;<span style='color:blue;'>'SELECT&nbsp;SQRT(POW(?,2)&nbsp;+&nbsp;POW(?,2))&nbsp;AS&nbsp;hypotenuse'<\/span>;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>PREPARE<\/span>&nbsp;stmt2&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>FROM<\/span>&nbsp;@s;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@a&nbsp;=&nbsp;6;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@b&nbsp;=&nbsp;8;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>EXECUTE<\/span>&nbsp;stmt2&nbsp;USING&nbsp;@a,&nbsp;@b;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>+<span style='color:rgb(0, 130, 0);'>------------+&nbsp;<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>|&nbsp;hypotenuse&nbsp;|&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>+<span style='color:rgb(0, 130, 0);'>------------+&nbsp;<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>|&nbsp;10&nbsp;|&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>+<span style='color:rgb(0, 130, 0);'>------------+&nbsp;<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>DEALLOCATE<\/span>&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>PREPARE<\/span>&nbsp;stmt2;&nbsp;&nbsp;<\/span><\/li> \r\n  <\/ol> \r\n <\/div><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>\u5982\u679c\u4f60\u7684MySQL \u7248\u672c\u662f 5.0.7 \u6216\u8005\u66f4\u9ad8\u7684\uff0c\u4f60\u8fd8\u53ef\u4ee5\u5728 LIMIT \u5b50\u53e5\u4e2d\u4f7f\u7528\u5b83\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a<\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/p> \r\n <div style='background-color: rgb(255, 255, 255); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; font-weight: normal;'> \r\n  <div style='font-weight: bold;'> \r\n   <strong>[sql]<\/strong> \r\n  <\/div> \r\n  <ol style='background-color:rgb(255, 255, 255);color:rgb(43, 145, 175);font-size:1em;'> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@a=1;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>PREPARE<\/span>&nbsp;STMT&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>FROM<\/span>&nbsp;<span style='color:blue;'>'SELECT&nbsp;*&nbsp;FROM&nbsp;tbl&nbsp;LIMIT&nbsp;?'<\/span>;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>EXECUTE<\/span>&nbsp;STMT&nbsp;USING&nbsp;@a;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@skip=1;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@numrows=5;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>PREPARE<\/span>&nbsp;STMT&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>FROM<\/span>&nbsp;<span style='color:blue;'>'SELECT&nbsp;*&nbsp;FROM&nbsp;tbl&nbsp;LIMIT&nbsp;?,&nbsp;?'<\/span>;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>mysql&gt;&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>EXECUTE<\/span>&nbsp;STMT&nbsp;USING&nbsp;@skip,&nbsp;@numrows;&nbsp;&nbsp;<\/span><\/li> \r\n  <\/ol> \r\n <\/div><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'><br>\u4f7f\u7528 PREPARE \u7684\u51e0\u4e2a\u6ce8\u610f\u70b9\uff1a&nbsp;<br>A\uff1aPREPARE stmt_name FROM preparable_stmt;\u9884\u5b9a\u4e49\u4e00\u4e2a\u8bed\u53e5\uff0c\u5e76\u5c06\u5b83\u8d4b\u7ed9 stmt_name \uff0ctmt_name \u662f\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u3002<br>B\uff1a \u5373\u4f7f preparable_stmt \u8bed\u53e5\u4e2d\u7684 ? \u6240\u4ee3\u8868\u7684\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u4f60\u4e5f\u4e0d\u9700\u8981\u5c06 ? \u7528\u5f15\u53f7\u5305\u542b\u8d77\u6765\u3002&nbsp;<br>C\uff1a \u5982\u679c\u65b0\u7684 PREPARE \u8bed\u53e5\u4f7f\u7528\u4e86\u4e00\u4e2a\u5df2\u5b58\u5728\u7684 stmt_name \uff0c\u90a3\u4e48\u539f\u6709\u7684\u5c06\u88ab\u7acb\u5373\u91ca\u653e\uff01 \u5373\u4f7f\u8fd9\u4e2a\u65b0\u7684 PREPARE \u8bed\u53e5\u56e0\u4e3a\u9519\u8bef\u800c\u4e0d\u80fd\u88ab\u6b63\u786e\u6267\u884c\u3002<br>D\uff1a PREPARE stmt_name \u7684\u4f5c\u7528\u57df\u662f\u5f53\u524d\u5ba2\u6237\u7aef\u8fde\u63a5\u4f1a\u8bdd\u53ef\u89c1\u3002&nbsp;<br>E\uff1a \u8981\u91ca\u653e\u4e00\u4e2a\u9884\u5b9a\u4e49\u8bed\u53e5\u7684\u8d44\u6e90\uff0c\u53ef\u4ee5\u4f7f\u7528 DEALLOCATE PREPARE \u53e5\u6cd5\u3002&nbsp;<br>F\uff1a EXECUTE stmt_name \u53e5\u6cd5\u4e2d\uff0c\u5982\u679c stmt_name \u4e0d\u5b58\u5728\uff0c\u5c06\u4f1a\u5f15\u53d1\u4e00\u4e2a\u9519\u8bef\u3002&nbsp;<br>G\uff1a \u5982\u679c\u5728\u7ec8\u6b62\u5ba2\u6237\u7aef\u8fde\u63a5\u4f1a\u8bdd\u65f6\uff0c\u6ca1\u6709\u663e\u5f0f\u5730\u8c03\u7528 DEALLOCATE PREPARE \u53e5\u6cd5\u91ca\u653e\u8d44\u6e90\uff0c\u670d\u52a1\u5668\u7aef\u4f1a\u81ea\u5df1\u52a8\u91ca\u653e\u5b83\u3002&nbsp;<br>H\uff1a \u5728\u9884\u5b9a\u4e49\u8bed\u53e5\u4e2d\uff0cCREATE TABLE, DELETE, DO, INSERT, REPLACE, SELECT, SET, UPDATE, \u548c\u5927\u90e8\u5206\u7684 SHOW \u53e5\u6cd5\u88ab\u652f\u6301\u3002<br>I\uff1a PREPARE \u8bed\u53e5\u4e0d\u53ef\u4ee5\u7528\u4e8e\u5b58\u50a8\u8fc7\u7a0b\uff0c\u81ea\u5b9a\u4e49\u51fd\u6570\uff01\u4f46\u4ece MySQL 5.0.13 \u5f00\u59cb\uff0c\u5b83\u53ef\u4ee5\u88ab\u7528\u4e8e\u5b58\u50a8\u8fc7\u7a0b\uff0c\u4ecd\u4e0d\u652f\u6301\u5728\u51fd\u6570\u4e2d\u4f7f\u7528\uff01<\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<\/p><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>\u4e0b\u9762\u7ed9\u4e2a\u793a\u4f8b\uff1a<\/p> \r\n <div style='background-color: rgb(255, 255, 255); font-family: Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace; font-size: 12px; font-weight: normal;'> \r\n  <div style='font-weight: bold;'>\r\n    Sql\u4ee3\u7801&nbsp;&nbsp; \r\n   <img src='http:\/\/note.youdao.com\/yws\/res\/1852\/DB48168261E04273933ED1CE53FEE3C1' alt='\u6536\u85cf\u4ee3\u7801' data-media-type='image'> \r\n  <\/div> \r\n  <ol start='1' style='background-color:rgb(255, 255, 255);color:rgb(43, 145, 175);font-size:1em;'> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>CREATE<\/span>&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>PROCEDURE<\/span>&nbsp;`p1`(<span style='color:rgb(128, 128, 128);'>IN<\/span>&nbsp;id&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>INT<\/span>&nbsp;UNSIGNED,<span style='color:rgb(128, 128, 128);'>IN<\/span>&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>name<\/span>&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>VARCHAR<\/span>(11))&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>BEGIN<\/span>&nbsp;lable_exit:&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>BEGIN<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@SqlCmd&nbsp;=&nbsp;<span style='color:blue;'>'SELECT&nbsp;*&nbsp;FROM&nbsp;tA&nbsp;'<\/span>;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>IF&nbsp;id&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>IS<\/span>&nbsp;<span style='color:rgb(128, 128, 128);'>NOT<\/span>&nbsp;<span style='color:rgb(128, 128, 128);'>NULL<\/span>&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>THEN<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@SqlCmd&nbsp;=&nbsp;CONCAT(@SqlCmd&nbsp;,&nbsp;<span style='color:blue;'>'WHERE&nbsp;id=?'<\/span>);&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>PREPARE<\/span>&nbsp;stmt&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>FROM<\/span>&nbsp;@SqlCmd;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@a&nbsp;=&nbsp;id;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>EXECUTE<\/span>&nbsp;stmt&nbsp;USING&nbsp;@a;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>LEAVE&nbsp;lable_exit;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>END<\/span>&nbsp;IF;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>IF&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>name<\/span>&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>IS<\/span>&nbsp;<span style='color:rgb(128, 128, 128);'>NOT<\/span>&nbsp;<span style='color:rgb(128, 128, 128);'>NULL<\/span>&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>THEN<\/span>&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@SqlCmd&nbsp;=&nbsp;CONCAT(@SqlCmd&nbsp;,&nbsp;<span style='color:blue;'>'WHERE&nbsp;name&nbsp;LIKE&nbsp;?'<\/span>);&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>PREPARE<\/span>&nbsp;stmt&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>FROM<\/span>&nbsp;@SqlCmd;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>SET<\/span>&nbsp;@a&nbsp;=&nbsp;CONCAT(<span style='color:rgb(127, 0, 85);font-weight:bold;'>name<\/span>,&nbsp;<span style='color:blue;'>'%'<\/span>);&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>EXECUTE<\/span>&nbsp;stmt&nbsp;USING&nbsp;@a;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>LEAVE&nbsp;lable_exit;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>END<\/span>&nbsp;IF;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>END<\/span>&nbsp;lable_exit;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>END<\/span>;&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>CALL&nbsp;`p1`(1,<span style='color:rgb(128, 128, 128);'>NULL<\/span>);&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'>CALL&nbsp;`p1`(<span style='color:rgb(128, 128, 128);'>NULL<\/span>,<span style='color:blue;'>'QQ'<\/span>);&nbsp;&nbsp;<\/span><\/li> \r\n   <li style='background-color:rgb(250, 250, 250);font-size:1em;'><span style='color:black;'><span style='color:rgb(127, 0, 85);font-weight:bold;'>DROP<\/span>&nbsp;<span style='color:rgb(127, 0, 85);font-weight:bold;'>PROCEDURE<\/span>&nbsp;`p1`;&nbsp;&nbsp;&nbsp;<\/span><\/li> \r\n  <\/ol> \r\n <\/div><p style='background-color: rgb(255, 255, 255); font-size: 14px; font-weight: normal;'>&nbsp;<br><br>\u4e86\u89e3\u4e86PREPARE\u7684\u7528\u6cd5\uff0c\u518d\u7528\u53d8\u91cf\u505a\u8868\u540d\u5c31\u5f88\u5bb9\u6613\u4e86\u3002\u4e0d\u8fc7\u5728\u5b9e\u9645\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u8fd8\u53d1\u73b0\u5176\u4ed6\u4e00\u4e9b\u95ee\u9898\uff0c\u6bd4\u5982\u53d8\u91cf\u5b9a\u4e49\uff0cdeclare\u53d8\u91cf\u548cset @var=value\u53d8\u91cf\u7684\u7528\u6cd5\u4ee5\u53ca\u53c2\u6570\u4f20\u5165\u7684\u53d8\u91cf\u3002&nbsp;<br><br>\u6d4b\u8bd5\u540e\u53d1\u73b0\uff0cset @var=value\u8fd9\u6837\u5b9a\u4e49\u7684\u53d8\u91cf\u76f4\u63a5\u5199\u5728\u5b57\u7b26\u4e32\u4e2d\u5c31\u4f1a\u88ab\u5f53\u4f5c\u53d8\u91cf\u8f6c\u6362\uff0cdeclare\u7684\u53d8\u91cf\u548c\u53c2\u6570\u4f20\u5165\u7684\u53d8\u91cf\u5219\u5fc5\u987b\u7528CONCAT\u6765\u8fde\u63a5\u3002\u5177\u4f53\u7684\u539f\u7406\u6ca1\u6709\u7814\u7a76\u3002&nbsp;<br><br>EXECUTE stmt USING @a;\u8fd9\u6837\u7684\u8bed\u53e5USING\u540e\u9762\u7684\u53d8\u91cf\u4e5f\u53ea\u80fd\u7528set @var=value\u8fd9\u79cd\uff0cdeclare\u548c\u53c2\u6570\u4f20\u5165\u7684\u53d8\u91cf\u4e0d\u884c\u3002<\/p><\/h3>\r\n ","excerpt":"\u00a0\u8bed\u6cd5[sql]PREPAREstatement_nameFROMsql_text\/*\u5b9a\u4e49*\/EXECUTEstatement_name[USINGvariable[,variable...]]\/*\u6267\u884c\u9884\u5904\u7406\u8bed\u53e5*\/DEALLOCATEPREPAREstatement","author":"1","sortid":"19","type":"blog","views":"50","comnum":"0","tbcount":"0","attnum":"0","top":"n","hide":"n","allow_remark":"y","allow_tb":"y","password":"","thumb":"0","alias":""}