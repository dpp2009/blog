{"gid":"337","title":"Scrapy\u8f7b\u677e\u5b9a\u5236\u7f51\u7edc\u722c\u866b","date":"1421276400","content":"\r\n <div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u7f51\u7edc\u722c\u866b\uff08Web Crawler, Spider\uff09\u5c31\u662f\u4e00\u4e2a\u5728\u7f51\u7edc\u4e0a\u4e71\u722c\u7684\u673a\u5668\u4eba\u3002\u5f53\u7136\u5b83\u901a\u5e38\u5e76\u4e0d\u662f\u4e00\u4e2a\u5b9e\u4f53\u7684\u673a\u5668\u4eba\uff0c\u56e0\u4e3a\u7f51\u7edc\u672c\u8eab\u4e5f\u662f\u865a\u62df\u7684\u4e1c\u897f\uff0c\u6240\u4ee5\u8fd9\u4e2a\u201c\u673a\u5668\u4eba\u201d\u5176\u5b9e\u4e5f\u5c31\u662f\u4e00\u6bb5\u7a0b\u5e8f\uff0c\u5e76\u4e14\u5b83\u4e5f\u4e0d\u662f<b>\u4e71<\/b>\u722c\uff0c\u800c\u662f\u6709\u4e00\u5b9a\u76ee\u7684\u7684\uff0c\u5e76\u4e14\u5728\u722c\u884c\u7684\u65f6\u5019\u4f1a\u641c\u96c6\u4e00\u4e9b\u4fe1\u606f\u3002\u4f8b\u5982 Google \u5c31\u6709\u4e00\u5927\u5806\u722c\u866b\u4f1a\u5728 Internet \u4e0a\u641c\u96c6\u7f51\u9875\u5185\u5bb9\u4ee5\u53ca\u5b83\u4eec\u4e4b\u95f4\u7684\u94fe\u63a5\u7b49\u4fe1\u606f\uff1b\u53c8\u6bd4\u5982\u4e00\u4e9b\u522b\u6709\u7528\u5fc3\u7684\u722c\u866b\u4f1a\u5728 Internet \u4e0a\u641c\u96c6\u8bf8\u5982 foo@bar.com \u6216\u8005 foo [at] bar [dot] com \u4e4b\u7c7b\u7684\u4e1c\u897f\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u6709\u4e00\u4e9b\u5b9a\u5236\u7684\u722c\u866b\uff0c\u4e13\u95e8\u9488\u5bf9\u67d0\u4e00\u4e2a\u7f51\u7ad9\uff0c\u4f8b\u5982\u524d\u4e00\u9635\u5b50 JavaEye \u7684 Robbin \u5c31\u5199\u4e86\u51e0\u7bc7\u4e13\u95e8\u5bf9\u4ed8\u6076\u610f\u722c\u866b\u7684 blog \uff08\u539f\u6587\u94fe\u63a5\u4f3c\u4e4e\u5df2\u7ecf\u5931\u6548\u4e86\uff0c\u5c31\u4e0d\u7ed9\u4e86\uff09\uff0c\u8fd8\u6709\u8bf8\u5982<a href='http:\/\/www.appinn.com\/' style='color: rgb(42, 99, 135);'>\u5c0f\u4f17\u8f6f\u4ef6<\/a>\u6216\u8005<a href='http:\/\/linuxtoy.org\/' style='color: rgb(42, 99, 135);'>LinuxToy<\/a>&nbsp;\u8fd9\u6837\u7684\u7f51\u7ad9\u4e5f\u7ecf\u5e38\u88ab\u6574\u4e2a\u7ad9\u70b9 crawl \u4e0b\u6765\uff0c\u6362\u4e2a\u540d\u5b57\u6302\u51fa\u6765\u3002\u5176\u5b9e\u722c\u866b\u4ece\u57fa\u672c\u539f\u7406\u4e0a\u6765\u8bb2\u5f88\u7b80\u5355\uff0c\u53ea\u8981\u80fd\u8bbf\u95ee\u7f51\u7edc\u548c\u5206\u6790 Web \u9875\u9762\u5373\u53ef\uff0c\u73b0\u5728\u5927\u90e8\u5206\u8bed\u8a00\u90fd\u6709\u65b9\u4fbf\u7684 Http \u5ba2\u6237\u7aef\u5e93\u53ef\u4ee5\u6293\u53d6 Web \u9875\u9762\uff0c\u800c HTML \u7684\u5206\u6790\u6700\u7b80\u5355\u7684\u53ef\u4ee5\u76f4\u63a5\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u6765\u505a\uff0c\u56e0\u6b64\u8981\u505a\u4e00\u4e2a\u6700\u7b80\u964b\u7684\u7f51\u7edc\u722c\u866b\u5b9e\u9645\u4e0a\u662f\u4e00\u4ef6\u5f88\u7b80\u5355\u7684\u4e8b\u60c5\u3002\u4e0d\u8fc7\u8981\u5b9e\u73b0\u4e00\u4e2a\u9ad8\u8d28\u91cf\u7684 spider \u5374\u662f\u975e\u5e38\u96be\u7684\u3002<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u722c\u866b\u7684\u4e24\u90e8\u5206\uff0c\u4e00\u662f\u4e0b\u8f7d Web \u9875\u9762\uff0c\u6709\u8bb8\u591a\u95ee\u9898\u9700\u8981\u8003\u8651\uff0c\u5982\u4f55\u6700\u5927\u7a0b\u5ea6\u5730\u5229\u7528\u672c\u5730\u5e26\u5bbd\uff0c\u5982\u4f55\u8c03\u5ea6\u9488\u5bf9\u4e0d\u540c\u7ad9\u70b9\u7684 Web \u8bf7\u6c42\u4ee5\u51cf\u8f7b\u5bf9\u65b9\u670d\u52a1\u5668\u7684\u8d1f\u62c5\u7b49\u3002\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684 Web Crawler \u7cfb\u7edf\u91cc\uff0cDNS \u67e5\u8be2\u4e5f\u4f1a\u6210\u4e3a\u6025\u9700\u4f18\u5316\u7684\u74f6\u9888\uff0c\u53e6\u5916\uff0c\u8fd8\u6709\u4e00\u4e9b\u201c\u884c\u89c4\u201d\u9700\u8981\u9075\u5faa\uff08\u4f8b\u5982<a href='http:\/\/en.wikipedia.org\/wiki\/Robots_exclusion_standard' style='color: rgb(42, 99, 135);'>robots.txt<\/a>\uff09\u3002\u800c\u83b7\u53d6\u4e86\u7f51\u9875\u4e4b\u540e\u7684\u5206\u6790\u8fc7\u7a0b\u4e5f\u662f\u975e\u5e38\u590d\u6742\u7684\uff0cInternet \u4e0a\u7684\u4e1c\u897f\u5343\u5947\u767e\u602a\uff0c\u5404\u79cd\u9519\u8bef\u767e\u51fa\u7684 HTML \u9875\u9762\u90fd\u6709\uff0c\u8981\u60f3\u5168\u90e8\u5206\u6790\u6e05\u695a\u51e0\u4e4e\u662f\u4e0d\u53ef\u80fd\u7684\u4e8b\uff1b\u53e6\u5916\uff0c\u968f\u7740 AJAX \u7684\u6d41\u884c\uff0c\u5982\u4f55\u83b7\u53d6\u7531 Javascript \u52a8\u6001\u751f\u6210\u7684\u5185\u5bb9\u6210\u4e86\u4e00\u5927\u96be\u9898\uff1b\u9664\u6b64\u4e4b\u5916\uff0cInternet \u4e0a\u8fd8\u6709\u6709\u5404\u79cd\u6709\u610f\u6216\u65e0\u610f\u51fa\u73b0\u7684&nbsp;<a href='http:\/\/en.wikipedia.org\/wiki\/Spider_trap' style='color: rgb(42, 99, 135);'>Spider Trap<\/a>&nbsp;\uff0c\u5982\u679c\u76f2\u76ee\u7684\u8ddf\u8e2a\u8d85\u94fe\u63a5\u7684\u8bdd\uff0c\u5c31\u4f1a\u9677\u5165 Trap \u4e2d\u4e07\u52ab\u4e0d\u590d\u4e86\uff0c\u4f8b\u5982<a href='http:\/\/ianab.com\/trillion\/1.html' style='color: rgb(42, 99, 135);'>\u8fd9\u4e2a\u7f51\u7ad9<\/a>\uff0c\u636e\u8bf4\u662f\u4e4b\u524d Google \u5ba3\u79f0 Internet \u4e0a\u7684 Unique URL \u6570\u76ee\u5df2\u7ecf\u8fbe\u5230\u4e86 1 trillion \u4e2a\uff0c\u56e0\u6b64\u8fd9\u4e2a\u4eba&nbsp;<i>is proud to announce the second trillion<\/i>&nbsp;\u3002&nbsp;<img src='http:\/\/note.youdao.com\/yws\/res\/1928\/CFD348C51A1548B2964C9FBBE5F6A302' alt=':D' data-media-type='image'><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u4e0d\u8fc7\uff0c\u5176\u5b9e\u5e76\u6ca1\u6709\u591a\u5c11\u4eba\u9700\u8981\u505a\u50cf Google \u90a3\u6837\u901a\u7528\u7684 Crawler \uff0c\u901a\u5e38\u6211\u4eec\u505a\u4e00\u4e2a Crawler \u5c31\u662f\u4e3a\u4e86\u53bb\u722c\u7279\u5b9a\u7684\u67d0\u4e2a\u6216\u8005\u67d0\u4e00\u7c7b\u7f51\u7ad9\uff0c\u6240\u8c13\u77e5\u5df1\u77e5\u5f7c\uff0c\u767e\u6218\u4e0d\u6b86\uff0c\u6211\u4eec\u53ef\u4ee5\u4e8b\u5148\u5bf9\u9700\u8981\u722c\u7684\u7f51\u7ad9\u7ed3\u6784\u505a\u4e00\u4e9b\u5206\u6790\uff0c\u4e8b\u60c5\u5c31\u53d8\u5f97\u5bb9\u6613\u591a\u4e86\u3002\u901a\u8fc7\u5206\u6790\uff0c\u9009\u51fa\u6709\u4ef7\u503c\u7684\u94fe\u63a5\u8fdb\u884c\u8ddf\u8e2a\uff0c\u5c31\u53ef\u4ee5\u907f\u514d\u5f88\u591a\u4e0d\u5fc5\u8981\u7684\u94fe\u63a5\u6216\u8005 Spider Trap \uff0c\u5982\u679c\u7f51\u7ad9\u7684\u7ed3\u6784\u5141\u8bb8\u9009\u62e9\u4e00\u4e2a\u5408\u9002\u7684\u8def\u5f84\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u4e00\u5b9a\u987a\u5e8f\u628a\u611f\u5174\u8da3\u7684\u4e1c\u897f\u722c\u4e00\u904d\uff0c\u8fd9\u6837\u4ee5\u6765\uff0c\u8fde URL \u91cd\u590d\u7684\u5224\u65ad\u4e5f\u53ef\u4ee5\u7701\u53bb\u3002<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5047\u5982\u6211\u4eec\u60f3\u628a pongba \u7684 blog&nbsp;<a href='http:\/\/mindhacks.cn\/' style='color: rgb(42, 99, 135);'>mindhacks.cn<\/a>&nbsp;\u91cc\u9762\u7684 blog \u6587\u5b57\u722c\u4e0b\u6765\uff0c\u901a\u8fc7\u89c2\u5bdf\uff0c\u5f88\u5bb9\u6613\u53d1\u73b0\u6211\u4eec\u5bf9\u5176\u4e2d\u7684\u4e24\u79cd\u9875\u9762\u611f\u5174\u8da3\uff1a<\/p> \r\n <ol style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'> \r\n  <li>\u6587\u7ae0\u5217\u8868\u9875\u9762\uff0c\u4f8b\u5982\u9996\u9875\uff0c\u6216\u8005 URL \u662f&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>\/page\/\\d+\/<\/code>&nbsp;\u8fd9\u6837\u7684\u9875\u9762\uff0c\u901a\u8fc7&nbsp;<a href='http:\/\/getfirebug.com\/' style='color: rgb(42, 99, 135);'>Firebug<\/a>&nbsp;\u53ef\u4ee5\u770b\u5230\u5230\u6bcf\u7bc7\u6587\u7ae0\u7684\u94fe\u63a5\u90fd\u662f\u5728\u4e00\u4e2a&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>h1<\/code>&nbsp;\u4e0b\u7684&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>a<\/code>&nbsp;\u6807\u7b7e\u91cc\u7684\uff08\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728 Firebug \u7684 HTML \u9762\u677f\u91cc\u770b\u5230\u7684 HTML \u4ee3\u7801\u548c View Source \u6240\u770b\u5230\u7684\u4e5f\u8bb8\u4f1a\u6709\u4e9b\u51fa\u5165\uff0c\u5982\u679c\u7f51\u9875\u4e2d\u6709 Javascript \u52a8\u6001\u4fee\u6539 DOM \u6811\u7684\u8bdd\uff0c\u524d\u8005\u662f\u88ab\u4fee\u6539\u8fc7\u7684\u7248\u672c\uff0c\u5e76\u4e14\u7ecf\u8fc7 Firebug \u89c4\u5219\u5316\u7684\uff0c\u4f8b\u5982 attribute \u90fd\u6709\u5f15\u53f7\u6269\u8d77\u6765\u7b49\uff0c\u800c\u540e\u8005\u901a\u5e38\u624d\u662f\u4f60\u7684 spider \u722c\u5230\u7684\u539f\u59cb\u5185\u5bb9\u3002\u5982\u679c\u662f\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u5bf9\u9875\u9762\u8fdb\u884c\u5206\u6790\u6216\u8005\u6240\u7528\u7684 HTML Parser \u548c Firefox \u7684\u6709\u4e9b\u51fa\u5165\u7684\u8bdd\uff0c\u9700\u8981\u7279\u522b\u6ce8\u610f\uff09\uff0c\u53e6\u5916\uff0c\u5728\u4e00\u4e2a class \u4e3a&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>wp-pagenavi<\/code>&nbsp;\u7684&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>div<\/code>&nbsp;\u91cc\u6709\u5230\u4e0d\u540c\u5217\u8868\u9875\u9762\u7684\u94fe\u63a5\u3002<\/li> \r\n  <li>\u6587\u7ae0\u5185\u5bb9\u9875\u9762\uff0c\u6bcf\u7bc7 blog \u6709\u8fd9\u6837\u4e00\u4e2a\u9875\u9762\uff0c\u4f8b\u5982&nbsp;<a href='http:\/\/mindhacks.cn\/2008\/09\/11\/machine-learning-and-ai-resources\/' style='color: rgb(42, 99, 135);'>\/2008\/09\/11\/machine-learning-and-ai-resources\/<\/a>&nbsp;\uff0c\u5305\u542b\u4e86\u5b8c\u6574\u7684\u6587\u7ae0\u5185\u5bb9\uff0c\u8fd9\u662f\u6211\u4eec\u611f\u5174\u8da3\u7684\u5185\u5bb9\u3002<\/li> \r\n <\/ol> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u56e0\u6b64\uff0c\u6211\u4eec\u4ece\u9996\u9875\u5f00\u59cb\uff0c\u901a\u8fc7&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>wp-pagenavi<\/code>&nbsp;\u91cc\u7684\u94fe\u63a5\u6765\u5f97\u5230\u5176\u4ed6\u7684\u6587\u7ae0\u5217\u8868\u9875\u9762\uff0c\u7279\u522b\u5730\uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u8def\u5f84\uff1a\u53ea follow&nbsp;<i>Next Page<\/i>&nbsp;\u7684\u94fe\u63a5\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4ece\u5934\u5230\u5c3e\u6309\u987a\u5e8f\u8d70\u4e00\u904d\uff0c\u514d\u53bb\u4e86\u9700\u8981\u5224\u65ad\u91cd\u590d\u6293\u53d6\u7684\u70e6\u607c\u3002\u53e6\u5916\uff0c\u6587\u7ae0\u5217\u8868\u9875\u9762\u7684\u90a3\u4e9b\u5230\u5177\u4f53\u6587\u7ae0\u7684\u94fe\u63a5\u6240\u5bf9\u5e94\u7684\u9875\u9762\u5c31\u662f\u6211\u4eec\u771f\u6b63\u8981\u4fdd\u5b58\u7684\u6570\u636e\u9875\u9762\u4e86\u3002<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u8fd9\u6837\u4ee5\u6765\uff0c\u5176\u5b9e\u7528\u811a\u672c\u8bed\u8a00\u5199\u4e00\u4e2a ad hoc \u7684 Crawler \u6765\u5b8c\u6210\u8fd9\u4e2a\u4efb\u52a1\u4e5f\u5e76\u4e0d\u96be\uff0c\u4e0d\u8fc7\u4eca\u5929\u7684\u4e3b\u89d2\u662f&nbsp;<a href='http:\/\/scrapy.org\/' style='color: rgb(42, 99, 135);'>Scrapy<\/a>&nbsp;\uff0c\u8fd9\u662f\u4e00\u4e2a\u7528 Python \u5199\u7684 Crawler Framework \uff0c\u7b80\u5355\u8f7b\u5de7\uff0c\u5e76\u4e14\u975e\u5e38\u65b9\u4fbf\uff0c\u5e76\u4e14\u5b98\u7f51\u4e0a\u8bf4\u5df2\u7ecf\u5728\u5b9e\u9645\u751f\u4ea7\u4e2d\u5728\u4f7f\u7528\u4e86\uff0c\u56e0\u6b64\u5e76\u4e0d\u662f\u4e00\u4e2a\u73a9\u5177\u7ea7\u522b\u7684\u4e1c\u897f\u3002\u4e0d\u8fc7\u73b0\u5728\u8fd8\u6ca1\u6709 Release \u7248\u672c\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4ed6\u4eec\u7684&nbsp;<a href='http:\/\/hg.scrapy.org\/scrapy\/' style='color: rgb(42, 99, 135);'>Mercurial \u4ed3\u5e93<\/a>\u91cc\u6293\u53d6\u6e90\u7801\u8fdb\u884c\u5b89\u88c5\u3002\u4e0d\u8fc7\uff0c\u8fd9\u4e2a\u4e1c\u897f\u4e5f\u53ef\u4ee5\u4e0d\u5b89\u88c5\u76f4\u63a5\u4f7f\u7528\uff0c\u8fd9\u6837\u8fd8\u65b9\u4fbf\u968f\u65f6\u66f4\u65b0\uff0c<a href='http:\/\/doc.scrapy.org\/intro\/install.html' style='color: rgb(42, 99, 135);'>\u6587\u6863<\/a>\u91cc\u8bf4\u5f97\u5f88\u8be6\u7ec6\uff0c\u6211\u5c31\u4e0d\u91cd\u590d\u4e86\u3002<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>Scrapy \u4f7f\u7528&nbsp;<a href='http:\/\/twistedmatrix.com\/trac\/' style='color: rgb(42, 99, 135);'>Twisted<\/a>&nbsp;\u8fd9\u4e2a\u5f02\u6b65\u7f51\u7edc\u5e93\u6765\u5904\u7406\u7f51\u7edc\u901a\u8baf\uff0c\u67b6\u6784\u6e05\u6670\uff0c\u5e76\u4e14\u5305\u542b\u4e86\u5404\u79cd\u4e2d\u95f4\u4ef6\u63a5\u53e3\uff0c\u53ef\u4ee5\u7075\u6d3b\u7684\u5b8c\u6210\u5404\u79cd\u9700\u6c42\u3002\u6574\u4f53\u67b6\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff1a<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'><img title='scrapy_architecture' src='http:\/\/note.youdao.com\/yws\/res\/1930\/D43DB8B74E2A46E0A1E116BD5004433C' alt='scrapy_architecture' width='550' height='388' data-media-type='image'><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u7eff\u7ebf\u662f\u6570\u636e\u6d41\u5411\uff0c\u9996\u5148\u4ece\u521d\u59cb URL \u5f00\u59cb\uff0cScheduler \u4f1a\u5c06\u5176\u4ea4\u7ed9 Downloader \u8fdb\u884c\u4e0b\u8f7d\uff0c\u4e0b\u8f7d\u4e4b\u540e\u4f1a\u4ea4\u7ed9 Spider \u8fdb\u884c\u5206\u6790\uff0cSpider \u5206\u6790\u51fa\u6765\u7684\u7ed3\u679c\u6709\u4e24\u79cd\uff1a\u4e00\u79cd\u662f\u9700\u8981\u8fdb\u4e00\u6b65\u6293\u53d6\u7684\u94fe\u63a5\uff0c\u4f8b\u5982\u4e4b\u524d\u5206\u6790\u7684\u201c\u4e0b\u4e00\u9875\u201d\u7684\u94fe\u63a5\uff0c\u8fd9\u4e9b\u4e1c\u897f\u4f1a\u88ab\u4f20\u56de Scheduler \uff1b\u53e6\u4e00\u79cd\u662f\u9700\u8981\u4fdd\u5b58\u7684\u6570\u636e\uff0c\u5b83\u4eec\u5219\u88ab\u9001\u5230 Item Pipeline \u90a3\u91cc\uff0c\u90a3\u662f\u5bf9\u6570\u636e\u8fdb\u884c\u540e\u671f\u5904\u7406\uff08\u8be6\u7ec6\u5206\u6790\u3001\u8fc7\u6ee4\u3001\u5b58\u50a8\u7b49\uff09\u7684\u5730\u65b9\u3002\u53e6\u5916\uff0c\u5728\u6570\u636e\u6d41\u52a8\u7684\u901a\u9053\u91cc\u8fd8\u53ef\u4ee5\u5b89\u88c5\u5404\u79cd\u4e2d\u95f4\u4ef6\uff0c\u8fdb\u884c\u5fc5\u8981\u7684\u5904\u7406\u3002<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u770b\u8d77\u6765\u597d\u50cf\u5f88\u590d\u6742\uff0c\u5176\u5b9e\u7528\u8d77\u6765\u5f88\u7b80\u5355\uff0c\u5c31\u5982\u540c Rails \u4e00\u6837\uff0c\u9996\u5148\u65b0\u5efa\u4e00\u4e2a\u5de5\u7a0b\uff1a<\/p> \r\n <div style='background-color: rgb(249, 249, 249); color: rgb(17, 0, 0); font-family: tahoma, arial, sans-serif;'> \r\n  <table border='1' cellpadding='2' cellspacing='0' style='font-size: 1em;'> \r\n   <tbody> \r\n    <tr> \r\n     <td style='background-color:rgb(244, 244, 244);width:584px;'><pre style='font-family: monospace;'>scrapy-admin.py startproject blog_crawl<\/pre><\/td> \r\n    <\/tr> \r\n   <\/tbody> \r\n  <\/table> \r\n <\/div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u4f1a\u521b\u5efa\u4e00\u4e2a&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>blog_crawl<\/code>&nbsp;\u76ee\u5f55\uff0c\u91cc\u9762\u6709\u4e2a&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>scrapy-ctl.py<\/code>&nbsp;\u662f\u6574\u4e2a\u9879\u76ee\u7684\u63a7\u5236\u811a\u672c\uff0c\u800c\u4ee3\u7801\u5168\u90fd\u653e\u5728\u5b50\u76ee\u5f55&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>blog_crawl<\/code>&nbsp;\u91cc\u9762\u3002\u4e3a\u4e86\u80fd\u6293\u53d6 mindhacks.cn \uff0c\u6211\u4eec\u5728&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>spiders<\/code>&nbsp;\u76ee\u5f55\u91cc\u65b0\u5efa\u4e00\u4e2a<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>mindhacks_spider.py<\/code>&nbsp;\uff0c\u5b9a\u4e49\u6211\u4eec\u7684 Spider \u5982\u4e0b\uff1a<\/p> \r\n <div style='background-color: rgb(249, 249, 249); color: rgb(17, 0, 0); font-family: tahoma, arial, sans-serif;'> \r\n  <table border='1' cellpadding='2' cellspacing='0' style='font-size: 1em;'> \r\n   <tbody> \r\n    <tr> \r\n     <td style='background-color:rgb(255, 255, 255) !important;width:584px;'><pre style='font-family: monospace;'><span style='color:rgb(255, 119, 0);font-weight:bold;'>from<\/span> scrapy.spider <span style='color:rgb(255, 119, 0);font-weight:bold;'>import<\/span> BaseSpider\r\n&nbsp;\r\n<span style='color:rgb(255, 119, 0);font-weight:bold;'>class<\/span> MindhacksSpider(BaseSpider):\r\n    domain_name <span style='color:rgb(102, 204, 102);'>=<\/span> <span style='color:rgb(72, 61, 139);'>'mindhacks.cn'<\/span>\r\n    start_urls <span style='color:rgb(102, 204, 102);'>=<\/span> [<span style='color:rgb(72, 61, 139);'>'http:\/\/mindhacks.cn\/'<\/span>]\r\n&nbsp;\r\n    <span style='color:rgb(255, 119, 0);font-weight:bold;'>def<\/span> parse(<span style='color:rgb(0, 128, 0);'>self<\/span><span style='color:rgb(102, 204, 102);'>,<\/span> response):\r\n        <span style='color:rgb(255, 119, 0);font-weight:bold;'>return<\/span> []\r\n&nbsp;\r\nSPIDER <span style='color:rgb(102, 204, 102);'>=<\/span> MindhacksSpider()<\/pre><\/td> \r\n    <\/tr> \r\n   <\/tbody> \r\n  <\/table> \r\n <\/div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u6211\u4eec\u7684&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>MindhacksSpider<\/code>&nbsp;\u7ee7\u627f\u81ea&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>BaseSpider<\/code>&nbsp;\uff08\u901a\u5e38\u76f4\u63a5\u7ee7\u627f\u81ea\u529f\u80fd\u66f4\u4e30\u5bcc\u7684<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>scrapy.contrib.spiders.CrawlSpider<\/code>&nbsp;\u8981\u65b9\u4fbf\u4e00\u4e9b\uff0c\u4e0d\u8fc7\u4e3a\u4e86\u5c55\u793a\u6570\u636e\u662f\u5982\u4f55 parse \u7684\uff0c\u8fd9\u91cc\u8fd8\u662f\u4f7f\u7528&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>BaseSpider<\/code>&nbsp;\u4e86\uff09\uff0c\u53d8\u91cf&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>domain_name<\/code>&nbsp;\u548c&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>start_urls<\/code>&nbsp;\u90fd\u5f88\u5bb9\u6613\u660e\u767d\u662f\u4ec0\u4e48\u610f\u601d\uff0c\u800c&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>parse<\/code>&nbsp;\u65b9\u6cd5\u662f\u6211\u4eec\u9700\u8981\u5b9a\u4e49\u7684\u56de\u8c03\u51fd\u6570\uff0c\u9ed8\u8ba4\u7684 request \u5f97\u5230 response \u4e4b\u540e\u4f1a\u8c03\u7528\u8fd9\u4e2a\u56de\u8c03\u51fd\u6570\uff0c\u6211\u4eec\u9700\u8981\u5728\u8fd9\u91cc\u5bf9\u9875\u9762\u8fdb\u884c\u89e3\u6790\uff0c\u8fd4\u56de\u4e24\u79cd\u7ed3\u679c\uff08\u9700\u8981\u8fdb\u4e00\u6b65 crawl \u7684\u94fe\u63a5\u548c\u9700\u8981\u4fdd\u5b58\u7684\u6570\u636e\uff09\uff0c\u8ba9\u6211\u611f\u89c9\u6709\u4e9b\u5947\u602a\u7684\u662f\uff0c\u5b83\u7684\u63a5\u53e3\u5b9a\u4e49\u91cc\u8fd9\u4e24\u79cd\u7ed3\u679c\u7adf\u7136\u662f\u6df7\u6742\u5728\u4e00\u4e2a list \u91cc\u8fd4\u56de\u7684\uff0c\u4e0d\u592a\u6e05\u695a\u8fd9\u91cc\u4e3a\u4f55\u8fd9\u6837\u8bbe\u8ba1\uff0c\u96be\u9053\u6700\u540e\u4e0d\u8fd8\u662f\u8981\u8d39\u529b\u628a\u5b83\u4eec\u5206\u5f00\uff1f\u603b\u4e4b\u8fd9\u91cc\u6211\u4eec\u5148\u5199\u4e00\u4e2a\u7a7a\u51fd\u6570\uff0c\u53ea\u8fd4\u56de\u4e00\u4e2a\u7a7a\u5217\u8868\u3002\u53e6\u5916\uff0c\u5b9a\u4e49\u4e00\u4e2a\u201c\u5168\u5c40\u201d\u53d8\u91cf&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>SPIDER<\/code>&nbsp;\uff0c\u5b83\u4f1a\u5728 Scrapy \u5bfc\u5165\u8fd9\u4e2a module \u7684\u65f6\u5019\u5b9e\u4f8b\u5316\uff0c\u5e76\u81ea\u52a8\u88ab Scrapy \u7684\u5f15\u64ce\u627e\u5230\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u5148\u8fd0\u884c\u4e00\u4e0b crawler \u8bd5\u8bd5\u4e86\uff1a<\/p> \r\n <div style='background-color: rgb(249, 249, 249); color: rgb(17, 0, 0); font-family: tahoma, arial, sans-serif;'> \r\n  <table border='1' cellpadding='2' cellspacing='0' style='font-size: 1em;'> \r\n   <tbody> \r\n    <tr> \r\n     <td style='background-color:rgb(244, 244, 244);width:584px;'><pre style='font-family: monospace;'>.\/scrapy-ctl.py crawl mindhacks.cn<\/pre><\/td> \r\n    <\/tr> \r\n   <\/tbody> \r\n  <\/table> \r\n <\/div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u4f1a\u6709\u4e00\u5806\u8f93\u51fa\uff0c\u53ef\u4ee5\u770b\u5230\u6293\u53d6\u4e86&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>http:\/\/mindhacks.cn<\/code>&nbsp;\uff0c\u56e0\u4e3a\u8fd9\u662f\u521d\u59cb URL \uff0c\u4f46\u662f\u7531\u4e8e\u6211\u4eec\u5728&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>parse<\/code>&nbsp;\u51fd\u6570\u91cc\u6ca1\u6709\u8fd4\u56de\u9700\u8981\u8fdb\u4e00\u6b65\u6293\u53d6\u7684 URL \uff0c\u56e0\u6b64\u6574\u4e2a crawl \u8fc7\u7a0b\u53ea\u6293\u53d6\u4e86\u4e3b\u9875\u4fbf\u7ed3\u675f\u4e86\u3002\u63a5\u4e0b\u6765\u4fbf\u662f\u8981\u5bf9\u9875\u9762\u8fdb\u884c\u5206\u6790\uff0cScrapy \u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f88\u65b9\u4fbf\u7684 Shell \uff08\u9700\u8981 IPython \uff09\u53ef\u4ee5\u8ba9\u6211\u4eec\u505a\u5b9e\u9a8c\uff0c\u7528\u5982\u4e0b\u547d\u4ee4\u542f\u52a8 Shell \uff1a<\/p> \r\n <div style='background-color: rgb(249, 249, 249); color: rgb(17, 0, 0); font-family: tahoma, arial, sans-serif;'> \r\n  <table border='1' cellpadding='2' cellspacing='0' style='font-size: 1em;'> \r\n   <tbody> \r\n    <tr> \r\n     <td style='background-color:rgb(255, 255, 255) !important;width:584px;'><pre style='font-family: monospace;'>.\/scrapy-ctl.py shell http:\/\/mindhacks.cn<\/pre><\/td> \r\n    <\/tr> \r\n   <\/tbody> \r\n  <\/table> \r\n <\/div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u5b83\u4f1a\u542f\u52a8 crawler \uff0c\u628a\u547d\u4ee4\u884c\u6307\u5b9a\u7684\u8fd9\u4e2a\u9875\u9762\u6293\u53d6\u4e0b\u6765\uff0c\u7136\u540e\u8fdb\u5165 shell \uff0c\u6839\u636e\u63d0\u793a\uff0c\u6211\u4eec\u6709\u8bb8\u591a\u73b0\u6210\u7684\u53d8\u91cf\u53ef\u4ee5\u7528\uff0c\u5176\u4e2d\u4e00\u4e2a\u5c31\u662f&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>hxs<\/code>&nbsp;\uff0c\u5b83\u662f\u4e00\u4e2a&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>HtmlXPathSelector<\/code>&nbsp;\uff0cmindhacks \u7684 HTML \u9875\u9762\u6bd4\u8f83\u89c4\u8303\uff0c\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u76f4\u63a5\u7528&nbsp;<a href='http:\/\/www.w3schools.com\/XPath\/default.asp' style='color: rgb(42, 99, 135);'>XPath<\/a>&nbsp;\u8fdb\u884c\u5206\u6790\u3002\u901a\u8fc7 Firebug \u53ef\u4ee5\u770b\u5230\uff0c\u5230\u6bcf\u7bc7 blog \u6587\u7ae0\u7684\u94fe\u63a5\u90fd\u662f\u5728&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>h1<\/code>&nbsp;\u4e0b\u7684\uff0c\u56e0\u6b64\u5728 Shell \u4e2d\u4f7f\u7528\u8fd9\u6837\u7684 XPath \u8868\u8fbe\u5f0f\u6d4b\u8bd5\uff1a<\/p> \r\n <div style='background-color: rgb(249, 249, 249); color: rgb(17, 0, 0); font-family: tahoma, arial, sans-serif;'> \r\n  <table border='1' cellpadding='2' cellspacing='0' style='font-size: 1em;'> \r\n   <tbody> \r\n    <tr> \r\n     <td style='background-color:rgb(244, 244, 244);width:584px;'><pre style='font-family: monospace;'>In [<span style='color:rgb(255, 69, 0);'>1<\/span>]: hxs.x(<span style='color:rgb(72, 61, 139);'>'\/\/h1\/a\/@href'<\/span>).extract()\r\nOut[<span style='color:rgb(255, 69, 0);'>1<\/span>]: \r\n[u<span style='color:rgb(72, 61, 139);'>'http:\/\/mindhacks.cn\/2009\/07\/06\/why-you-should-do-it-yourself\/'<\/span><span style='color:rgb(102, 204, 102);'>,<\/span>\r\n u<span style='color:rgb(72, 61, 139);'>'http:\/\/mindhacks.cn\/2009\/05\/17\/seven-years-in-nju\/'<\/span><span style='color:rgb(102, 204, 102);'>,<\/span>\r\n u<span style='color:rgb(72, 61, 139);'>'http:\/\/mindhacks.cn\/2009\/03\/28\/effective-learning-and-memorization\/'<\/span><span style='color:rgb(102, 204, 102);'>,<\/span>\r\n u<span style='color:rgb(72, 61, 139);'>'http:\/\/mindhacks.cn\/2009\/03\/15\/preconception-explained\/'<\/span><span style='color:rgb(102, 204, 102);'>,<\/span>\r\n u<span style='color:rgb(72, 61, 139);'>'http:\/\/mindhacks.cn\/2009\/03\/09\/first-principles-of-programming\/'<\/span><span style='color:rgb(102, 204, 102);'>,<\/span>\r\n u<span style='color:rgb(72, 61, 139);'>'http:\/\/mindhacks.cn\/2009\/02\/15\/why-you-should-start-blogging-now\/'<\/span><span style='color:rgb(102, 204, 102);'>,<\/span>\r\n u<span style='color:rgb(72, 61, 139);'>'http:\/\/mindhacks.cn\/2009\/02\/09\/writing-is-better-thinking\/'<\/span><span style='color:rgb(102, 204, 102);'>,<\/span>\r\n u<span style='color:rgb(72, 61, 139);'>'http:\/\/mindhacks.cn\/2009\/02\/07\/better-explained-conflicts-in-intimate-relationship\/'<\/span><span style='color:rgb(102, 204, 102);'>,<\/span>\r\n u<span style='color:rgb(72, 61, 139);'>'http:\/\/mindhacks.cn\/2009\/02\/07\/independence-day\/'<\/span><span style='color:rgb(102, 204, 102);'>,<\/span>\r\n u<span style='color:rgb(72, 61, 139);'>'http:\/\/mindhacks.cn\/2009\/01\/18\/escape-from-your-shawshank-part1\/'<\/span>]<\/pre><\/td> \r\n    <\/tr> \r\n   <\/tbody> \r\n  <\/table> \r\n <\/div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u8fd9\u6b63\u662f\u6211\u4eec\u9700\u8981\u7684 URL \uff0c\u53e6\u5916\uff0c\u8fd8\u53ef\u4ee5\u627e\u5230\u201c\u4e0b\u4e00\u9875\u201d\u7684\u94fe\u63a5\u6240\u5728\uff0c\u8fde\u540c\u5176\u4ed6\u51e0\u4e2a\u9875\u9762\u7684\u94fe\u63a5\u4e00\u540c\u5728\u4e00\u4e2a&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>div<\/code>&nbsp;\u91cc\uff0c\u4e0d\u8fc7\u201c\u4e0b\u4e00\u9875\u201d\u7684\u94fe\u63a5\u6ca1\u6709&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>title<\/code>&nbsp;\u5c5e\u6027\uff0c\u56e0\u6b64 XPath \u5199\u4f5c<\/p> \r\n <div style='background-color: rgb(249, 249, 249); color: rgb(17, 0, 0); font-family: tahoma, arial, sans-serif;'> \r\n  <table border='1' cellpadding='2' cellspacing='0' style='font-size: 1em;'> \r\n   <tbody> \r\n    <tr> \r\n     <td style='background-color:rgb(255, 255, 255) !important;width:584px;'><pre style='font-family: monospace;'>\/\/div[@class='wp-pagenavi']\/a[not(@title)]<\/pre><\/td> \r\n    <\/tr> \r\n   <\/tbody> \r\n  <\/table> \r\n <\/div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u4e0d\u8fc7\u5982\u679c\u5411\u540e\u7ffb\u4e00\u9875\u7684\u8bdd\uff0c\u4f1a\u53d1\u73b0\u5176\u5b9e\u201c\u4e0a\u4e00\u9875\u201d\u4e5f\u662f\u8fd9\u6837\u7684\uff0c\u56e0\u6b64\u8fd8\u9700\u8981\u5224\u65ad\u8be5\u94fe\u63a5\u4e0a\u7684\u6587\u5b57\u662f\u90a3\u4e2a\u4e0b\u4e00\u9875\u7684\u7bad\u5934&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>u'\\xbb'<\/code>&nbsp;\uff0c\u672c\u6765\u4e5f\u53ef\u4ee5\u5199\u5230 XPath \u91cc\u9762\u53bb\uff0c\u4f46\u662f\u597d\u50cf\u8fd9\u4e2a\u672c\u8eab\u662f unicode escape \u5b57\u7b26\uff0c\u7531\u4e8e\u7f16\u7801\u539f\u56e0\u7406\u4e0d\u6e05\u695a\uff0c\u76f4\u63a5\u653e\u5230\u5916\u9762\u5224\u65ad\u4e86\uff0c\u6700\u7ec8&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>parse<\/code>&nbsp;\u51fd\u6570\u5982\u4e0b\uff1a<\/p> \r\n <div style='background-color: rgb(249, 249, 249); color: rgb(17, 0, 0); font-family: tahoma, arial, sans-serif;'> \r\n  <table border='1' cellpadding='2' cellspacing='0' style='font-size: 1em;'> \r\n   <tbody> \r\n    <tr> \r\n     <td style='background-color:rgb(244, 244, 244);width:584px;'><pre style='font-family: monospace;'><span style='color:rgb(255, 119, 0);font-weight:bold;'>def<\/span> parse(<span style='color:rgb(0, 128, 0);'>self<\/span><span style='color:rgb(102, 204, 102);'>,<\/span> response):\r\n    items <span style='color:rgb(102, 204, 102);'>=<\/span> []\r\n    hxs <span style='color:rgb(102, 204, 102);'>=<\/span> HtmlXPathSelector(response)\r\n    posts <span style='color:rgb(102, 204, 102);'>=<\/span> hxs.x(<span style='color:rgb(72, 61, 139);'>'\/\/h1\/a\/@href'<\/span>).extract()\r\n    items.extend([<span style='color:rgb(0, 128, 0);'>self<\/span>.make_requests_from_url(url).replace(callback<span style='color:rgb(102, 204, 102);'>=<\/span><span style='color:rgb(0, 128, 0);'>self<\/span>.parse_post)\r\n                  <span style='color:rgb(255, 119, 0);font-weight:bold;'>for<\/span> url <span style='color:rgb(255, 119, 0);font-weight:bold;'>in<\/span> posts])\r\n&nbsp;\r\n    page_links <span style='color:rgb(102, 204, 102);'>=<\/span> hxs.x(<span style='color:rgb(72, 61, 139);'>'\/\/div[@class='wp-pagenavi']\/a[not(@title)]'<\/span>)\r\n    <span style='color:rgb(255, 119, 0);font-weight:bold;'>for<\/span> link <span style='color:rgb(255, 119, 0);font-weight:bold;'>in<\/span> page_links:\r\n        <span style='color:rgb(255, 119, 0);font-weight:bold;'>if<\/span> link.x(<span style='color:rgb(72, 61, 139);'>'text()'<\/span>).extract()[<span style='color:rgb(255, 69, 0);'>0<\/span>] <span style='color:rgb(102, 204, 102);'>==<\/span> u<span style='color:rgb(72, 61, 139);'>'<span style='color:rgb(0, 0, 153);font-weight:bold;'>\\x<\/span>bb'<\/span>:\r\n            url <span style='color:rgb(102, 204, 102);'>=<\/span> link.x(<span style='color:rgb(72, 61, 139);'>'@href'<\/span>).extract()[<span style='color:rgb(255, 69, 0);'>0<\/span>]\r\n            items.append(<span style='color:rgb(0, 128, 0);'>self<\/span>.make_requests_from_url(url))\r\n&nbsp;\r\n    <span style='color:rgb(255, 119, 0);font-weight:bold;'>return<\/span> items<\/pre><\/td> \r\n    <\/tr> \r\n   <\/tbody> \r\n  <\/table> \r\n <\/div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u524d\u534a\u90e8\u5206\u662f\u89e3\u6790\u9700\u8981\u6293\u53d6\u7684 blog \u6b63\u6587\u7684\u94fe\u63a5\uff0c\u540e\u534a\u90e8\u5206\u5219\u662f\u7ed9\u51fa\u201c\u4e0b\u4e00\u9875\u201d\u7684\u94fe\u63a5\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u91cc\u8fd4\u56de\u7684\u5217\u8868\u91cc\u5e76\u4e0d\u662f\u4e00\u4e2a\u4e2a\u7684\u5b57\u7b26\u4e32\u683c\u5f0f\u7684 URL \u5c31\u5b8c\u4e86\uff0cScrapy \u5e0c\u671b\u5f97\u5230\u7684\u662f<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>Request<\/code>&nbsp;\u5bf9\u8c61\uff0c\u8fd9\u6bd4\u4e00\u4e2a\u5b57\u7b26\u4e32\u683c\u5f0f\u7684 URL \u80fd\u643a\u5e26\u66f4\u591a\u7684\u4e1c\u897f\uff0c\u8bf8\u5982 Cookie \u6216\u8005\u56de\u8c03\u51fd\u6570\u4e4b\u7c7b\u7684\u3002\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u5728\u521b\u5efa blog \u6b63\u6587\u7684&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>Request<\/code>&nbsp;\u7684\u65f6\u5019\u66ff\u6362\u6389\u4e86\u56de\u8c03\u51fd\u6570\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u7684\u8fd9\u4e2a\u56de\u8c03\u51fd\u6570&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>parse<\/code>&nbsp;\u662f\u4e13\u95e8\u7528\u6765\u89e3\u6790\u6587\u7ae0\u5217\u8868\u8fd9\u6837\u7684\u9875\u9762\u7684\uff0c\u800c&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>parse_post<\/code>&nbsp;\u5b9a\u4e49\u5982\u4e0b\uff1a<\/p> \r\n <div style='background-color: rgb(249, 249, 249); color: rgb(17, 0, 0); font-family: tahoma, arial, sans-serif;'> \r\n  <table border='1' cellpadding='2' cellspacing='0' style='font-size: 1em;'> \r\n   <tbody> \r\n    <tr> \r\n     <td style='background-color:rgb(255, 255, 255) !important;width:584px;'><pre style='font-family: monospace;'><span style='color:rgb(255, 119, 0);font-weight:bold;'>def<\/span> parse_post(<span style='color:rgb(0, 128, 0);'>self<\/span><span style='color:rgb(102, 204, 102);'>,<\/span> response):\r\n    item <span style='color:rgb(102, 204, 102);'>=<\/span> BlogCrawlItem()\r\n    item.url <span style='color:rgb(102, 204, 102);'>=<\/span> <span style='color:rgb(0, 128, 0);'>unicode<\/span>(response.url)\r\n    item.raw <span style='color:rgb(102, 204, 102);'>=<\/span> response.body_as_unicode()\r\n    <span style='color:rgb(255, 119, 0);font-weight:bold;'>return<\/span> [item]<\/pre><\/td> \r\n    <\/tr> \r\n   <\/tbody> \r\n  <\/table> \r\n <\/div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u5f88\u7b80\u5355\uff0c\u8fd4\u56de\u4e00\u4e2a&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>BlogCrawlItem<\/code>&nbsp;\uff0c\u628a\u6293\u5230\u7684\u6570\u636e\u653e\u5728\u91cc\u9762\uff0c\u672c\u6765\u53ef\u4ee5\u5728\u8fd9\u91cc\u505a\u4e00\u70b9\u89e3\u6790\uff0c\u4f8b\u5982\uff0c\u901a\u8fc7 XPath \u628a\u6b63\u6587\u548c\u6807\u9898\u7b49\u89e3\u6790\u51fa\u6765\uff0c\u4f46\u662f\u6211\u503e\u5411\u4e8e\u540e\u9762\u518d\u6765\u505a\u8fd9\u4e9b\u4e8b\u60c5\uff0c\u4f8b\u5982 Item Pipeline \u6216\u8005\u66f4\u540e\u9762\u7684 Offline \u9636\u6bb5\u3002<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>BlogCrawlItem<\/code>&nbsp;\u662f Scrapy \u81ea\u52a8\u5e2e\u6211\u4eec\u5b9a\u4e49\u597d\u7684\u4e00\u4e2a\u7ee7\u627f\u81ea&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>ScrapedItem<\/code>&nbsp;\u7684\u7a7a\u7c7b\uff0c\u5728&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>items.py<\/code>&nbsp;\u4e2d\uff0c\u8fd9\u91cc\u6211\u52a0\u4e86\u4e00\u70b9\u4e1c\u897f\uff1a<\/p> \r\n <div style='background-color: rgb(249, 249, 249); color: rgb(17, 0, 0); font-family: tahoma, arial, sans-serif;'> \r\n  <table border='1' cellpadding='2' cellspacing='0' style='font-size: 1em;'> \r\n   <tbody> \r\n    <tr> \r\n     <td style='background-color:rgb(244, 244, 244);width:584px;'><pre style='font-family: monospace;'><span style='color:rgb(255, 119, 0);font-weight:bold;'>from<\/span> scrapy.item <span style='color:rgb(255, 119, 0);font-weight:bold;'>import<\/span> ScrapedItem\r\n&nbsp;\r\n<span style='color:rgb(255, 119, 0);font-weight:bold;'>class<\/span> BlogCrawlItem(ScrapedItem):\r\n    <span style='color:rgb(255, 119, 0);font-weight:bold;'>def<\/span> <span style='color:rgb(0, 0, 205);'>__init__<\/span>(<span style='color:rgb(0, 128, 0);'>self<\/span>):\r\n        ScrapedItem.<span style='color:rgb(0, 0, 205);'>__init__<\/span>(<span style='color:rgb(0, 128, 0);'>self<\/span>)\r\n        <span style='color:rgb(0, 128, 0);'>self<\/span>.url <span style='color:rgb(102, 204, 102);'>=<\/span> <span style='color:rgb(72, 61, 139);'>''<\/span>\r\n&nbsp;\r\n    <span style='color:rgb(255, 119, 0);font-weight:bold;'>def<\/span> <span style='color:rgb(0, 0, 205);'>__str__<\/span>(<span style='color:rgb(0, 128, 0);'>self<\/span>):\r\n        <span style='color:rgb(255, 119, 0);font-weight:bold;'>return<\/span> <span style='color:rgb(72, 61, 139);'>'BlogCrawlItem(url: %s)'<\/span> % <span style='color:rgb(0, 128, 0);'>self<\/span>.url<\/pre><\/td> \r\n    <\/tr> \r\n   <\/tbody> \r\n  <\/table> \r\n <\/div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u5b9a\u4e49\u4e86&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>__str__<\/code>&nbsp;\u51fd\u6570\uff0c\u53ea\u7ed9\u51fa URL \uff0c\u56e0\u4e3a\u9ed8\u8ba4\u7684&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>__str__<\/code>&nbsp;\u51fd\u6570\u4f1a\u628a\u6240\u6709\u7684\u6570\u636e\u90fd\u663e\u793a\u51fa\u6765\uff0c\u56e0\u6b64\u4f1a\u770b\u5230 crawl \u7684\u65f6\u5019\u63a7\u5236\u53f0 log \u72c2\u8f93\u51fa\u4e1c\u897f\uff0c\u90a3\u662f\u628a\u6293\u53d6\u5230\u7684\u7f51\u9875\u5185\u5bb9\u8f93\u51fa\u51fa\u6765\u4e86\u3002-.-bb<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u8fd9\u6837\u4e00\u6765\uff0c\u6570\u636e\u5c31\u53d6\u5230\u4e86\uff0c\u6700\u540e\u53ea\u5269\u4e0b\u5b58\u50a8\u6570\u636e\u7684\u529f\u80fd\uff0c\u6211\u4eec\u901a\u8fc7\u6dfb\u52a0\u4e00\u4e2a Pipeline \u6765\u5b9e\u73b0\uff0c\u7531\u4e8e Python \u5728\u6807\u51c6\u5e93\u91cc\u81ea\u5e26\u4e86 Sqlite3 \u7684\u652f\u6301\uff0c\u6240\u4ee5\u6211\u4f7f\u7528 Sqlite \u6570\u636e\u5e93\u6765\u5b58\u50a8\u6570\u636e\u3002\u7528\u5982\u4e0b\u4ee3\u7801\u66ff\u6362 pipelines.py \u7684\u5185\u5bb9\uff1a<\/p> \r\n <div style='background-color: rgb(249, 249, 249); color: rgb(17, 0, 0); font-family: tahoma, arial, sans-serif;'> \r\n  <table border='1' cellpadding='2' cellspacing='0' style='font-size: 1em;'> \r\n   <tbody> \r\n    <tr> \r\n     <td style='background-color:rgb(255, 255, 255);'><pre style='background-color: rgb(221, 238, 255) !important; color: gray !important; font-family: monospace !important;'>1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n13\r\n14\r\n15\r\n16\r\n17\r\n18\r\n19\r\n20\r\n21\r\n22\r\n23\r\n24\r\n25\r\n26\r\n27\r\n28\r\n29\r\n30\r\n31\r\n32\r\n33\r\n34\r\n35\r\n36\r\n37\r\n<\/pre><\/td> \r\n     <td style='background-color:rgb(255, 255, 255) !important;width:560px;'><pre style='font-family: monospace;'><span style='color:rgb(255, 119, 0);font-weight:bold;'>import<\/span> sqlite3\r\n<span style='color:rgb(255, 119, 0);font-weight:bold;'>from<\/span> <span style='color:rgb(220, 20, 60);'>os<\/span> <span style='color:rgb(255, 119, 0);font-weight:bold;'>import<\/span> path\r\n&nbsp;\r\n<span style='color:rgb(255, 119, 0);font-weight:bold;'>from<\/span> scrapy.core <span style='color:rgb(255, 119, 0);font-weight:bold;'>import<\/span> signals\r\n<span style='color:rgb(255, 119, 0);font-weight:bold;'>from<\/span> scrapy.xlib.pydispatch <span style='color:rgb(255, 119, 0);font-weight:bold;'>import<\/span> dispatcher\r\n&nbsp;\r\n<span style='color:rgb(255, 119, 0);font-weight:bold;'>class<\/span> SQLiteStorePipeline(<span style='color:rgb(0, 128, 0);'>object<\/span>):\r\n    filename <span style='color:rgb(102, 204, 102);'>=<\/span> <span style='color:rgb(72, 61, 139);'>'data.sqlite'<\/span>\r\n&nbsp;\r\n    <span style='color:rgb(255, 119, 0);font-weight:bold;'>def<\/span> <span style='color:rgb(0, 0, 205);'>__init__<\/span>(<span style='color:rgb(0, 128, 0);'>self<\/span>):\r\n        <span style='color:rgb(0, 128, 0);'>self<\/span>.conn <span style='color:rgb(102, 204, 102);'>=<\/span> <span style='color:rgb(0, 128, 0);'>None<\/span>\r\n        dispatcher.connect(<span style='color:rgb(0, 128, 0);'>self<\/span>.initialize<span style='color:rgb(102, 204, 102);'>,<\/span> signals.engine_started)\r\n        dispatcher.connect(<span style='color:rgb(0, 128, 0);'>self<\/span>.finalize<span style='color:rgb(102, 204, 102);'>,<\/span> signals.engine_stopped)\r\n&nbsp;\r\n    <span style='color:rgb(255, 119, 0);font-weight:bold;'>def<\/span> process_item(<span style='color:rgb(0, 128, 0);'>self<\/span><span style='color:rgb(102, 204, 102);'>,<\/span> domain<span style='color:rgb(102, 204, 102);'>,<\/span> item):\r\n        <span style='color:rgb(0, 128, 0);'>self<\/span>.conn.execute(<span style='color:rgb(72, 61, 139);'>'insert into blog values(?,?,?)'<\/span><span style='color:rgb(102, 204, 102);'>,<\/span> \r\n                          (item.url<span style='color:rgb(102, 204, 102);'>,<\/span> item.raw<span style='color:rgb(102, 204, 102);'>,<\/span> <span style='color:rgb(0, 128, 0);'>unicode<\/span>(domain)))\r\n        <span style='color:rgb(255, 119, 0);font-weight:bold;'>return<\/span> item\r\n&nbsp;\r\n    <span style='color:rgb(255, 119, 0);font-weight:bold;'>def<\/span> initialize(<span style='color:rgb(0, 128, 0);'>self<\/span>):\r\n        <span style='color:rgb(255, 119, 0);font-weight:bold;'>if<\/span> path.exists(<span style='color:rgb(0, 128, 0);'>self<\/span>.filename):\r\n            <span style='color:rgb(0, 128, 0);'>self<\/span>.conn <span style='color:rgb(102, 204, 102);'>=<\/span> sqlite3.connect(<span style='color:rgb(0, 128, 0);'>self<\/span>.filename)\r\n        <span style='color:rgb(255, 119, 0);font-weight:bold;'>else<\/span>:\r\n            <span style='color:rgb(0, 128, 0);'>self<\/span>.conn <span style='color:rgb(102, 204, 102);'>=<\/span> <span style='color:rgb(0, 128, 0);'>self<\/span>.create_table(<span style='color:rgb(0, 128, 0);'>self<\/span>.filename)\r\n&nbsp;\r\n    <span style='color:rgb(255, 119, 0);font-weight:bold;'>def<\/span> finalize(<span style='color:rgb(0, 128, 0);'>self<\/span>):\r\n        <span style='color:rgb(255, 119, 0);font-weight:bold;'>if<\/span> <span style='color:rgb(0, 128, 0);'>self<\/span>.conn <span style='color:rgb(255, 119, 0);font-weight:bold;'>is<\/span> <span style='color:rgb(255, 119, 0);font-weight:bold;'>not<\/span> <span style='color:rgb(0, 128, 0);'>None<\/span>:\r\n            <span style='color:rgb(0, 128, 0);'>self<\/span>.conn.commit()\r\n            <span style='color:rgb(0, 128, 0);'>self<\/span>.conn.close()\r\n            <span style='color:rgb(0, 128, 0);'>self<\/span>.conn <span style='color:rgb(102, 204, 102);'>=<\/span> <span style='color:rgb(0, 128, 0);'>None<\/span>\r\n&nbsp;\r\n    <span style='color:rgb(255, 119, 0);font-weight:bold;'>def<\/span> create_table(<span style='color:rgb(0, 128, 0);'>self<\/span><span style='color:rgb(102, 204, 102);'>,<\/span> filename):\r\n        conn <span style='color:rgb(102, 204, 102);'>=<\/span> sqlite3.connect(filename)\r\n        conn.execute(<span style='color:rgb(72, 61, 139);'>'''create table blog\r\n                     (url text primary key, raw text, domain text)'''<\/span>)\r\n        conn.commit()\r\n        <span style='color:rgb(255, 119, 0);font-weight:bold;'>return<\/span> conn<\/pre><\/td> \r\n    <\/tr> \r\n   <\/tbody> \r\n  <\/table> \r\n <\/div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u5728&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>__init__<\/code>&nbsp;\u51fd\u6570\u4e2d\uff0c\u4f7f\u7528 dispatcher \u5c06\u4e24\u4e2a\u4fe1\u53f7\u8fde\u63a5\u5230\u6307\u5b9a\u7684\u51fd\u6570\u4e0a\uff0c\u5206\u522b\u7528\u4e8e\u521d\u59cb\u5316\u548c\u5173\u95ed\u6570\u636e\u5e93\u8fde\u63a5\uff08\u5728&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>close<\/code>&nbsp;\u4e4b\u524d\u8bb0\u5f97&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>commit<\/code>&nbsp;\uff0c\u4f3c\u4e4e\u662f\u4e0d\u4f1a\u81ea\u52a8&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>commit<\/code>&nbsp;\u7684\uff0c\u76f4\u63a5&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>close<\/code>\u7684\u8bdd\u597d\u50cf\u6240\u6709\u7684\u6570\u636e\u90fd\u4e22\u5931\u4e86 dd-.-\uff09\u3002\u5f53\u6709\u6570\u636e\u7ecf\u8fc7 pipeline \u7684\u65f6\u5019\uff0c<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>process_item<\/code>&nbsp;\u51fd\u6570\u4f1a\u88ab\u8c03\u7528\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u8bb2\u539f\u59cb\u6570\u636e\u5b58\u50a8\u5230\u6570\u636e\u5e93\u4e2d\uff0c\u4e0d\u4f5c\u4efb\u4f55\u5904\u7406\u3002\u5982\u679c\u9700\u8981\u7684\u8bdd\uff0c\u53ef\u4ee5\u6dfb\u52a0\u989d\u5916\u7684 pipeline \uff0c\u5bf9\u6570\u636e\u8fdb\u884c\u63d0\u53d6\u3001\u8fc7\u6ee4\u7b49\uff0c\u8fd9\u91cc\u5c31\u4e0d\u7ec6\u8bf4\u4e86\u3002<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u6700\u540e\uff0c\u5728&nbsp;<code style='font-family:'Courier New', Courier, monospace;font-size:1em;'>settings.py<\/code>&nbsp;\u91cc\u5217\u51fa\u6211\u4eec\u7684 pipeline \uff1a<\/p> \r\n <div style='background-color: rgb(249, 249, 249); color: rgb(17, 0, 0); font-family: tahoma, arial, sans-serif;'> \r\n  <table border='1' cellpadding='2' cellspacing='0' style='font-size: 1em;'> \r\n   <tbody> \r\n    <tr> \r\n     <td style='background-color:rgb(244, 244, 244);width:584px;'><pre style='font-family: monospace;'>ITEM_PIPELINES <span style='color:rgb(102, 204, 102);'>=<\/span> [<span style='color:rgb(72, 61, 139);'>'blog_crawl.pipelines.SQLiteStorePipeline'<\/span>]<\/pre><\/td> \r\n    <\/tr> \r\n   <\/tbody> \r\n  <\/table> \r\n <\/div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'>\u518d\u8dd1\u4e00\u4e0b crawler \uff0c\u5c31 OK \u5566\uff01&nbsp;<img src='http:\/\/note.youdao.com\/yws\/res\/1928\/CFD348C51A1548B2964C9FBBE5F6A302' alt=':D' data-media-type='image'>&nbsp;\u6700\u540e\uff0c\u603b\u7ed3\u4e00\u4e0b\uff1a\u4e00\u4e2a\u9ad8\u8d28\u91cf\u7684 crawler \u662f\u6781\u5176\u590d\u6742\u7684\u5de5\u7a0b\uff0c\u4f46\u662f\u5982\u679c\u6709\u597d\u7684\u5de5\u5177\u7684\u8bdd\uff0c\u505a\u4e00\u4e2a\u4e13\u7528\u7684 crawler \u8fd8\u662f\u6bd4\u8f83\u5bb9\u6613\u7684\u3002Scrapy \u662f\u4e00\u4e2a\u5f88\u8f7b\u4fbf\u7684\u722c\u866b\u6846\u67b6\uff0c\u6781\u5927\u5730\u7b80\u5316\u4e86 crawler \u5f00\u53d1\u7684\u8fc7\u7a0b\u3002\u53e6\u5916\uff0cScrapy \u7684\u6587\u6863\u4e5f\u662f\u5341\u5206\u8be6\u7ec6\u7684\uff0c\u5982\u679c\u89c9\u5f97\u6211\u7684\u4ecb\u7ecd\u7701\u7565\u4e86\u4e00\u4e9b\u4e1c\u897f\u4e0d\u592a\u6e05\u695a\u7684\u8bdd\uff0c\u63a8\u8350\u770b\u4ed6\u7684&nbsp;<a href='http:\/\/doc.scrapy.org\/intro\/tutorial.html' style='color: rgb(42, 99, 135);'>Tutorial<\/a>&nbsp;\u3002<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: tahoma, arial, sans-serif;'><small>\u6ce8\uff1a\u672c\u6587\u5f00\u59cb\u7684\u90a3\u5e45\u56fe\u5e76\u4e0d\u662f\u4e00\u4e2a spider \uff08\u5f53\u7136\u5566\uff01-,-bb\uff09\uff0c\u90a3\u662f\u51fa\u81ea\u52a8\u753b\u7247\u300a\u653b\u58f3\u673a\u52a8\u961f\u300b\u91cc\u7684\u601d\u8003\u6218\u8f66<a href='http:\/\/en.wikipedia.org\/wiki\/Tachikoma' style='color: rgb(42, 99, 135);'>Tachikoma<\/a>&nbsp;\uff08\u5f88\u53ef\u7231\u7684\uff01\uff09\u3002<\/small><\/p> \r\n<\/div>\r\n ","excerpt":"\u00a0\u7f51\u7edc\u722c\u866b\uff08WebCrawler,Spider\uff09\u5c31\u662f\u4e00\u4e2a\u5728\u7f51\u7edc\u4e0a\u4e71\u722c\u7684\u673a\u5668\u4eba\u3002\u5f53\u7136\u5b83\u901a\u5e38\u5e76\u4e0d\u662f\u4e00\u4e2a\u5b9e\u4f53\u7684\u673a\u5668\u4eba\uff0c\u56e0\u4e3a\u7f51\u7edc\u672c\u8eab\u4e5f\u662f\u865a\u62df\u7684\u4e1c\u897f\uff0c\u6240\u4ee5\u8fd9\u4e2a\u201c\u673a\u5668\u4eba\u201d\u5176\u5b9e\u4e5f\u5c31\u662f\u4e00\u6bb5\u7a0b\u5e8f\uff0c\u5e76\u4e14\u5b83\u4e5f\u4e0d\u662f\u4e71\u722c\uff0c\u800c\u662f\u6709\u4e00\u5b9a\u76ee\u7684\u7684\uff0c\u5e76\u4e14\u5728\u722c\u884c\u7684\u65f6\u5019\u4f1a\u641c\u96c6\u4e00\u4e9b\u4fe1\u606f\u3002\u4f8b\u5982Google\u5c31\u6709\u4e00\u5927\u5806\u722c\u866b\u4f1a\u5728Intern","author":"1","sortid":"19","type":"blog","views":"55","comnum":"0","tbcount":"0","attnum":"0","top":"n","hide":"n","allow_remark":"y","allow_tb":"y","password":"","thumb":"0","alias":""}