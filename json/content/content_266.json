{"gid":"266","title":"PHP\u6269\u5c55\u5f00\u53d1\u8fdb\u9636","date":"1426719600","content":"\r\n <div> \r\n <a href='http:\/\/blog.csdn.net\/heiyeshuwu\/article\/details\/44267021' style='background-color:rgb(255, 255, 255);color:rgb(51, 51, 51);font-family:'Microsoft YaHei';font-size:20px;font-style:normal;font-weight:normal;text-align:left;'><\/a><p style='font-family:sans-serif;font-size:16px;text-align:center;'><span style='font-family:\u5fae\u8f6f\u96c5\u9ed1;font-size:24px;'><strong><br>PHP<\/strong><\/span><span style='font-family:\u5fae\u8f6f\u96c5\u9ed1;font-size:24px;'><strong>\u6269\u5c55\u5f00\u53d1\u8fdb\u9636<\/strong><\/span><\/p><p style='font-family:sans-serif;font-size:16px;text-align:center;'><span style='font-family:\u5b8b\u4f53;font-size:15px;'><br>\u200b\u4f5c\u8005\uff1awf \uff08360\u7535\u5546\u6280\u672f\uff09<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5728\u7b2c\u4e00\u671fPHP\u6269\u5c55\u5f00\u53d1\u5165\u95e8\u4e2d,\u7b80\u5355\u7684\u4ecb\u7ecd\u4e86PHP\u7684\u6574\u4f53\u67b6\u6784\u548c\u8fd0\u884c\u673a\u5236,\u5e76\u8be6\u7ec6\u8bf4\u660e\u4e86\u5982\u4f55\u5f00\u53d1\u548c\u7f16\u8bd1\u4e00\u4e2a\u57fa\u672c\u7684PHP\u6269\u5c55,\u6700\u540e\u5728PHP&nbsp;5.3\u7684\u73af\u5883\u4e0b\u7ed3\u5408zend&nbsp;api\u5feb\u901f\u7f16\u5199\u4e86\u4e00\u4e2a\u9759\u6001\u7684PHP\u6269\u5c55.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u7136\u800c\u4ec5\u4ec5\u7f16\u8bd1\u4e00\u4e2aPHP\u6269\u5c55\u662f\u6ca1\u6709\u5b9e\u9645\u7528\u9014\u7684,\u5b83\u53ea\u662f\u4e00\u4e2a\u534e\u4e3d\u7684\u5916\u58f3,\u4e3a\u4e86\u4f7f\u6269\u5c55\u5b9e\u73b0\u66f4\u5f3a\u5927\u7684\u529f\u80fd,\u9700\u8981\u5728\u6269\u5c55\u4e2d\u5f00\u53d1\u4e00\u4e9b\u5b9e\u7528\u7684\u529f\u80fd\u51fd\u6570.\u5728\u8fd9\u4e00\u7ae0\u4e2d,\u5c06\u4f1a\u7740\u91cd\u4ecb\u7ecdPHP\u5185\u6838\u4e2d\u53d8\u91cf\u7684\u5b9e\u73b0.\u5728\u6b64\u57fa\u7840\u4e0a,\u624d\u80fd\u5c06\u9700\u8981\u7684\u529f\u80fd,\u4f7f\u7528zend&nbsp;api\u5728PHP\u6269\u5c55\u4e2d\u5b9e\u73b0.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:19px;'><strong>1&nbsp;PHP\u53d8\u91cf\u7684\u5b9e\u73b0<\/strong><\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'><strong>1.1\u53d8\u91cf\u7684\u7c7b\u578b<\/strong><\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>PHP\u5185\u6838\u4e2d\u901a\u8fc7zval\u7ed3\u6784\u4f53\u6765\u5b58\u50a8\u53d8\u91cf,\u5b9a\u4e49\u5728Zend\/zend.h\u6587\u4ef6\u91cc,\u53ea\u6709\u56db\u4e2a\u6210\u5458\uff1a<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>struct&nbsp;_zval_struct&nbsp;{<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>zvalue_value&nbsp;value;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>\/*&nbsp;\u53d8\u91cf\u7684\u503c&nbsp;*\/<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>zend_uint&nbsp;refcount__gc;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>zend_uchar&nbsp;type;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>\/*&nbsp;\u53d8\u91cf\u5f53\u524d\u7684\u6570\u636e\u7c7b\u578b&nbsp;*\/<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>zend_uchar&nbsp;is_ref__gc;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>};<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>typedef&nbsp;struct&nbsp;_zval_struct&nbsp;zval;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>\/\/\u5728Zend\/zend_types.h\u91cc\u5b9a\u4e49\u7684\uff1a<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>typedef&nbsp;unsigned&nbsp;int&nbsp;zend_uint;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>typedef&nbsp;unsigned&nbsp;char&nbsp;zend_uchar;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:12px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>zval\u91cc\u7684refcout__gc\u662fzend_uint\u7c7b\u578b,\u4e5f\u5c31\u662funsigned&nbsp;int\u578b,is_ref__gc\u548ctype\u5219\u662funsigned&nbsp;char\u578b\u7684.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u4fdd\u5b58\u53d8\u91cf\u503c\u7684value\u5219\u662fzvalue_value\u7c7b\u578b(PHP5),\u5b83\u662f\u4e00\u4e2aunion\u7ed3\u6784\u4f53,\u53ef\u4ee5\u8282\u7ea6\u5b58\u918b\u7a7a\u95f4,\u540c\u6837\u5b9a\u4e49\u5728\u4e86Zend\/zend.h\u6587\u4ef6\u91cc\uff1a<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>typedef&nbsp;union&nbsp;_zvalue_value&nbsp;{<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>long&nbsp;lval;&nbsp;&nbsp;\/*&nbsp;long&nbsp;value&nbsp;*\/<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>double&nbsp;dval;&nbsp;&nbsp;&nbsp;&nbsp;\/*&nbsp;double&nbsp;value&nbsp;*\/<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>struct&nbsp;{<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>char&nbsp;*val;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>int&nbsp;len;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>}&nbsp;str;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>HashTable&nbsp;*ht;&nbsp;&nbsp;\/*&nbsp;hash&nbsp;table&nbsp;value&nbsp;*\/<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>zend_object_value&nbsp;obj;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:14px;'>}&nbsp;zvalue_value;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5728\u4ee5\u4e0a\u57fa\u7840\u4e0a,PHP\u8bed\u8a00\u5b9e\u73b0\u4e868\u79cd\u6570\u636e\u7c7b\u578b,\u8fd9\u4e9b\u6570\u636e\u7c7b\u578b\u5728\u5185\u6838\u4e2d\u7684\u5206\u522b\u5bf9\u5e94\u4e8e\u7279\u5b9a\u7684\u5e38\u91cf,\u5b83\u4eec\u5206\u522b\u662f\uff1a<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>IS_NULL&nbsp;<\/span><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u7b2c\u4e00\u6b21\u4f7f\u7528\u7684\u53d8\u91cf\u5982\u679c\u6ca1\u6709\u521d\u59cb\u5316\u8fc7,\u5219\u4f1a\u81ea\u52a8\u7684\u88ab\u8d4b\u4e88\u8fd9\u4e2a\u5e38\u91cf.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>IS_BOOL<\/span><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5e03\u5c14\u53d8\u91cf,\u6709\u4e24\u4e2a\u503c,true\u6216\u8005false.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>IS_LONG<\/span><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u6574\u578b\u53d8\u91cf,\u5728\u5185\u6838\u4e2d\u662f\u901a\u8fc7\u6240\u5728\u64cd\u4f5c\u7cfb\u7edf\u7684signed&nbsp;long\u6570\u636e\u7c7b\u578b\u6765\u8868\u793a.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>IS_DOUBLE<\/span><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u6d6e\u70b9\u53d8\u91cf,\u901a\u8fc7C\u8bed\u8a00\u4e2d\u7684signed&nbsp;double\u578b\u53d8\u91cf\u6765\u5b58\u50a8\u7684.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>IS_STRING<\/span><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5b57\u7b26\u4e32,PHP\u6700\u5e38\u7528\u7684\u6570\u636e\u7c7b\u578b\u5728\u5185\u5b58\u4e2d\u7684\u5b58\u50a8\u548cC\u8bed\u8a00\u5dee\u4e0d\u591a,&nbsp;\u5728\u8fd9\u4e2a\u53d8\u91cf\u7684zval\u5b9e\u73b0\u91cc\u4f1a\u4fdd\u5b58\u7740\u6307\u5411\u8fd9\u5757\u5185\u5b58\u7684\u6307\u9488.\u4e0eC\u4e0d\u540c\u7684\u662f,PHP\u5185\u6838\u8fd8\u540c\u65f6\u5728zval\u7ed3\u6784\u91cc\u4fdd\u5b58\u7740\u8fd9\u4e2a\u5b57\u7b26\u4e32\u7684\u5b9e\u9645\u957f\u5ea6,&nbsp;\u8fd9\u4e2a\u8bbe\u8ba1\u4f7fPHP\u53ef\u4ee5\u5728\u5b57\u7b26\u4e32\u4e2d\u5d4c\u5165\u2018\\0\u2019\u5b57\u7b26,\u4e5f\u4f7fPHP\u7684\u5b57\u7b26\u4e32\u662f\u4e8c\u8fdb\u5236\u5b89\u5168\u7684,&nbsp;\u53ef\u4ee5\u5b89\u5168\u7684\u5b58\u50a8\u4e8c\u8fdb\u5236\u6570\u636e.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>IS_ARRAY<\/span><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u6570\u7ec4,\u7528\u6765\u5b58\u50a8\u590d\u5408\u6570\u636e\u7684.\u5728C\u8bed\u8a00\u4e2d,\u4e00\u4e2a\u6570\u7ec4\u53ea\u80fd\u627f\u8f7d\u4e00\u79cd\u7c7b\u578b\u7684\u6570\u636e,\u800cPHP\u8bed\u8a00\u4e2d\u7684\u6570\u7ec4\u5219\u7075\u6d3b\u7684\u591a,&nbsp;\u5b83\u53ef\u4ee5\u627f\u8f7d\u4efb\u610f\u7c7b\u578b\u7684\u6570\u636e,\u8fd9\u4e00\u5207\u90fd\u662fHashTable\u7684\u529f\u52b3,&nbsp;\u6bcf\u4e2aHashTable\u4e2d\u7684\u5143\u7d20\u90fd\u6709\u4e24\u90e8\u5206\u7ec4\u6210\uff1a\u7d22\u5f15\u4e0e\u503c,&nbsp;\u6bcf\u4e2a\u5143\u7d20\u7684\u503c\u90fd\u662f\u4e00\u4e2a\u72ec\u7acb\u7684zval.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>IS_OBJECT<\/span><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5bf9\u8c61,\u7528\u6765\u5b58\u50a8\u590d\u5408\u6570\u636e\u7684,\u4f46\u662f\u4e0e\u6570\u7ec4\u4e0d\u540c\u7684\u662f,&nbsp;\u5bf9\u8c61\u8fd8\u9700\u8981\u4fdd\u5b58\u4ee5\u4e0b\u4fe1\u606f\uff1a\u65b9\u6cd5,\u8bbf\u95ee\u6743\u9650,\u7c7b\u5e38\u91cf\u4ee5\u53ca\u5176\u5b83\u7684\u5904\u7406\u903b\u8f91.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>IS_RESOURCE<\/span><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u6709\u4e00\u4e9b\u6570\u636e\u7684\u5185\u5bb9\u65e0\u6cd5\u76f4\u63a5\u5448\u73b0\u7ed9PHP\u7528\u6237\u7684,&nbsp;\u6bd4\u5982\u4e0e\u67d0\u53f0mysql\u670d\u52a1\u5668\u7684\u94fe\u63a5.\u4f46\u7528\u6237\u8fd8\u9700\u8981\u8fd9\u7c7b\u6570\u636e,\u56e0\u6b64PHP\u4e2d\u63d0\u4f9b\u4e86\u4e00\u79cd\u540d\u4e3aResource(\u8d44\u6e90)\u7684\u6570\u636e\u7c7b\u578b.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>zval\u7ed3\u6784\u4f53\u91cc\u7684type\u6210\u5458\u7684\u503c\u4fbf\u662f\u4ee5\u4e0a\u67d0\u4e2aIS_*\u5e38\u91cf\u4e4b\u4e00.\u5185\u6838\u901a\u8fc7\u68c0\u6d4b\u53d8\u91cf\u7684\u8fd9\u4e2a\u6210\u5458\u503c\u6765\u77e5\u9053\u4ed6\u662f\u4ec0\u4e48\u7c7b\u578b\u7684\u6570\u636e\u5e76\u505a\u76f8\u5e94\u7684\u540e\u7eed\u5904\u7406.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5982\u679c\u8981\u68c0\u6d4b\u4e00\u4e2a\u53d8\u91cf\u7684\u7c7b\u578b,zend\u5934\u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e86\u5927\u91cf\u7684\u5b8f,\u4f9b\u68c0\u6d4b\u548c\u64cd\u4f5c\u53d8\u91cf\u4f7f\u7528,&nbsp;\u4f7f\u7528\u8fd9\u4e9b\u5b8f\u4e0d\u4f46\u8ba9\u7684\u7a0b\u5e8f\u66f4\u6613\u8bfb,\u8fd8\u5177\u6709\u66f4\u597d\u7684\u517c\u5bb9\u6027.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u4ee5_P\u4e00\u4e2ap\u7ed3\u5c3e\u7684\u5b8f\u7684\u53c2\u6570\u5927\u591a\u662f*zval\u578b\u53d8\u91cf.\u6b64\u5916\u83b7\u53d6\u53d8\u91cf\u7c7b\u578b\u7684\u5b8f\u8fd8\u6709\u4e24\u4e2a,\u5206\u522b\u662fZ_TYPE\u548cZ_TYPE_PP,\u524d\u8005\u7684\u53c2\u6570\u662fzval\u578b,\u800c\u540e\u8005\u7684\u53c2\u6570\u5219\u662f**zval.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>PHP\u5185\u6838\u5982\u4e0b\u5b9e\u73b0gettype\u8fd9\u4e2a\u51fd\u6570\u4e86\uff1a<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>\/\/<span style='font-family:\u5b8b\u4f53;'>\u5f00\u59cb\u5b9a\u4e49<\/span>PHP<span style='font-family:\u5b8b\u4f53;'>\u8bed\u8a00\u4e2d\u7684\u51fd\u6570<\/span>gettype<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>PHP_FUNCTION(gettype)<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>{<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>\/\/<span style='font-family:\u5b8b\u4f53;'>\u8fd9\u4e2a<\/span>arg<span style='font-family:\u5b8b\u4f53;'>\u95f4\u63a5\u6307\u5411\u5c31\u662f\u4f20\u7ed9<\/span>gettype<span style='font-family:\u5b8b\u4f53;'>\u51fd\u6570\u7684\u53c2\u6570<\/span>.<span style='font-family:\u5b8b\u4f53;'>\u662f\u4e00\u4e2a<\/span>zval**<span style='font-family:\u5b8b\u4f53;'>\u7ed3\u6784<\/span><\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>\/\/<span style='font-family:\u5b8b\u4f53;'>\u6240\u4ee5\u8981\u5bf9\u4ed6\u4f7f\u7528<\/span>__PP<span style='font-family:\u5b8b\u4f53;'>\u540e\u7f00\u7684\u5b8f<\/span>.<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>zval&nbsp;**arg;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>\/\/<span style='font-family:\u5b8b\u4f53;'>\u8fd9\u4e2a<\/span>if<span style='font-family:\u5b8b\u4f53;'>\u7684\u64cd\u4f5c\u4e3b\u8981\u662f\u8ba9<\/span>arg<span style='font-family:\u5b8b\u4f53;'>\u6307\u5411\u53c2\u6570\uff5e<\/span><\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>if&nbsp;(zend_parse_parameters(ZEND_NUM_ARGS()&nbsp;TSRMLS_CC,&nbsp;'Z',&nbsp;&amp;arg)&nbsp;==&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>FAILURE)&nbsp;return;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>\/\/<span style='font-family:\u5b8b\u4f53;'>\u8c03\u7528<\/span>Z_TYPE_PP<span style='font-family:\u5b8b\u4f53;'>\u5b8f\u6765\u83b7\u53d6<\/span>arg<span style='font-family:\u5b8b\u4f53;'>\u6307\u5411<\/span>zval<span style='font-family:\u5b8b\u4f53;'>\u7684\u7c7b\u578b<\/span>.<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>\/\/<span style='font-family:\u5b8b\u4f53;'>\u7136\u540e\u662f\u4e00\u4e2a<\/span>switch<span style='font-family:\u5b8b\u4f53;'>\u7ed3\u6784<\/span>,RETVAL_STRING<span style='font-family:\u5b8b\u4f53;'>\u5b8f\u4ee3\u8868\u8fd9<\/span>gettype<span style='font-family:\u5b8b\u4f53;'>\u51fd\u6570\u8fd4\u56de\u7684\u5b57\u7b26\u4e32\u7c7b\u578b\u7684\u503c<\/span><\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>switch&nbsp;(Z_TYPE_PP(arg))&nbsp;{<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>case&nbsp;IS_NULL:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>RETVAL_STRING('NULL',&nbsp;1);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>case&nbsp;IS_BOOL:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>RETVAL_STRING('boolean',&nbsp;1);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>case&nbsp;IS_LONG:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>RETVAL_STRING('integer',&nbsp;1);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>case&nbsp;IS_DOUBLE:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>RETVAL_STRING('double',&nbsp;1);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>case&nbsp;IS_STRING:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>RETVAL_STRING('string',&nbsp;1);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>case&nbsp;IS_ARRAY:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>RETVAL_STRING('array',&nbsp;1);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>case&nbsp;IS_OBJECT:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>RETVAL_STRING('object',&nbsp;1);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>case&nbsp;IS_RESOURCE:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>{<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>char&nbsp;*type_name;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>type_name&nbsp;=&nbsp;zend_rsrc_list_get_rsrc_type(Z_LVAL_PP(arg)&nbsp;TSRMLS_CC);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>if&nbsp;(type_name)&nbsp;{<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>RETVAL_STRING('resource',&nbsp;1);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>}<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>}<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>default:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>RETVAL_STRING('unknown&nbsp;type',&nbsp;1);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>}<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Arial;font-size:14px;'>}<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><br><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u4ee5\u4e0a\u4e09\u4e2a\u5b8f\u7684\u5b9a\u4e49\u5728Zend\/zend_operators.h\u91cc,\u5b9a\u4e49\u5206\u522b\u662f\uff1a<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:Arial;font-size:14px;'>#define&nbsp;Z_TYPE(zval)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(zval).type<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:Arial;font-size:14px;'>#define&nbsp;Z_TYPE_P(zval_p)&nbsp;&nbsp;&nbsp;&nbsp;Z_TYPE(*zval_p)<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:Arial;font-size:14px;'>#define&nbsp;Z_TYPE_PP(zval_pp)&nbsp;&nbsp;Z_TYPE(**zval_pp)<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'><strong>1.2&nbsp;\u53d8\u91cf\u7684\u503c<\/strong><\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5185\u6838\u4e2d\u9488\u5bf9\u5177\u4f53\u7684\u6570\u636e\u7c7b\u578b\u5206\u522b\u5b9a\u4e49\u4e86\u76f8\u5e94\u7684\u5b8f.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5bf9IS_BOOL\u578b\u7684BVAL\u7ec4\u5408(Z_BVAL\u3001Z_BVAL_P\u3001Z_BVAL_PP).<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5bf9IS_DOUBLE\u7684DVAL\u7ec4\u5408(Z_DVAL\u3001ZDVAL_P\u3001ZDVAL_PP)\u7b49\u7b49.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>string\u578b\u53d8\u91cf\u6bd4\u8f83\u7279\u6b8a,\u56e0\u4e3a\u5185\u6838\u5728\u4fdd\u5b58String\u578b\u53d8\u91cf\u65f6,\u4e0d\u4ec5\u4fdd\u5b58\u4e86\u5b57\u7b26\u4e32\u7684\u503c,\u8fd8\u4fdd\u5b58\u4e86\u5b83\u7684\u957f\u5ea6,&nbsp;\u6240\u4ee5\u5b83\u6709\u5bf9\u5e94\u7684\u4e24\u79cd\u5b8f\u7ec4\u5408STRVAL\u548cSTRLEN,\u5373\uff1aZ_STRVAL\u3001Z_STRVAL_P\u3001Z_STRVAL_PP\u4e0eZ_STRLEN\u3001Z_STRLEN_P\u3001Z_STRLEN_PP.\u524d\u4e00\u79cd\u5b8f\u8fd4\u56de\u7684\u662fchar&nbsp;*\u578b,\u5373\u5b57\u7b26\u4e32\u7684\u5730\u5740\uff1b\u540e\u4e00\u79cd\u8fd4\u56de\u7684\u662fint\u578b,\u5373\u5b57\u7b26\u4e32\u7684\u957f\u5ea6.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>Array\u578b\u53d8\u91cf\u7684\u503c\u5176\u5b9e\u662f\u5b58\u50a8\u5728C\u8bed\u8a00\u5b9e\u73b0\u7684HashTable\u4e2d\u7684,&nbsp;\u53ef\u4ee5\u7528ARRVAL\u7ec4\u5408\u5b8f\uff08Z_ARRVAL,&nbsp;Z_ARRVAL_P,&nbsp;Z_ARRVAL_PP\uff09\u8fd9\u4e09\u4e2a\u5b8f\u6765\u8bbf\u95ee\u6570\u7ec4\u7684\u503c.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5bf9,\u4e0d\u4ec5\u5b58\u50a8\u5c5e\u6027\u7684\u5b9a\u4e49\u548c\u5c5e\u6027\u7684\u503c,\u8fd8\u5b58\u50a8\u7740\u8bbf\u95ee\u6743\u9650\u548c\u65b9\u6cd5\u7b49\u4fe1\u606f.\u5185\u6838\u4e2d\u5b9a\u4e49\u4e86\u4ee5\u4e0b\u7ec4\u5408\u5b8f\u8ba9\u65b9\u4fbf\u7684\u64cd\u4f5c\u5bf9\u8c61.OBJ_HANDLE\uff1a\u8fd4\u56dehandle\u6807\u8bc6\u7b26.OBJ_HT\uff1ahandle\u8868.OBJCE\uff1a\u7c7b\u5b9a\u4e49.OBJPROP\uff1aHashTable\u7684\u5c5e\u6027.OBJ_HANDLER\uff1a\u5728OBJ_HT\u4e2d\u64cd\u4f5c\u4e00\u4e2a\u7279\u6b8a\u7684handler\u65b9\u6cd5.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u8d44\u6e90\u578b\u53d8\u91cf\u7684\u503c\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u6574\u6570,\u53ef\u4ee5\u7528RESVAL\u7ec4\u5408\u5b8f\u6765\u8bbf\u95ee\u5b83,\u628a\u5b83\u7684\u503c\u4f20\u7ed9zend_fetch_resource\u51fd\u6570,\u4fbf\u53ef\u4ee5\u5f97\u5230\u8fd9\u4e2a\u8d44\u6e90\u7684\u64cd\u4f5c\u53e5\u67c4,\u5982mysql\u7684\u94fe\u63a5\u53e5\u67c4\u7b49.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u6709\u5173\u503c\u64cd\u4f5c\u7684\u5b8f\u90fd\u5b9a\u4e49\u5728.\/Zend\/zend_operators.h\u6587\u4ef6\u91cc.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'><strong>1.3\u521b\u5efaPHP\u53d8\u91cf<\/strong><\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5728\u7f16\u5199\u4ee3\u7801\u7684\u65f6\u5019,\u901a\u8fc7\u5728\u5185\u6838\u4e2d\u521b\u5efazval\u53d8\u91cf\u53ef\u4ee5\u8ba9\u7528\u6237\u5728PHP\u8bed\u8a00\u91cc\u4ee5\u53d8\u91cf\u7684\u5f62\u5f0f\u4f7f\u7528.\u6700\u5bb9\u6613\u60f3\u5230\u7684\u529e\u6cd5\u4fbf\u662f\u521b\u5efa\u4e00\u4e2azval\u6307\u9488,&nbsp;\u7136\u540e\u7533\u8bf7\u4e00\u5757\u5185\u5b58\u5e76\u8ba9\u6307\u9488\u6307\u5411\u5b83.\u5185\u6838\u7ed9\u63d0\u4f9b\u4e86\u76f8\u5e94\u7684\u5b8f\u6765\u5904\u7406\u8fd9\u4ef6\u4e8b,\u8fd9\u4e2a\u5b8f\u7684\u662f\uff1aMAKE_STD_ZVAL(pzv).\u8fd9\u4e2a\u5b8f\u4f1a\u7528\u5185\u6838\u7684\u65b9\u5f0f\u6765\u7533\u8bf7\u4e00\u5757\u5185\u5b58\u5e76\u5c06\u5176\u5730\u5740\u4ed8\u7ed9pzv,&nbsp;\u5e76\u521d\u59cb\u5316\u5b83\u7684refcount\u548cis_ref\u4e24\u4e2a\u5c5e\u6027,\u66f4\u68d2\u7684\u662f,\u5b83\u4e0d\u4f46\u4f1a\u81ea\u52a8\u7684\u5904\u7406\u5185\u5b58\u4e0d\u8db3\u95ee\u9898,&nbsp;\u8fd8\u4f1a\u5728\u5185\u5b58\u4e2d\u9009\u4e2a\u6700\u4f18\u7684\u4f4d\u7f6e\u6765\u7533\u8bf7.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u9664\u4e86MAKE_STD_ZVAL()\u5b8f\u51fd\u6570,ALLOC_INIT_ZVAL()\u5b8f\u51fd\u6570\u4e5f\u662f\u7528\u6765\u5e72\u8fd9\u4ef6\u4e8b\u7684,&nbsp;\u552f\u4e00\u7684\u4e0d\u540c\u4fbf\u662f\u5b83\u4f1a\u5c06pzv\u6240\u6307\u7684zval\u7684\u7c7b\u578b\u8bbe\u7f6e\u4e3aIS_NULL;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u7533\u8bf7\u5b8c\u7a7a\u95f4\u540e,\u4fbf\u53ef\u4ee5\u7ed9\u8fd9\u4e2azval\u8d4b\u503c\u4e86.\u57fa\u4e8e\u5df2\u7ecf\u4ecb\u7ecd\u7684\u5b8f,&nbsp;\u4e5f\u8bb8\u9700\u8981Z_TYPE_P(p)&nbsp;=&nbsp;IS_NULL\u6765\u8bbe\u7f6e\u5176\u662fnull\u7c7b\u578b,\u5e76\u8fc7Z_SOMEVAL\u5f62\u5f0f\u7684\u5b8f\u6765\u4e3a\u5b83\u8d4b\u503c,&nbsp;\u4f46\u662f\u5185\u6838\u4e2d\u63d0\u4f9b\u4e00\u4e9b\u5b8f\u6765\u7b80\u5316\u7684\u64cd\u4f5c,\u53ef\u4ee5\u53ea\u7528\u4e00\u6b65\u4fbf\u8bbe\u7f6e\u597dzval\u7684\u7c7b\u578b\u548c\u503c.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:Arial;font-size:14px;'>ZVAL_NULL(pvz);(IS_NULL<span style='font-family:\u5b8b\u4f53;'>\u578b\u4e0d\u7528\u8d4b\u503c<\/span>,<span style='font-family:\u5b8b\u4f53;'>\u56e0\u4e3a\u8fd9\u4e2a\u7c7b\u578b\u53ea\u6709\u4e00\u4e2a\u503c\u5c31\u662f<\/span>null)<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:Arial;font-size:14px;'>ZVAL_BOOL(pzv,&nbsp;b);(<span style='font-family:\u5b8b\u4f53;'>\u5c06<\/span>pzv<span style='font-family:\u5b8b\u4f53;'>\u6240\u6307\u7684<\/span>zval<span style='font-family:\u5b8b\u4f53;'>\u8bbe\u7f6e\u4e3a<\/span>IS_BOOL<span style='font-family:\u5b8b\u4f53;'>\u7c7b\u578b<\/span>,<span style='font-family:\u5b8b\u4f53;'>\u503c\u662f<\/span>b)<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:Arial;font-size:14px;'>ZVAL_TRUE(pzv);(<span style='font-family:\u5b8b\u4f53;'>\u5c06<\/span>pzv<span style='font-family:\u5b8b\u4f53;'>\u6240\u6307\u7684<\/span>zval<span style='font-family:\u5b8b\u4f53;'>\u8bbe\u7f6e\u4e3a<\/span>IS_BOOL<span style='font-family:\u5b8b\u4f53;'>\u7c7b\u578b<\/span>,<span style='font-family:\u5b8b\u4f53;'>\u503c\u662f<\/span>true)<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:Arial;font-size:14px;'>ZVAL_FALSE(pzv);(<span style='font-family:\u5b8b\u4f53;'>\u5c06<\/span>pzv<span style='font-family:\u5b8b\u4f53;'>\u6240\u6307\u7684<\/span>zval<span style='font-family:\u5b8b\u4f53;'>\u8bbe\u7f6e\u4e3a<\/span>IS_BOOL<span style='font-family:\u5b8b\u4f53;'>\u7c7b\u578b<\/span>,<span style='font-family:\u5b8b\u4f53;'>\u503c\u662f<\/span>false)<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:Arial;font-size:14px;'>ZVAL_LONG(pzv,&nbsp;l);(<span style='font-family:\u5b8b\u4f53;'>\u5c06<\/span>pzv<span style='font-family:\u5b8b\u4f53;'>\u6240\u6307\u7684<\/span>zval<span style='font-family:\u5b8b\u4f53;'>\u8bbe\u7f6e\u4e3a<\/span>IS_LONG<span style='font-family:\u5b8b\u4f53;'>\u7c7b\u578b<\/span>,<span style='font-family:\u5b8b\u4f53;'>\u503c\u662f<\/span>l)<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:Arial;font-size:14px;'>ZVAL_DOUBLE(pzv,&nbsp;d);(<span style='font-family:\u5b8b\u4f53;'>\u5c06<\/span>pzv<span style='font-family:\u5b8b\u4f53;'>\u6240\u6307\u7684<\/span>zval<span style='font-family:\u5b8b\u4f53;'>\u8bbe\u7f6e\u4e3a<\/span>IS_DOUBLE<span style='font-family:\u5b8b\u4f53;'>\u7c7b\u578b<\/span>,<span style='font-family:\u5b8b\u4f53;'>\u503c\u662f<\/span>d)<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:Arial;font-size:14px;'>ZVAL_STRINGL(pzv,str,len,dup);str<span style='font-family:\u5b8b\u4f53;'>\u548c<\/span>len<span style='font-family:\u5b8b\u4f53;'>\u4e24\u4e2a\u53c2\u6570\u5f88\u597d\u7406\u89e3<\/span>,<span style='font-family:\u5b8b\u4f53;'>\u56e0\u4e3a\u5185\u6838\u4e2d\u4fdd\u5b58\u4e86\u5b57\u7b26\u4e32\u7684\u5730\u5740\u548c\u5b83\u7684\u957f\u5ea6<\/span>,&nbsp;<span style='font-family:\u5b8b\u4f53;'>\u540e\u9762\u7684<\/span>dup<span style='font-family:\u5b8b\u4f53;'>\u7684\u610f\u601d\u5176\u5b9e\u5f88\u7b80\u5355<\/span>,<span style='font-family:\u5b8b\u4f53;'>\u5b83\u6307\u660e\u4e86\u8be5\u5b57\u7b26\u4e32\u662f\u5426\u9700\u8981\u88ab\u590d\u5236<\/span>.<span style='font-family:\u5b8b\u4f53;'>\u503c\u4e3a<\/span>1&nbsp;<span style='font-family:\u5b8b\u4f53;'>\u5c06\u5148\u7533\u8bf7\u4e00\u5757\u65b0\u5185\u5b58\u5e76\u8d4b\u503c\u8be5\u5b57\u7b26\u4e32<\/span>,<span style='font-family:\u5b8b\u4f53;'>\u7136\u540e\u628a\u65b0\u5185\u5b58\u7684\u5730\u5740\u590d\u5236\u7ed9<\/span>pzv,&nbsp;<span style='font-family:\u5b8b\u4f53;'>\u4e3a<\/span>0<span style='font-family:\u5b8b\u4f53;'>\u65f6\u5219\u662f\u76f4\u63a5\u628a<\/span>str<span style='font-family:\u5b8b\u4f53;'>\u7684\u5730\u5740\u8d4b\u503c\u7ed9<\/span>zval.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:Arial;font-size:14px;'>ZVAL_RESOURCE<span style='font-family:\u5b8b\u4f53;'>\u7ea6\u7b49\u4e8e<\/span>ZVAL_LONG,PHP<span style='font-family:\u5b8b\u4f53;'>\u4e2d\u7684\u8d44\u6e90\u7c7b\u578b\u7684\u503c\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u6574\u6570<\/span>,<span style='font-family:\u5b8b\u4f53;'>\u6240\u4ee5<\/span>ZVAL_RESOURCE<span style='font-family:\u5b8b\u4f53;'>\u548c<\/span>ZVAL_LONG<span style='font-family:\u5b8b\u4f53;'>\u7684\u5de5\u4f5c\u5dee\u4e0d\u591a<\/span>,&nbsp;<span style='font-family:\u5b8b\u4f53;'>\u53ea\u4e0d\u8fc7\u5b83\u4f1a\u628a<\/span>zval<span style='font-family:\u5b8b\u4f53;'>\u7684\u7c7b\u578b\u8bbe\u7f6e\u4e3a&nbsp;<\/span>IS_RESOURCE.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'><strong>1.4\u53d8\u91cf\u7684\u5b58\u50a8\u65b9\u5f0f<\/strong><\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5f53\u7528\u6237\u5728PHP\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2a\u53d8\u91cf,\u5185\u6838\u4f1a\u81ea\u52a8\u7684\u628a\u5b83\u7684\u4fe1\u606f\u50a8\u5b58\u5230\u4e00\u4e2a\u7528HashTable\u5b9e\u73b0\u7684\u7b26\u53f7\u8868\u91cc.\u5168\u5c40\u4f5c\u7528\u57df\u7684\u7b26\u53f7\u8868\u662f\u5728\u8c03\u7528\u6269\u5c55\u7684RINIT\u65b9\u6cd5(\u4e00\u822c\u90fd\u662fMINIT\u65b9\u6cd5\u91cc)\u524d\u521b\u5efa\u7684,\u5e76\u5728RSHUTDOWN\u65b9\u6cd5\u6267\u884c\u540e\u81ea\u52a8\u9500\u6bc1.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5f53\u7528\u6237\u5728PHP\u4e2d\u8c03\u7528\u4e00\u4e2a\u51fd\u6570\u6216\u8005\u7c7b\u7684\u65b9\u6cd5\u65f6,\u5185\u6838\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7b26\u53f7\u8868\u5e76\u6fc0\u6d3b\u4e4b,&nbsp;\u8fd9\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48\u65e0\u6cd5\u5728\u51fd\u6570\u4e2d\u4f7f\u7528\u5728\u51fd\u6570\u5916\u5b9a\u4e49\u7684\u53d8\u91cf\u7684\u539f\u56e0&nbsp;(\u56e0\u4e3a\u5b83\u4eec\u5206\u5c5e\u4e24\u4e2a\u7b26\u53f7\u8868,\u4e00\u4e2a\u5f53\u524d\u4f5c\u7528\u57df\u7684,\u4e00\u4e2a\u5168\u5c40\u4f5c\u7528\u57df\u7684).\u5982\u679c\u4e0d\u662f\u5728\u4e00\u4e2a\u51fd\u6570\u91cc,\u5219\u5168\u5c40\u4f5c\u7528\u57df\u7684\u7b26\u53f7\u8868\u5904\u4e8e\u6fc0\u6d3b\u72b6\u6001.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5728Zend\/zend_globals.h\u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e86_zend_execution_globals\u7ed3\u6784\u4f53.<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>struct&nbsp;_zend_executor_globals&nbsp;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>{<\/span><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>...<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>HashTable&nbsp;symbol_table;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>HashTable&nbsp;*active_symbol_table;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>};<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5176\u4e2d\u7684&nbsp;symbol_table\u5143\u7d20\u53ef\u4ee5\u901a\u8fc7EG\u5b8f\u6765\u8bbf\u95ee,\u5b83\u4ee3\u8868\u7740PHP\u7684\u5168\u5c40\u53d8\u91cf,\u5982$GLOBALS,\u5b83\u662fEG(symbol_table)\u7684\u4e00\u5c42\u5c01\u88c5.\u4e0e\u4e4b\u5bf9\u5e94,\u4e0b\u9762\u7684active_symbol_table\u5143\u7d20\u4e5f\u53ef\u4ee5\u901a\u8fc7EG(active_symbol_table)\u7684\u65b9\u6cd5\u6765\u8bbf\u95ee,\u5b83\u4ee3\u8868\u7684\u662f\u5904\u4e8e\u5f53\u524d\u4f5c\u7528\u57df\u7684\u53d8\u91cf\u7b26\u53f7\u8868.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5176\u5b9e\u8fd9\u4e24\u4e2a\u6210\u5458\u5728_zend_executor_globals\u91cc\u867d\u7136\u90fd\u4ee3\u8868HashTable,&nbsp;\u4f46\u4e00\u4e2a\u662f\u771f\u6b63\u7684HashTable,\u800c\u53e6\u4e00\u4e2a\u662f\u4e00\u4e2a\u6307\u9488.\u5f53\u5728\u5bf9HashTable\u8fdb\u884c\u64cd\u4f5c\u7684\u65f6\u5019,\u5f80\u5f80\u662f\u628a\u5b83\u7684\u5730\u5740\u4f20\u9012\u7ed9\u4e00\u4e9b\u51fd\u6570.\u5982\u679c\u8981\u5bf9EG(symbol_table)\u7684\u7ed3\u679c\u8fdb\u884c\u64cd\u4f5c,\u5f80\u5f80\u9700\u8981\u5bf9\u5b83\u8fdb\u884c\u6c42\u5740\u64cd\u4f5c\u7136\u540e\u7528\u5b83\u7684\u5730\u5740\u4f5c\u4e3a\u88ab\u8c03\u7528\u51fd\u6570\u7684\u53c2\u6570.<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&lt;?php<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>$foo&nbsp;=&nbsp;'bar';<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>?&gt;&nbsp;&nbsp;&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u4e0a\u9762\u662f\u4e00\u6bb5PHP\u8bed\u8a00\u7684\u4f8b\u5b50,\u521b\u5efa\u4e86\u4e00\u4e2a\u53d8\u91cf,\u5e76\u628a\u5b83\u7684\u503c\u8bbe\u7f6e\u4e3a\u2019bar\u2019,\u5728\u4ee5\u540e\u7684\u4ee3\u7801\u4e2d\u4fbf\u53ef\u4ee5\u4f7f\u7528$foo\u53d8\u91cf.\u76f8\u540c\u7684\u529f\u80fd\u5728\u5185\u6838\u4e2d\u901a\u8fc7\u4e00\u4e0b\u5b9e\u73b0:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>{<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>zval&nbsp;*fooval;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>MAKE_STD_ZVAL(fooval);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>ZVAL_STRING(fooval,&nbsp;'bar',&nbsp;1);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>ZEND_SET_SYMBOL(&nbsp;EG(active_symbol_table)&nbsp;,&nbsp;&nbsp;'foo'&nbsp;,&nbsp;fooval);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>}&nbsp;&nbsp;&nbsp;&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u9996\u5148\u58f0\u660e\u4e00\u4e2azval\u6307\u9488,\u5e76\u7533\u8bf7\u4e00\u5757\u5185\u5b58.\u7136\u540e\u901a\u8fc7ZVAL_STRING\u5b8f\u5c06\u503c\u8bbe\u7f6e\u4e3a\u2019bar\u2019,\u6700\u540eZEND_SET_SYMBO\u7684\u4f5c\u7528\u5c31\u662f\u5c06\u8fd9\u4e2azval\u52a0\u5165\u5230\u5f53\u524d\u7684\u7b26\u53f7\u8868\u91cc\u53bb,\u5e76\u5c06\u5176label\u5b9a\u4e49\u6210foo,\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728PHP\u4ee3\u7801\u91cc\u901a\u8fc7$foo\u6765\u4f7f\u7528\u5b83\u4e86.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'><strong>1.4\u53d8\u91cf\u7684\u68c0\u7d22<\/strong><\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5728PHP\u5185\u6838\u4e2d\u53ef\u4ee5\u901a\u8fc7zend_hash_find()\u51fd\u6570\u6765\u627e\u5230\u5f53\u524d\u67d0\u4e2a\u4f5c\u7528\u57df\u4e0b\u7528\u6237\u5df2\u7ecf\u5b9a\u4e49\u597d\u7684\u53d8\u91cf,\u5b83\u662f\u5185\u6838\u63d0\u4f9b\u7684\u64cd\u4f5cHashTable\u7684API\u4e4b\u4e00.<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>{<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;zval&nbsp;**fooval;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(zend_hash_find(<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EG(active_symbol_table),&nbsp;\/\/\u8fd9\u4e2a\u53c2\u6570\u662f\u5730\u5740<span style='font-family:Consolas;'>,<\/span>\u5982\u679c\u64cd\u4f5c\u5168\u5c40\u4f5c\u7528\u57df<span style='font-family:Consolas;'>,<\/span>\u5219\u9700\u8981<span style='font-family:Consolas;'>&amp;EG(symbol_table)<\/span><\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'foo',<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof('foo'),<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(void**)&amp;fooval<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;==&nbsp;SUCCESS<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;)<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;{<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;php_printf('\u6210\u529f\u53d1\u73b0<span style='font-family:Consolas;'>$foo!');<\/span><\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;}<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;else<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;{<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;php_printf('\u5f53\u524d\u4f5c\u7528\u57df\u4e0b\u65e0\u6cd5\u53d1\u73b0<span style='font-family:Consolas;'>$foo.');<\/span><\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;}<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>}&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u9996\u5148\u5b9a\u4e49\u4e86\u4e00\u4e2a\u6307\u5411\u6307\u9488\u7684\u6307\u9488,\u7136\u540e\u901a\u8fc7zend_hash_find\u53bbEG(active_symbol_table)\u4f5c\u7528\u57df\u4e0b\u5bfb\u627e\u540d\u79f0\u4e3afoo($foo)\u7684\u53d8\u91cf,&nbsp;\u5982\u679c\u6210\u529f\u627e\u5230,\u6b64\u51fd\u6570\u5c06\u8fd4\u56deSUCCESS.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5185\u6838\u5b9a\u4e49HashTable\u8fd9\u4e2a\u7ed3\u6784,\u5e76\u4e0d\u662f\u5355\u5355\u7528\u6765\u50a8\u5b58PHP\u8bed\u8a00\u91cc\u7684\u53d8\u91cf\u7684,&nbsp;\u5176\u5b83\u5f88\u591a\u5730\u65b9\u90fd\u5728\u5e94\u7528HashTable.\u4e00\u4e2aHashTable\u6709\u5f88\u591a\u5143\u7d20,\u5728\u5185\u6838\u91cc\u53eb\u505abucket.\u7136\u800c\u6bcf\u4e2abucket\u7684\u5927\u5c0f\u662f\u56fa\u5b9a\u7684,&nbsp;\u6240\u4ee5\u5982\u679c\u60f3\u5728bucket\u91cc\u5b58\u50a8\u4efb\u610f\u6570\u636e\u65f6,\u6700\u597d\u7684\u529e\u6cd5\u4fbf\u662f\u7533\u8bf7\u4e00\u5757\u5185\u5b58\u4fdd\u5b58\u6570\u636e,&nbsp;\u7136\u540e\u5728bucket\u91cc\u4fdd\u5b58\u5b83\u7684\u6307\u9488.\u4ee5zval&nbsp;*foo\u4e3a\u4f8b,&nbsp;\u5185\u6838\u4f1a\u5148\u7533\u8bf7\u4e00\u5757\u8db3\u591f\u4fdd\u5b58\u6307\u9488\u5185\u5b58\u6765\u4fdd\u5b58foo,\u6bd4\u5982\u8fd9\u5757\u5185\u5b58\u7684\u5730\u5740\u662fp,\u4e5f\u5c31\u662fp=&amp;foo,&nbsp;\u5e76\u5728bucket\u91cc\u4fdd\u5b58p,\u8fd9\u65f6\u4fbf\u660e\u767d\u4e86,p\u5176\u5b9e\u5c31\u662fzval**\u7c7b\u578b\u7684.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5982\u679czend_hash_find()\u51fd\u6570\u627e\u5230\u4e86\u9700\u8981\u7684\u6570\u636e,\u5b83\u5c06\u8fd4\u56deSUCCESS\u5e38\u91cf,&nbsp;\u5e76\u628a\u5b83\u7684\u5730\u5740\u8d4b\u7ed9\u5728\u8c03\u7528zend_hash_find()\u51fd\u6570\u4f20\u9012\u7684fooval\u53c2\u6570,&nbsp;\u4e5f\u5c31\u662f\u8bf4\u6b64\u65f6fooval\u5c31\u6307\u5411\u4e86\u8981\u627e\u7684\u6570\u636e.\u5982\u679c\u6ca1\u6709\u627e\u5230,\u90a3\u5b83\u4e0d\u4f1a\u5bf9fooval\u53c2\u6570\u505a\u4efb\u4f55\u4fee\u6539,\u5e76\u8fd4\u56deFAILURE\u5e38\u91cf.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u5c31\u53bb\u7b26\u53f7\u8868\u91cc\u627e\u53d8\u91cf\u800c\u8a00,SUCCESS\u548cFAILURE\u4ec5\u4ee3\u8868\u8fd9\u4e2a\u53d8\u91cf\u662f\u5426\u5b58\u5728\u800c\u5df2.<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'><strong>1.6\u7c7b\u578b\u8f6c\u6362<\/strong><\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u73b0\u5728\u5df2\u7ecf\u53ef\u4ee5\u4ece\u7b26\u53f7\u8868\u4e2d\u83b7\u53d6\u7528\u6237\u5728PHP\u8bed\u8a00\u91cc\u5b9a\u4e49\u7684\u53d8\u91cf\u4e86,\u4e5f\u5c31\u53ef\u4ee5\u5bf9\u53d8\u91cf\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\u4e86.C\u8bed\u8a00\u4e2d\u7684\u7c7b\u578b\u8f6c\u6362\u7ec6\u5219,\u8ba9\u4eba\u975e\u5e38\u5934\u75bc.\u4f46\u662f\u53d8\u91cf\u7684\u7c7b\u578b\u8f6c\u6362\u5c31\u662f\u5982\u6b64\u91cd\u8981,\u5982\u679c\u6ca1\u6709,\u90a3\u7684\u4ee3\u7801\u5c31\u4f1a\u662f\u4e0b\u9762\u8fd9\u6837\u4e86:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>void&nbsp;display_zval(zval&nbsp;*value)<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>{<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(Z_TYPE_P(value))&nbsp;{<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;IS_NULL:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/*&nbsp;\u5982\u679c\u662f<span style='font-family:Consolas;'>NULL,<\/span>\u5219\u4e0d\u8f93\u51fa\u4efb\u4f55\u4e1c\u897f&nbsp;<span style='font-family:Consolas;'>*\/<\/span><\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;IS_BOOL:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/*&nbsp;\u5982\u679c\u662f<span style='font-family:Consolas;'>bool<\/span>\u7c7b\u578b<span style='font-family:Consolas;'>,<\/span>\u5e76\u4e14<span style='font-family:Consolas;'>true,<\/span>\u5219\u8f93\u51fa<span style='font-family:Consolas;'>1,<\/span>\u5426\u5219\u4ec0\u4e48\u4e5f\u4e0d\u5e72&nbsp;<span style='font-family:Consolas;'>*\/<\/span><\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Z_BVAL_P(value))&nbsp;{<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;php_printf('1');<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;IS_LONG:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/*&nbsp;\u5982\u679c\u662f<span style='font-family:Consolas;'>long<\/span>\u6574\u578b<span style='font-family:Consolas;'>,<\/span>\u5219\u8f93\u51fa\u6570\u5b57\u5f62\u5f0f&nbsp;<span style='font-family:Consolas;'>*\/<\/span><\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;php_printf('%ld',&nbsp;Z_LVAL_P(value));<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;IS_DOUBLE:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/*&nbsp;\u5982\u679c\u662f<span style='font-family:Consolas;'>double<\/span>\u578b<span style='font-family:Consolas;'>,<\/span>\u5219\u8f93\u51fa\u6d6e\u70b9\u6570&nbsp;<span style='font-family:Consolas;'>*\/<\/span><\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;php_printf('%f',&nbsp;Z_DVAL_P(value));<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;IS_STRING:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/*&nbsp;\u5982\u679c\u662f<span style='font-family:Consolas;'>string<\/span>\u578b<span style='font-family:Consolas;'>,<\/span>\u5219\u4e8c\u8fdb\u5236\u5b89\u5168\u7684\u8f93\u51fa\u8fd9\u4e2a\u5b57\u7b26\u4e32&nbsp;<span style='font-family:Consolas;'>*\/<\/span><\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PHPWRITE(Z_STRVAL_P(value),&nbsp;Z_STRLEN_P(value));<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;IS_RESOURCE:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/*&nbsp;\u5982\u679c\u662f\u8d44\u6e90<span style='font-family:Consolas;'>,<\/span>\u5219\u8f93\u51fa<span style='font-family:Consolas;'>Resource&nbsp;#10&nbsp;<\/span>\u683c\u5f0f\u7684\u4e1c\u4e1c&nbsp;<span style='font-family:Consolas;'>*\/<\/span><\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;php_printf('Resource&nbsp;#%ld',&nbsp;Z_RESVAL_P(value));<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;IS_ARRAY:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/*&nbsp;\u5982\u679c\u662f<span style='font-family:Consolas;'>Array,<\/span>\u5219\u8f93\u51fa<span style='font-family:Consolas;'>Array5<\/span>\u4e2a\u5b57\u6bcd\uff01&nbsp;<span style='font-family:Consolas;'>*\/<\/span><\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;php_printf('Array');<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;IS_OBJECT:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;php_printf('Object');<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/*&nbsp;Should&nbsp;never&nbsp;happen&nbsp;in&nbsp;practice,<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;but&nbsp;it's&nbsp;dangerous&nbsp;to&nbsp;make&nbsp;assumptions<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*\/<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;php_printf('Unknown');<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;}<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>\u4e0a\u9762\u7684\u4ee3\u7801\u548c\u76f4\u63a5&lt;?php&nbsp;echo&nbsp;$foo;?&gt;\u8fd9\u4e2a\u7b80\u5355\u5230\u6781\u70b9\u7684php\u8bed\u53e5\u6765\u6bd4,\u5b9e\u5728\u662f\u592a\u590d\u6742\u4e86.\u4e3a\u6b64\u5185\u6838\u4e2d\u63d0\u4f9b\u4e86\u5f88\u591a\u4e13\u95e8\u7684\u51fd\u6570\u6765\u5e2e\u52a9\u5b9e\u73b0\u7c7b\u578b\u8f6c\u6362,\u8fd9\u4e00\u7c7b\u51fd\u6570\u6709\u4e00\u4e2a\u7edf\u4e00\u7684\u5f62\u5f0fconvert_to_*()<\/span><\/p><p style='font-family:sans-serif;font-size:16px;'><span style='font-family:\u5b8b\u4f53;font-size:14px;'>&nbsp;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:12px;'>\/\/\u5c06\u4efb\u610f\u7c7b\u578b\u7684<span style='font-family:Consolas;'>zval<\/span>\u8f6c\u6362\u6210\u5b57\u7b26\u4e32<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>void&nbsp;change_zval_to_string(zval&nbsp;*value)<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>{<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>&nbsp;&nbsp;&nbsp;&nbsp;<\/span><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>convert_to_string(value);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>}&nbsp;<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:\u5b8b\u4f53;font-size:12px;'>\/\/\u5176\u5b83\u57fa\u672c\u7684\u7c7b\u578b\u8f6c\u6362\u51fd\u6570<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>ZEND_API&nbsp;void&nbsp;convert_to_long(zval&nbsp;*op);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans-serif;font-size:16px;'><span style='color:rgb(51, 51, 51);font-family:Consolas;font-size:12px;'>ZEND_API&nbsp;void&nbsp;convert_to_double(zval&nbsp;*op);<\/span><\/p><p style='background-color:rgb(248, 248, 248);font-family:sans","excerpt":"\u00a0PHP\u6269\u5c55\u5f00\u53d1\u8fdb\u9636\u200b\u4f5c\u8005\uff1awf\uff08360\u7535\u5546\u6280\u672f\uff09\u5728\u7b2c\u4e00\u671fPHP\u6269\u5c55\u5f00\u53d1\u5165\u95e8\u4e2d,\u7b80\u5355\u7684\u4ecb\u7ecd\u4e86PHP\u7684\u6574\u4f53\u67b6\u6784\u548c\u8fd0\u884c\u673a\u5236,\u5e76\u8be6\u7ec6\u8bf4\u660e\u4e86\u5982\u4f55\u5f00\u53d1\u548c\u7f16\u8bd1\u4e00\u4e2a\u57fa\u672c\u7684PHP\u6269\u5c55,\u6700\u540e\u5728PHP5.3\u7684\u73af\u5883\u4e0b\u7ed3\u5408zendapi\u5feb\u901f\u7f16\u5199\u4e86\u4e00\u4e2a\u9759\u6001\u7684PHP\u6269\u5c55.\u7136\u800c\u4ec5\u4ec5\u7f16\u8bd1\u4e00\u4e2aPHP\u6269\u5c55\u662f\u6ca1\u6709\u5b9e\u9645\u7528\u9014\u7684,\u5b83\u53ea\u662f","author":"1","sortid":"19","type":"blog","views":"73","comnum":"0","tbcount":"0","attnum":"0","top":"n","hide":"n","allow_remark":"y","allow_tb":"y","password":"","thumb":"0","alias":""}