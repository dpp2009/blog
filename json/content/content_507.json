{"gid":"507","title":"\u5feb\u901f\u5f00\u53d1\u4e00\u4e2aPHP\u6269\u5c55","date":"1405288800","content":"\r\n <div> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial; font-size: 20pt;'><font color='#993300'><strong>\u5feb\u901f\u5f00\u53d1\u4e00\u4e2aPHP\u6269\u5c55<\/strong><\/font><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><em>\u4f5c\u8005\uff1aheiyeluren<br>\u65f6\u95f4\uff1a2008-12-5<br>\u535a\u5ba2\uff1a<\/em><a href='http:\/\/blog.csdn.net\/heiyeshuwu' style='color:rgb(255, 153, 0);'><em>http:\/\/blog.csdn.net\/heiyeshuwu<\/em><\/a><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><br>\u672c\u6587\u901a\u8fc7\u975e\u5e38\u5feb\u901f\u7684\u65b9\u5f0f\u8bb2\u89e3\u4e86\u5982\u4f55\u5236\u4f5c\u4e00\u4e2aPHP 5.2 \u73af\u5883\u7684\u6269\u5c55\uff08PHP Extension\uff09\uff0c\u5e0c\u671b\u80fd\u591f\u5728\u56fe\u6587\u7684\u65b9\u5f0f\u4e0b\u8ba9\u60f3\u5feb\u901f\u5b66\u4e60\u7684\u670b\u53cb\u4e86\u89e3\u4e00\u4e0b\u5236\u4f5c\u8fc7\u7a0b\u3002<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><br><strong>\u9700\u6c42\uff1a<\/strong>\u6bd4\u5982\u5f00\u53d1\u4e00\u4e2a\u53eb\u505a heiyeluren&nbsp; \u7684\u6269\u5c55\uff0c\u6269\u5c55\u91cc\u5c31\u4e00\u4e2a\u51fd\u6570 heiyeluren_test()\uff0c\u8f93\u5165\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u51fd\u6570\u8fd4\u56de\uff1aYour input string: xxxxx\u3002<br><strong>\u8981\u6c42\uff1a<\/strong>\u4e86\u89e3C\/C++\u7f16\u7a0b\uff0c\u719f\u6089PHP\u7f16\u7a0b<br><strong>\u73af\u5883\uff1a<\/strong>\u4e0b\u8f7d\u4e00\u4efdphp\u5bf9\u5e94\u7248\u672c\u7684\u6e90\u7801\uff0c\u6211\u8fd9\u91cc\u662f php-5.2.6\uff0c\u5148\u6b63\u5e38\u5b89\u88c5php\uff0c\u5047\u8bbe\u6211\u4eec\u7684php\u5b89\u88c5\u5728 \/usr\/local\/php \u76ee\u5f55\uff0c\u6e90\u7801\u5728 \/root\/soft\/php\/php-5.2.6\/\uff0c\u73b0\u5728\u5f00\u59cb\uff01<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><br><strong style='font-size:12pt;'><font color='#993300'>\u6b65\u9aa4\u4e00\uff1a\u751f\u6210\u6269\u5c55\u6846\u67b6<\/font><\/strong><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><br><font color='#993300'>cd \/root\/soft\/php\/php-5.2.6\/ext<br>.\/ext_skel --extname=heiyeluren<br>cd \/root\/soft\/php\/php-5.2.6\/ext\/heiyeluren<br>vi config.m4<br><\/font>\u6253\u5f00\u6587\u4ef6\u540e\u53bb\u6389 dnl \uff0c\u83b7\u5f97\u4e0b\u9762\u7684\u4fe1\u606f\uff1a<br><font color='#008000'>PHP_ARG_ENABLE(heiyeluren, whether to enable heiyeluren support,<br>[&nbsp; --enable-heiyeluren&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Enable heiyeluren support])<\/font><br>\u4fdd\u5b58\u9000\u51fa.<br>(\u56fe01)<br><img src='http:\/\/note.youdao.com\/yws\/res\/538\/86AA942710AA40C1A046AEF82108B0F7' data-media-type='image'><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial; font-size: 12pt;'><strong><font color='#993300'>\u7b2c\u4e8c\u6b65\uff1a\u7f16\u5199\u4ee3\u7801<br><\/font><\/strong><br><font color='#993300'>vi php_heiyeluren.h<\/font><br>\u627e\u5230\uff1aPHP_FUNCTION(confirm_heiyeluren_compiled); \uff0c\u65b0\u589e\u4e00\u884c\uff1a<br><font color='#008000'>PHP_FUNCTION(heiyeluren_test);<\/font>&nbsp;<br>\u4fdd\u5b58\u9000\u51fa\u3002<br>(\u56fe02)<br><img src='http:\/\/note.youdao.com\/yws\/res\/540\/91CE348CAB2941819A7F769935F15A8F' data-media-type='image'><br><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><br><font color='#993300'>vi heiyeluren.c<\/font><br>\u6570\u7ec4\u91cc\u589e\u52a0\u6211\u4eec\u7684\u51fd\u6570\uff0c\u627e\u5230 zend_function_entry heiyeluren_functions[]\uff0c\u589e\u52a0\uff1a<br><font color='#008000'>PHP_FE(heiyeluren, NULL)<\/font><br>(\u56fe03)<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><img src='http:\/\/note.youdao.com\/yws\/res\/542\/C36F5FAEB4EE47969B678AFD4BC7BC93' data-media-type='image'><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u518d\u5230 heiyeluren.c \u6587\u4ef6\u6700\u540e\u9762\u589e\u52a0\u5982\u4e0b\u4ee3\u7801\uff1a<br><font color='#008000'>PHP_FUNCTION(heiyeluren_test)<br>{<br>&nbsp;&nbsp;&nbsp; char *arg = NULL;<br>&nbsp;&nbsp;&nbsp; int arg_len, len;<br>&nbsp;&nbsp;&nbsp; char *strg;<\/font><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><font color='#008000'>&nbsp;&nbsp;&nbsp; if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, 's', &amp;arg, &amp;arg_len) == FAILURE) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return;<br>&nbsp;&nbsp;&nbsp; }<\/font><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><font color='#008000'>&nbsp;&nbsp;&nbsp; len = spprintf(&amp;strg, 0, 'Your input string: %s\/n', arg);<br>&nbsp;&nbsp;&nbsp; RETURN_STRINGL(strg, len, 0);<br>}<br><\/font>\u4fdd\u5b58\u9000\u51fa\u3002<br>(\u56fe04)<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><img src='http:\/\/note.youdao.com\/yws\/res\/541\/9F685B8569E346F59EADBC93914A2210' data-media-type='image'><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><strong style='font-size:12pt;'><font color='#993300'>\u7b2c\u4e09\u6b65\uff1a\u7f16\u8bd1\u5b89\u88c5<br><\/font><\/strong><br><font color='#993300'>cd \/root\/soft\/php\/php-5.2.6\/ext\/heiyeluren<br>\/usr\/local\/php\/bin\/phpize<br>.\/configure --with-php-config=\/usr\/local\/php\/bin\/php-config<br>make<br>make test<br>make install<\/font><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u73b0\u5728\u770b\u770b\u662f\u4e0d\u662f\u6709\u4e2a \/usr\/local\/php\/lib\/php\/extensions\/no-debug-non-zts-20060613\/heiyeluren.so<br>\u7f16\u8f91php.ini\uff0c\u628a\u6269\u5c55\u52a0\u5165\u8fdb\u53bb\uff1a<br><font color='#993300'>vi \/usr\/local\/php\/lib\/php.ini<\/font><br>\u5728[PHP]\u6a21\u5757\u4e0b\u589e\u52a0\uff1a<br><font color='#008000'>extension = heiyeluren.so<\/font><br>\u4fdd\u5b58\u9000\u51fa\u3002<br>(\u56fe05)<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><img src='http:\/\/note.youdao.com\/yws\/res\/537\/21F4F0144BAB4DFFBC9C020DC5FA0769' data-media-type='image'><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u6ce8\u610f\uff1a\u5982\u679c\u4f60\u4e0d\u5b58\u5728\u6269\u5c55\u6587\u4ef6\u76ee\u5f55\uff0c\u6216\u8005\u5b89\u88c5\u62a5\u9519\uff0c\u90a3\u4e48\u53ef\u4ee5\u81ea\u884c\u5efa\u7acb\u8fd9\u4e2a\u76ee\u5f55\uff0c\u7136\u540e\u628a\u6269\u5c55\u62f7\u8d1d\u5230\u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u8bb0\u5f97\u628a php.ini \u6587\u4ef6\u4e2d\u7684 extension_dir \u4fee\u6539\u4e3a\u8be5\u76ee\u5f55\uff1a<br><font color='#008000'>extension_dir = '\/usr\/local\/php\/lib\/php\/extensions\/no-debug-non-zts-20060613\/'<\/font><br>(\u56fe06)<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><img src='http:\/\/note.youdao.com\/yws\/res\/544\/F54394721C34458F9DE07E88BFAE0C1F' data-media-type='image'><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><strong style='font-size:12pt;'><font color='#993300'>\u7b2c\u56db\u6b65\uff1a\u68c0\u67e5\u5b89\u88c5\u7ed3\u679c<br><\/font><\/strong>\u73b0\u5728\u770b\u770b\u6a21\u5757\u52a0\u8f7d\u4e86\u6ca1\u6709\uff1a<br>\/usr\/local\/php\/bin\/php -m\uff0c\u5e94\u8be5\u4f1a\u6253\u5370\u51fa\uff1a<br><font color='#008000'>[PHP Modules]<br>...<br>heiyeluren<br>...<br>[Zend Modules]<\/font><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><br>\u7136\u540e\u91cd\u542fapache\uff0c\u8f93\u51fa phpinfo() \uff0c\u5e94\u8be5\u80fd\u591f\u770b\u5230\uff1a<br><font color='#008000'>heiyeluren<br>heiyeluren support enabled<\/font>&nbsp;<br>(\u56fe07)<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><img src='http:\/\/note.youdao.com\/yws\/res\/543\/F3D68E4D0EA94354888597771B9F6B20' data-media-type='image'><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u770b\u770b\u51fd\u6570\u662f\u5426\u5b58\u5728\u5e76\u4e14\u8c03\u7528\uff0c\u5728web\u76ee\u5f55\u4e0b\u5efa\u7acb\uff1aheiyeluren.php<br><font color='#008000'>&lt;?php<br>echo '&lt;pre&gt;';<br>print_r(get_loaded_extensions());<br>print_r(get_extension_funcs('heiyeluren'));<br>echo heiyeluren_test('My first php extension');<br>echo '&lt;\/pre&gt;';<br>?&gt;<\/font><br>\u8bbf\u95eeapache\uff0c\u5e94\u8be5\u80fd\u591f\u770b\u5230\uff1a<br><font color='#008000'>Array<br>(<br>&nbsp;&nbsp;&nbsp; ...<br>&nbsp;&nbsp;&nbsp; [33] =&gt; heiyeluren<br>)<br>Array<br>(<br>&nbsp;&nbsp;&nbsp; [0] =&gt; confirm_heiyeluren_compiled<br>&nbsp;&nbsp;&nbsp; [1] =&gt; heiyeluren_test<br>)<br>Your input string: heiyeluren<br><\/font>(\u56fe08)<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><img src='http:\/\/note.youdao.com\/yws\/res\/539\/8F23D61EEFF74C24985F24274E3ACF43' data-media-type='image'><\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'><br>\u6269\u5c55\u5236\u4f5c\u6210\u529f\uff01<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>&nbsp;<\/p> \r\n <p style='background-color: rgb(255, 255, 255); font-family: Arial;'>\u66f4\u6df1\u5165\u5185\u5bb9\u8bf7\u53c2\u8003\u8fd9\u91cc\uff1a<a href='http:\/\/blog.csdn.net\/taft\/archive\/2006\/02\/10\/596291.aspx' style='color:rgb(255, 153, 0);'>http:\/\/blog.csdn.net\/taft\/archive\/2006\/02\/10\/596291.aspx<\/a><\/p> \r\n<\/div>\r\n ","excerpt":"\u00a0\u5feb\u901f\u5f00\u53d1\u4e00\u4e2aPHP\u6269\u5c55\u4f5c\u8005\uff1aheiyeluren\u65f6\u95f4\uff1a2008-12-5\u535a\u5ba2\uff1ahttp:\/\/blog.csdn.net\/heiyeshuwu\u672c\u6587\u901a\u8fc7\u975e\u5e38\u5feb\u901f\u7684\u65b9\u5f0f\u8bb2\u89e3\u4e86\u5982\u4f55\u5236\u4f5c\u4e00\u4e2aPHP5.2\u73af\u5883\u7684\u6269\u5c55\uff08PHPExtension\uff09\uff0c\u5e0c\u671b\u80fd\u591f\u5728\u56fe\u6587\u7684\u65b9\u5f0f\u4e0b\u8ba9\u60f3\u5feb\u901f\u5b66\u4e60\u7684\u670b\u53cb\u4e86\u89e3\u4e00\u4e0b\u5236\u4f5c\u8fc7\u7a0b\u3002\u9700\u6c42","author":"1","sortid":"19","type":"blog","views":"46","comnum":"0","tbcount":"0","attnum":"0","top":"n","hide":"n","allow_remark":"y","allow_tb":"y","password":"","thumb":"0","alias":""}